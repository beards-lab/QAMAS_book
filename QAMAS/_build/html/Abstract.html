

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Quantitative analysis of mitochondrial ATP synthesis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/spanels-index--0afa1ebdab0bb23b98b56d34c23d9f57.css" />
    <link rel="stylesheet" type="text/css" href="_static/spanels-variables--ffc7f74dcb1b9eecba2dbcbc22818714.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-2 bd-sidebar site-navigation show single-page" id="site-navigation">
    
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://ebenjaminrandall.github.io/QAMAS_book/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            
        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="title-page">
<h1>Title Page<a class="headerlink" href="#title-page" title="Permalink to this headline">¶</a></h1>
<div class="section" id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h2>
<p>E. Benjamin Randall<span class="math notranslate nohighlight">\(^{1}\)</span>, Marcus Hock<span class="math notranslate nohighlight">\(^{2}\)</span>, Rachel Lopez<span class="math notranslate nohighlight">\(^{1}\)</span>, Bahador Marzban<span class="math notranslate nohighlight">\(^{1}\)</span>, Collin Marshall<span class="math notranslate nohighlight">\(^{1}\)</span>, Daniel A. Beard<span class="math notranslate nohighlight">\(^{1*}\)</span></p>
<p><span class="math notranslate nohighlight">\(^{1}\)</span> <em>Department of Molecular and Integrative Physiology, University of Michigan, Ann Arbor, MI</em></p>
<p><span class="math notranslate nohighlight">\(^{2}\)</span> <em>Department of Bioengineering, University of California at San Diego, San Diego, CA</em></p>
<p>*Corresponding author</p>
<p><em>Email addresses</em>: ebrandal&#64;umich.edu (E.B. Randall), m1hock&#64;eng.ucsd.edu (M. Hock), ralopez&#64;umich.edu (R. Lopez), bmarzban&#64;umich.edu (B. Marzban), colmar&#64;umich.edu (C. Marshall), beardda&#64;umich.edu (D.A. Beard).</p>
</div>
<div class="section" id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>We present a computational framework for analyzing and simulating mitochondrial ATP synthesis using basic thermodynamic and kinetic principles. The framework invokes detailed descriptions of the thermodynamic driving forces associated with the processes of the electron transport chain, mitochondrial ATP synthetase, and mitochondrial phosphate and adenine nucleotide transporters. Assembling models of these discrete processes into an integrated model of mitochondrial ATP synthesis, we illustrate how to analyze and simulate in vitro respirometry experiments and how models identified from in vitro experimental data effectively explain cardiac respiratory control in vivo. Computer codes for these analyses are embedded as Python scripts in a Jupyter Book to facilitate easy adoption and modification of the concepts developed here. All source codes are available on at <a href="https://beards-lab.github.io/QAMAS_book">https://beards-lab.github.io/QAMAS_book</a>.</p>
</div>
<div class="section" id="highlights">
<h2>Highlights<a class="headerlink" href="#highlights" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>A kinetic and thermodynamic framework for mitochondrial energetics is developed.</p></li>
<li><p>The framework is applied to simulate ATP synthesis and respiratory control.</p></li>
<li><p>We illustrate how respiratory control in vitro translates to energetics in vivo.</p></li>
<li><p>Computer codes are available at <a href="https://beards-lab.github.io/QAMAS_book">https://beards-lab.github.io/QAMAS_book</a>.</p></li>
</ul>
</div>
<div class="section" id="funding">
<h2>Funding<a class="headerlink" href="#funding" title="Permalink to this headline">¶</a></h2>
<p>This work supported by NIH grant HL144657.</p>
<div class="toctree-wrapper compound">
<span id="document-Abbreviations"></span><div class="section" id="abbreviations">
<h3>Abbreviations<a class="headerlink" href="#abbreviations" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Description</p></th>
<th class="text-align:center head"><p>Abbreviation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>Adenosine triphosphate</p></td>
<td class="text-align:center"><p>ATP</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Adenosine diphosphate</p></td>
<td class="text-align:center"><p>ADP</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Deoxyribonucleic acid</p></td>
<td class="text-align:center"><p>DNA</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Flavin adenine dinucleotide (oxidized)</p></td>
<td class="text-align:center"><p>FAD</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Flavin adenine dinucleotide (reduced)</p></td>
<td class="text-align:center"><p>FADH<span class="math notranslate nohighlight">\(_2\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Inner mitochondrial membrane</p></td>
<td class="text-align:center"><p>IMM</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Inorganic phosphate</p></td>
<td class="text-align:center"><p>Pi</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Intermembrane space</p></td>
<td class="text-align:center"><p>IMS</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Nicotinamide adenine dinucleotide (oxidized)</p></td>
<td class="text-align:center"><p>NAD<span class="math notranslate nohighlight">\(^{+}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Nicotinamide adenine dinucleotide (reduced)</p></td>
<td class="text-align:center"><p>NADH</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Oxygen consumption rate</p></td>
<td class="text-align:center"><p>OCR</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Total adenine nucleotide</p></td>
<td class="text-align:center"><p>TAN</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Total enchangeable phosphate</p></td>
<td class="text-align:center"><p>TEP</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Tricarboxylic acid</p></td>
<td class="text-align:center"><p>TCA</p></td>
</tr>
</tbody>
</table>
</div>
<span id="document-Introduction"></span><div class="section" id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h3>
<p>Acquired in the initiating event in the origin of eukaryotes, mitochondria are a defining feature of eukaroytic organisms <a class="bibtex reference internal" href="Abstract.html#friedman2014" id="id1">[13]</a>. They serve as a central hub for eukaryotic energy metabolism, oxidizing carbohydrates, fats, and ketones, producing the reducing equivalents to drive the proton pumps of the respiratory complexes, and synthesizing the majority of adenosine triphosphate (ATP) needed to drive essential cell functions in high metabolic demand tissues (e.g., heart, brain, kidney). Since oxygen (O<span class="math notranslate nohighlight">\(_2\)</span>) is the final electron acceptor of the respiratory chain, mitochondrial respiration is the primary reason why vertebrate animals need a heart and vascular system to deliver oxygen to within diffusional distances of nearly every cell in the body. In other words, mitochondria are, in large part, the reason why the mammalian heart must beat continuously throughout the life of the organism. Mitochondria are also the source of the ATP hydrolysis potential that drives the mechanical pumping of the heart. Thus, at a basic level, mitochondria are both the ends and the means of cardiovascular physiology.</p>
<p>In oxidizing primary substrates and synthesizing ATP, mitochondria transduce free energy through a multi-step process: (i) reduced cofactors nicotinatmide adenine dinucleotide (NADH) and flavin adenine dinucleotide (FADH<span class="math notranslate nohighlight">\(_2\)</span>) are synthesized via the oxidation of fuels such as pyruvate and fatty acids; (ii) oxidation of NADH and FADH<span class="math notranslate nohighlight">\(_2\)</span> drives the proton pumps of the respiratory chain, generating an electrostatic potential across the inner mitochondrial membrane (IMM); and (iii) that electrostatic potential, in turn, drives the phosphorylation of adenosine diphosphate (ADP) to ATP and the electrogenic exchange of a mitochondrial matrix ATP<span class="math notranslate nohighlight">\(^{4-}\)</span> for a cytosolic ADP<span class="math notranslate nohighlight">\(^{3-}\)</span>. Thus, substrate oxidation drives the transduction of free energy of chemical reactions to free energy in an electrochemical transport gradient, and the electrochemical grandient is transduced back to chemical reaction free energy in the form of the ATP hydrolysis potential. The idea that chemical synthesis of ATP is thermodynamically coupled to the movement of ions across the electrochemical gradient of the mitochondrial membrane was introduced by Peter Mitchell, for which he was awarded the Nobel Prize in 1978 <a class="bibtex reference internal" href="Abstract.html#mitchell1961" id="id2">[12]</a>.</p>
<p>We aim to develop a computational framework to help understand how these electrochemical processes operate. Kinetic models of mitochondrial ATP synthesis date back to Chance and Williams <a class="bibtex reference internal" href="Abstract.html#chance1955" id="id3">[16]</a>, who observed a Michaelis-Menten type dependence of ATP synthesis on ADP concentration, yielding a phenomenological approach that is able to effectively describe mitochondrial ATP synthesis in human skeletal muscle in vivo <a class="bibtex reference internal" href="Abstract.html#chance1985" id="id4">[14]</a>. While our approach is to analyze the component processes of oxidative phosphorylation with more mechanistic and thermodynamic fidelity, ultimately our models are in agreement with the overall dependence of ATP synthesis on the concentration of the products of ATP hydrolysis, namely ADP and inorganic phosphate (Pi). Ultimately, we follow the approach of Chance et al. <a class="bibtex reference internal" href="Abstract.html#chance1985" id="id5">[14]</a> of first using in vitro data to identify a mitochondrial model, and then using the identified model to predict and analyze in vivo energetics.</p>
</div>
<span id="document-Principles"></span><div class="section" id="basic-chemical-electrical-and-thermodynamic-principles">
<h3>Basic chemical, electrical, and thermodynamic principles<a class="headerlink" href="#basic-chemical-electrical-and-thermodynamic-principles" title="Permalink to this headline">¶</a></h3>
<p>To develop a quantitative understanding of how these processes work, we start with a set of definitions of the basic quantities and concepts with which we are concerned.</p>
<div class="figure align-default" id="mitofig">
<img alt="_images/Figure1.png" src="_images/Figure1.png" />
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">Diagram of a mitochondrion with the cytosol, intermembrane space (IMS), and matrix indicated. <em>Inset from left to right:</em> Protein channels and complexes associated with oxidative phosphorylation in the cristae of the mitochondrion. Complex I (C1) catalyzes the oxidation of NADH<span class="math notranslate nohighlight">\(^{2-}\)</span> to NAD<span class="math notranslate nohighlight">\(^{-}\)</span> and reduction of ubiquinone (Q) to QH<span class="math notranslate nohighlight">\(_2\)</span>. Complex II (C2) catalyzes the oxidation of FADH<span class="math notranslate nohighlight">\(_2\)</span> to FAD coupled to the reduction of Q. Complex III (C3) catalyzes the oxidation of QH<span class="math notranslate nohighlight">\(_2\)</span> coupled to the reduction of cytochrome c (Cyt c). Complex IV (C4) catalyzes the oxidation of Cyt c coupled to the reduction of oxygen to water. These redox transfers drive pumping of H<span class="math notranslate nohighlight">\(^+\)</span> ions out of the matrix, establishing the proton motive force across the inner mitochondrial membrane (IMM) that drives ATP synthesis at complex V, or the F<span class="math notranslate nohighlight">\(_0\)</span>F<span class="math notranslate nohighlight">\(_1\)</span>-ATPase (F<span class="math notranslate nohighlight">\(_0\)</span>F<span class="math notranslate nohighlight">\(_1\)</span>). The adenine nucleotide translocase (ANT) exchanges matrix ATP for IMS ADP. The inorganic phosphate cotransporter (PiC) brings protons and Pi from the IMS to the matrix. Lastly, there is a passive H<span class="math notranslate nohighlight">\(^{+}\)</span> leak across the IMM. (Figure created with Biorender.com.)</span><a class="headerlink" href="#mitofig" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="mitochondrial-anatomy">
<h4>Mitochondrial anatomy<a class="headerlink" href="#mitochondrial-anatomy" title="Permalink to this headline">¶</a></h4>
<p>The mitochondrion is a membrane-bound, rod-shaped organelle that is responsible for generating most of the chemical energy needed to power the cell’s biochemical reactions by respiration <a class="bibtex reference internal" href="Abstract.html#nicholls2013" id="id1">[11]</a>. Mitochondria are comprised of an outer and inner membrane that are separated by the intermembrane space (IMS) (<a class="reference internal" href="#mitofig"><span class="std std-numref">Fig. 1</span></a>). The outer mitochondrial membrane is freely permeable to small molecules and ions. The IMM folds inward to make cristae that extend into the matrix. Transmembrane channels called porins and the respiratory complexes involved in oxidative phosphorylation and ATP synthesis allow for more selective IMM permeability. The IMM encloses the mitochondrial matrix, which contains mitochondrial deoxyribonucleic acid (DNA), the majority of mitochondrial proteins, soluble metabolic intermediates including ATP, ADP, and Pi, and the enzymes catalyzing the tricarboxylic acid (TCA) cycle and <span class="math notranslate nohighlight">\(\beta\)</span>-oxidation.</p>
</div>
<div class="section" id="imm-capacitance">
<h4>IMM capacitance<a class="headerlink" href="#imm-capacitance" title="Permalink to this headline">¶</a></h4>
<p>The IMM acts as an electrical capacitor to store energy in an electrostatic potential difference between the milieu on each side. Electrical capacitance of a membrane (<span class="math notranslate nohighlight">\(C_m\)</span>) is the proportionality between the rate of charge transport across the membrane, i.e. current (<span class="math notranslate nohighlight">\(I\)</span>), to the rate of membrane potential (<span class="math notranslate nohighlight">\(\Delta \Psi\)</span>) change, that is,</p>
<div class="math notranslate nohighlight">
\[    C_m \dfrac{ {\rm d} {\Delta\Psi}}{{\rm d} t} = I.\]</div>
<p>In the model and associated calculations presented below, we express fluxes in units of moles per unit time per unit volume of mitochondria. Thus, it is convenient to obtain an estimate of <span class="math notranslate nohighlight">\(C_m\)</span> in units of mole per volt per volume of mitochondria. Approximating a mitochondrion as a sphere with radius <span class="math notranslate nohighlight">\(r = 1 \ \mu\text{m}\)</span>, we obtain a surface area-to-volume ratio of <span class="math notranslate nohighlight">\(3 \ \mu\text{m}^{-1}\)</span>. Furthermore, we estimate that the IMM has ten-fold greater surface area than the outer membrane, yielding a surface area to volume ratio of <span class="math notranslate nohighlight">\(30 \ \mu\text{m}^{-1}\)</span> for the IMM. Since the capacitance density of biological membranes ranges from <span class="math notranslate nohighlight">\(0.5\text{-}1.0 \mu\text{F cm}^{-2}\)</span>, or <span class="math notranslate nohighlight">\(0.5 \text{-} 1.0 \times \ 10^{-8} \ \mu\text{F} \ \mu\text{m}^{-2}\)</span> <a class="bibtex reference internal" href="Abstract.html#nicholls2013" id="id2">[11]</a>, <span class="math notranslate nohighlight">\(C_m\)</span> is approximately <span class="math notranslate nohighlight">\(3 \times 10^{-8} \ \mu\text{F} \ \mu\text{m}^{-3} = 300 \ \text{F (L mito)}^{-1}\)</span>. To convert to the units used in the calculations below, we have</p>
<div class="math notranslate nohighlight">
\[  C_m = 300 \ \frac{\rm F}{\rm L \ mito} = 300 \ \frac{\rm C}{\rm V \cdot L \, mito}\cdot
  \frac{1}{F}\, \frac{\rm mol}{\rm C} =
  3.1 \times 10^{-3} \, 
  \frac{\rm mol}{\rm V \cdot  L \, mito}, \,\]</div>
<p>where <span class="math notranslate nohighlight">\(F = 96,485 \ \text{C mol}^{-1}\)</span> is Faraday’s constant.</p>
</div>
<div class="section" id="gibbs-free-energy">
<h4>Gibbs free energy<a class="headerlink" href="#gibbs-free-energy" title="Permalink to this headline">¶</a></h4>
<p>A <em>free energy</em> is a thermodynamic quantity that relates a change in the thermodynamic state of a system to an associated change in total entropy of the system plus its environment. Chemical reaction processes necessarily proceed in the direction associated with a reduction in free energy <a class="bibtex reference internal" href="Abstract.html#nicholls2013" id="id3">[11]</a>. When free energy of a system is reduced, total entropy (of the universe) is increased. The form of free energy that is operative in constant-temperature and constant-pressure systems (most relevant for biochemistry) is the Gibbs free energy, or simply the <em>Gibbs energy</em>.</p>
<p>For a chemical reaction of reactants <span class="math notranslate nohighlight">\(A_i\)</span> and products <span class="math notranslate nohighlight">\(B_j\)</span>,</p>
<div class="math notranslate nohighlight">
\[    \sum_{i = 1}^M m_i A_i \rightleftharpoons \sum_{j = 1}^N n_j B_j\]</div>
<p>where <span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\(N\)</span> are the total number of reactants and products, respectively, and <span class="math notranslate nohighlight">\(m_i\)</span> and <span class="math notranslate nohighlight">\(n_j\)</span> are the coefficients of reactant <span class="math notranslate nohighlight">\(i\)</span> and product <span class="math notranslate nohighlight">\(j\)</span>, respectively, the Gibbs energy can be expressed as</p>
<div class="math notranslate nohighlight" id="equation-delta-rg">
<span class="eqno">(1)<a class="headerlink" href="#equation-delta-rg" title="Permalink to this equation">¶</a></span>\[    \Delta_r G = \Delta_r G^\circ + R{\rm T} \ln \left( \dfrac{ \prod_{i = 1}^{N} [\text{B}_j]^{n_i}}{ \prod_{i = 1}^{M} [\text{A}_i]^{m_i}} \right), \]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta_r G^\circ\)</span> is the reference Gibbs energy for the reaction (a constant at given constant chemical conditions of temperature, pressure, ionic conditions, etc.), <span class="math notranslate nohighlight">\(R = 8.314 \ \text{J mol}^{-1} \ \text{K}^{-1}\)</span> is the gas constant, and <span class="math notranslate nohighlight">\(\text{T} = 310.15 \ \text{K}\)</span> is the temperature. The second term on the right hand side of Equation <a class="reference internal" href="#equation-delta-rg">(1)</a> governs how changes in concentrations of species affects <span class="math notranslate nohighlight">\(\Delta_r G\)</span>.</p>
<p>A system is in chemical equilibrium when there is no thermodynamic driving force, that is, <span class="math notranslate nohighlight">\(\Delta_r G = 0\)</span>. Thus, for this chemical reaction the reference Gibbs energy is related to the equilibrium constant as</p>
<div class="math notranslate nohighlight" id="equation-eq-equilibrium">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-equilibrium" title="Permalink to this equation">¶</a></span>\[    K_{eq} = \left( \frac{\prod_{i = 1}^{N} [\text{B}_j]^{n_i}}{\prod_{i = 1}^{M} [\text{A}_i]^{m_i}} \right)_{eq}
           = \exp\left\{ -\frac{\Delta_r G^\circ}{R{\rm T}} \right\} .\]</div>
</div>
<div class="section" id="membrane-potential-and-proton-motive-force">
<h4>Membrane potential and proton motive force<a class="headerlink" href="#membrane-potential-and-proton-motive-force" title="Permalink to this headline">¶</a></h4>
<p>Free energy associated with the oxidation of primary fuels is transduced to generate the chemical potential across the IMM known as the <em>proton motive force</em>, which is used to synthesize ATP in the matrix and transport ATP out of the matrix to the cytosol <a class="bibtex reference internal" href="Abstract.html#nicholls2013" id="id4">[11]</a>. The thermodynamic driving force for translocation of hydrogen ions (<span class="math notranslate nohighlight">\(\text{H}^{+}\)</span>) across the IMM has two components: the difference in electrostatic potential across the membrane, <span class="math notranslate nohighlight">\(\Delta\Psi\)</span> (V), and the difference in <span class="math notranslate nohighlight">\(\text{H}^{+}\)</span> concentration (or activity) between the media on either side of the membrane, <span class="math notranslate nohighlight">\(\Delta\text{pH}\)</span>, that is</p>
<div class="math notranslate nohighlight" id="equation-dg-h">
<span class="eqno">(3)<a class="headerlink" href="#equation-dg-h" title="Permalink to this equation">¶</a></span>\[\begin{split}    \Delta G_{\rm H} &amp;=&amp; -F\Delta\Psi + R{\rm T}\ln\left( [{\rm H}^+]_x/[{\rm H}^+]_c \right)  \nonumber \\
    &amp;=&amp;  -F\Delta\Psi - 2.3 R{\rm T} \, \Delta{\rm pH},\end{split}\]</div>
<p>where the subscripts <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(c\)</span> indicate matrix and external (cytosol) spaces. <span class="math notranslate nohighlight">\(\Delta\Psi\)</span> is defined as the cytosolic potential minus matrix potential, yielding a negative change in free energy for a positive potential. Membrane potential in respiring mitochondria is approximately <span class="math notranslate nohighlight">\(150 \text{-} 200 \ \text{mV}\)</span>, yielding a contribution to <span class="math notranslate nohighlight">\(\Delta G_{\rm H}\)</span> on the order of <span class="math notranslate nohighlight">\(15 \text{-} 20 \ \text{kJ mol}^{-1}\)</span> <a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id5">[15]</a>. Under in vitro conditions, <span class="math notranslate nohighlight">\(\Delta\text{pH}\)</span> between the matrix and external buffer is on the order of <span class="math notranslate nohighlight">\(0.1 \ \text{pH}\)</span> units <a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id6">[15]</a>. Thus, the contribution to proton motive force from a pH difference is less than <span class="math notranslate nohighlight">\(1 \ \text{kJ mol}^{-1}\)</span> and substantially smaller than that from <span class="math notranslate nohighlight">\(\Delta\Psi\)</span>.</p>
</div>
<div class="section" id="thermodynamics-of-atp-synthesis-hydrolysis">
<h4>Thermodynamics of ATP synthesis/hydrolysis<a class="headerlink" href="#thermodynamics-of-atp-synthesis-hydrolysis" title="Permalink to this headline">¶</a></h4>
<p>Under physiological conditions the ATP hydrolysis reaction</p>
<div class="math notranslate nohighlight" id="equation-atp1">
<span class="eqno">(4)<a class="headerlink" href="#equation-atp1" title="Permalink to this equation">¶</a></span>\[	\text{ATP}^{4-} + \text{H}_2\text{O} \rightleftharpoons 
	    \text{ADP}^{3-} + \text{HPO}_4^{2-} + \text{H}^{+} \]</div>
<p>is thermodynamically favored to proceed from the left-to-right direction. The Gibbs energy associated with turnover of this reaction is</p>
<div class="math notranslate nohighlight" id="equation-drg-atp">
<span class="eqno">(5)<a class="headerlink" href="#equation-drg-atp" title="Permalink to this equation">¶</a></span>\[	\Delta_r G_{\rm ATP} = \Delta_r G^o_\text{ATP} + R{\rm T} \ln 
	\left( \frac{ [\text{ADP}^{3-}] [\text{HPO}_4^{2-}] [{\rm H}^{+}] }
	{ [\text{ATP}^{4-}] }\right),\]</div>
<p>where the Gibbs energy for ATP hydrolysis under physiological conditions is approximately <span class="math notranslate nohighlight">\(\Delta_r G^o_\text{ATP} = 4.99 \ \text{kJ mol}^{-1}\)</span> <a class="bibtex reference internal" href="Abstract.html#li2011" id="id7">[7]</a>.</p>
<div class="section" id="calculation-of-the-atp-hydrolysis-potential">
<h5>Calculation of the ATP hydrolysis potential<a class="headerlink" href="#calculation-of-the-atp-hydrolysis-potential" title="Permalink to this headline">¶</a></h5>
<p>Equation <a class="reference internal" href="#equation-drg-atp">(5)</a> expresses the Gibbs energy of chemical Equation <a class="reference internal" href="#equation-atp1">(4)</a> in terms of its <em>chemical species</em>. In practice, biochemistry typically deals with biochemical <em>reactants</em>, which are comprised of sums of rapidly interconverting chemical species. We calculate the total ATP concentration, <span class="math notranslate nohighlight">\([\Sigma \text{ATP}]\)</span>, in terms of its bound and unbound species, that is,</p>
<div class="math notranslate nohighlight" id="equation-sumatp">
<span class="eqno">(6)<a class="headerlink" href="#equation-sumatp" title="Permalink to this equation">¶</a></span>\[\begin{split}	[\Sigma \text{ATP}] &amp;=&amp; [\text{ATP}^{4-}] + [\text{MgATP}^{2-}] + [\text{HATP}^{3-}] + [\text{KATP}^{3-}] \nonumber\\
	&amp;=&amp; [\text{ATP}^{4-}] + \frac{[\text{Mg}^{2+}] [\text{ATP}^{4-}]}{K_{\text{MgATP}}} + \frac{ [\text{H}^{+}] [\text{ATP}^{4-}]}{K_{\text{HATP}}} + \frac{ [\text{K}^{+}] [\text{ATP}^{4-}]}{K_{\text{KATP}}} \nonumber \\
	&amp;=&amp; [\text{ATP}^{4-}] \left( 1 + \frac{[\text{Mg}^{2+}]}{K_{\text{MgATP}}} + \frac{ [\text{H}^{+}]}{K_{\text{HATP}}} + \frac{ [\text{K}^{+}]}{K_{\text{KATP}}} \right) \nonumber \\
	&amp;=&amp; [\text{ATP}^{4-}] P_{\text{ATP}},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{\text{ATP}}\)</span> is a <em>binding polynomial</em>. Here, we we account for only the single cation-bound species. (Free <span class="math notranslate nohighlight">\(\text{H}^+\)</span> in solution associates with water to form <span class="math notranslate nohighlight">\(\text{H}_3\text{O}^+\)</span>. Here we use [<span class="math notranslate nohighlight">\(\text{H}^+\)</span>] to indicate hydrogen ion activity, which is equal to <span class="math notranslate nohighlight">\(10^{-\text{pH}}\)</span>.)  <a class="reference internal" href="#table-dissociationconstants"><span class="std std-numref">Table 1</span></a> lists the dissociation constants used in this study from <a class="bibtex reference internal" href="Abstract.html#li2011" id="id8">[7]</a>. Similarly, total ADP, [<span class="math notranslate nohighlight">\(\Sigma \text{ADP}\)</span>], and inorganic phosphate, [<span class="math notranslate nohighlight">\(\Sigma \text{Pi}\)</span>], concentrations are</p>
<div class="math notranslate nohighlight" id="equation-sumadp">
<span class="eqno">(7)<a class="headerlink" href="#equation-sumadp" title="Permalink to this equation">¶</a></span>\[\begin{split}    [\Sigma {\rm ADP} ] &amp;=&amp; [{\rm ADP}^{3-}]\left( 1 + \frac{[{\rm Mg}^{2+}]}{K_{\rm MgADP}} + \frac{ [{\rm H}^{+}]}{K_{\rm HADP}} + \frac{ [{\rm K}^{+}]}{K_{\rm KADP}} \right) \nonumber \\
    &amp;=&amp; [{\rm ADP}^{3-}]P_{\rm ADP} \end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-sumpi">
<span class="eqno">(8)<a class="headerlink" href="#equation-sumpi" title="Permalink to this equation">¶</a></span>\[\begin{split}    [\Sigma {\rm Pi} ] &amp;=&amp; [{\rm HPO}_4^{2-}] \left( 1 + \frac{[{\rm Mg}^{2+}]}{K_{\rm MgPi}} + \frac{ [{\rm H}^{+}]}{K_{\rm HPi}} + \frac{ [{\rm K}^{+}]}{K_{\rm KPi}} \right) \nonumber \\
    &amp;=&amp; [{\rm HPO}_4^{2-}] P_{\rm Pi},\end{split}\]</div>
<p>for binding polynomials <span class="math notranslate nohighlight">\(P_{\text{ADP}}\)</span> and <span class="math notranslate nohighlight">\(P_{\text{Pi}}\)</span>.</p>
<p>Expressing the Gibbs energy of ATP hydrolysis in Equation <a class="reference internal" href="#equation-atp1">(4)</a> in terms of biochemical reactant concentrations, we obtain</p>
<div class="math notranslate nohighlight" id="equation-atp2">
<span class="eqno">(9)<a class="headerlink" href="#equation-atp2" title="Permalink to this equation">¶</a></span>\[\begin{split}    \Delta_r G_{\rm ATP} &amp;=&amp; \Delta_r G^o_\text{ATP} + R{\rm T} \ln \left(
    \frac{[\Sigma{\rm ADP}][\Sigma{\rm Pi}]}
    {[\Sigma{\rm ATP}]}\cdot\frac{[{\rm H}^+]P_{\rm ATP}}{P_{\rm ADP}P_{\rm Pi}}
    \right) \nonumber \\ 
    &amp;=&amp; \Delta_r G^o_\text{ATP}
    + R{\rm T} \ln \left(\frac{[{\rm H}^+]P_{\rm ATP}}{P_{\rm ADP}P_{\rm Pi}} \right)
    + R{\rm T} \ln \left(\frac{[\Sigma{\rm ADP}][\Sigma{\rm Pi}]}
    {[\Sigma{\rm ATP}]}\right) \nonumber \\ 
    &amp;=&amp; \Delta_r G'^o_\text{ATP}
    + R{\rm T} \ln \left(\frac{[\Sigma{\rm ADP}][\Sigma{\rm Pi}]}
    {[\Sigma{\rm ATP}]}\right)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta_r G'^o_\text{ATP}\)</span> is a transformed, or <em>apparent</em>, reference Gibbs energy for the reaction.</p>
<table class="docutils align-default" id="table-dissociationconstants">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Dissociation constants given as 10<span class="math notranslate nohighlight">\(^{-\text{p}K_a}\)</span>.</span><a class="headerlink" href="#table-dissociationconstants" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"></th>
<th class="head"><p>Ligand (<span class="math notranslate nohighlight">\(L\)</span>)</p></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"></th>
<th class="head"><p>Mg<span class="math notranslate nohighlight">\(^{2+}\)</span></p></th>
<th class="head"><p>H<span class="math notranslate nohighlight">\(^{+}\)</span></p></th>
<th class="head"><p>K<span class="math notranslate nohighlight">\(^{+}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(K_{L-\text{ATP}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10^{-3.88}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10^{-6.33}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10^{-1.02}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(K_{L-\text{ADP}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10^{-3.00}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10^{-6.26}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10^{-0.89}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(K_{L-\text{Pi}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10^{-1.66}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10^{-6.62}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10^{-0.42}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The following code computes the apparent Gibbs energy with <span class="math notranslate nohighlight">\(\text{pH} = 7\)</span>, <span class="math notranslate nohighlight">\([\text{K}^{+}] = 150 \ \text{mM}\)</span>, and <span class="math notranslate nohighlight">\([\text{Mg}^{2+}] = 1 \ \text{mM}\)</span>. Biochemical reactant concentrations are set such that the total adenine nucleotide (TAN) pool inside the mitochondrion is <span class="math notranslate nohighlight">\(10 \ \text{mM}\)</span>, <span class="math notranslate nohighlight">\([\Sigma \text{ATP}] = 0.5 \ \text{mM}\)</span>, <span class="math notranslate nohighlight">\([\Sigma \text{ADP}] = 9.5 \ \text{mM}\)</span>, and <span class="math notranslate nohighlight">\([\Sigma \text{Pi}] = 1 \ \text{mM}\)</span>. Here, we obtain a value of approximately <span class="math notranslate nohighlight">\(\text{-}45 \ \text{kJ mol}^{-1}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import numpy package for calculations </span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Dissociation constants</span>
<span class="n">K_MgATP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.88</span><span class="p">)</span>
<span class="n">K_MgADP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.00</span><span class="p">)</span>
<span class="n">K_MgPi</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.66</span><span class="p">)</span>
<span class="n">K_HATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.33</span><span class="p">)</span>
<span class="n">K_HADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.26</span><span class="p">)</span>
<span class="n">K_HPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.62</span><span class="p">)</span>
<span class="n">K_KATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">K_KADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.89</span><span class="p">)</span>
<span class="n">K_KPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.42</span><span class="p">)</span>

<span class="c1">#  Gibbs energy under physiological conditions(J mol^(-1))</span>
<span class="n">DrGo_ATP</span> <span class="o">=</span> <span class="mi">4990</span>

<span class="c1"># Thermochemical constants</span>
<span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span>           <span class="c1"># J (mol * K)**(-1)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">310.15</span>          <span class="c1"># K</span>
<span class="n">F</span> <span class="o">=</span> <span class="mi">96485</span>           <span class="c1"># C mol**(-1)</span>

<span class="c1"># Environment concentrations </span>
<span class="n">pH</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">H</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH</span><span class="p">)</span>      <span class="c1"># Molar </span>
<span class="n">K</span>  <span class="o">=</span> <span class="mf">150e-3</span>         <span class="c1"># Molar </span>
<span class="n">Mg</span> <span class="o">=</span> <span class="mf">1e-3</span>           <span class="c1"># Molar </span>

<span class="c1"># Binding polynomials</span>
<span class="n">P_ATP</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">K</span><span class="o">/</span><span class="n">K_KATP</span> <span class="o">+</span> <span class="n">Mg</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="c1"># equation 6</span>
<span class="n">P_ADP</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">K</span><span class="o">/</span><span class="n">K_KADP</span> <span class="o">+</span> <span class="n">Mg</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="c1"># equation 7 </span>
<span class="n">P_Pi</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">K</span><span class="o">/</span><span class="n">K_KPi</span>  <span class="o">+</span> <span class="n">Mg</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="c1"># equation 8 </span>

<span class="c1"># Total concentrations </span>
<span class="n">sumATP</span> <span class="o">=</span> <span class="mf">0.5e-3</span>         <span class="c1"># Molar</span>
<span class="n">sumADP</span> <span class="o">=</span> <span class="mf">9.5e-3</span>         <span class="c1"># Molar</span>
<span class="n">sumPi</span>  <span class="o">=</span> <span class="mf">1.0e-3</span>         <span class="c1"># Molar</span>

<span class="c1"># Reaction:</span>
<span class="c1"># ATP4− + H2O ⇌ ADP3− + HPO2−4 + H+</span>

<span class="c1"># Use equation 9 to calcuate apparent Gibbs energy </span>
<span class="n">DrG_ATP_apparent</span> <span class="o">=</span> <span class="n">DrGo_ATP</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H</span> <span class="o">*</span> <span class="n">P_ATP</span> <span class="o">/</span> <span class="p">(</span><span class="n">P_ADP</span> <span class="o">*</span> <span class="n">P_Pi</span><span class="p">))</span>

<span class="c1"># Use equation 9 to calculate actual Gibbs energy </span>
<span class="n">DrG_ATP</span> <span class="o">=</span> <span class="n">DrG_ATP_apparent</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">sumADP</span> <span class="o">*</span> <span class="n">sumPi</span> <span class="o">/</span> <span class="n">sumATP</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gibbs energy of ATP hydrolysis (kJ mol^(-1))&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DrG_ATP</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gibbs energy of ATP hydrolysis (kJ mol^(-1))
-45.47130666167594
</pre></div>
</div>
</div>
</div>
<p>The reactant concentrations used in the above calculation represent reasonable values for concentrations in the mitochondrial matrix. In the cytosol, the ATP/ADP ratio is on the order of 100:1, yielding a <span class="math notranslate nohighlight">\(\Delta_r G_\text{ATP}\)</span> of approximately <span class="math notranslate nohighlight">\(\text{-}64 \ \text{kJ mol}^{-1}\)</span>.</p>
</div>
<div class="section" id="atp-synthesis-in-the-mitochondrial-matrix">
<h5>ATP synthesis in the mitochondrial matrix<a class="headerlink" href="#atp-synthesis-in-the-mitochondrial-matrix" title="Permalink to this headline">¶</a></h5>
<p>The F<span class="math notranslate nohighlight">\(_0\)</span>F<span class="math notranslate nohighlight">\(_1\)</span> ATP synthase catalyzes the synthesis of ATP from ADP and Pi by coupling to the translocation of  <span class="math notranslate nohighlight">\(n_{\text{F}} = 8/3\)</span> protons from the cytosol to the matrix via the combined reaction</p>
<div class="math notranslate nohighlight" id="equation-atp3">
<span class="eqno">(10)<a class="headerlink" href="#equation-atp3" title="Permalink to this equation">¶</a></span>\[    ({\rm ADP}^{3-})_x + ({\rm HPO_4}^{2-})_x + ({\rm H}^+)_x + n_{\text{F}} (\text{H}^{+})_c 
	\rightleftharpoons 
	({\rm ATP})^{4-}_x + {\rm H_2O} +  n_{\text{F}} (\text{H}^{+})_x \, .\]</div>
<p>Using the Gibbs energy of the reaction of Equation <a class="reference internal" href="#equation-atp2">(9)</a> and the proton motive force in Equation <a class="reference internal" href="#equation-dg-h">(3)</a>, the overall Gibbs energy for the coupled process of ATP synthesis and proton transport via the F<span class="math notranslate nohighlight">\(_0\)</span>F<span class="math notranslate nohighlight">\(_1\)</span> ATP synthase is</p>
<div class="math notranslate nohighlight" id="equation-dg-f">
<span class="eqno">(11)<a class="headerlink" href="#equation-dg-f" title="Permalink to this equation">¶</a></span>\[\begin{split}	\Delta G_{\text{F}} &amp;=&amp; -\Delta_r G_{\rm ATP} + n_\text{F} \Delta G_{\rm H} \nonumber \\
	&amp;=&amp; -\Delta_r G'^o_\text{ATP} - R{\rm T} \ln \left(\frac{[\Sigma{\rm ADP}]_x[\Sigma{\rm Pi}]_x}
    {[\Sigma{\rm ATP}]_x}\right) - n_\text{F} F \Delta \Psi + R{\rm T} \ln \left( 
    \frac{ [{\rm H}^{+}]_x }{ [{\rm H}^{+}]_c } \right)^{n_{\rm F}} . \end{split}\]</div>
<p>Note that the negative before <span class="math notranslate nohighlight">\(\Delta_r G_\text{ATP}\)</span> indicates that the reaction of Equation <a class="reference internal" href="#equation-atp1">(4)</a> is reversed in Equation <a class="reference internal" href="#equation-atp3">(10)</a>. The equilibrium concentration ratio occurs when <span class="math notranslate nohighlight">\(\Delta G_{\text{F}} = 0\)</span>. Solving for the second term in Equation <a class="reference internal" href="#equation-dg-f">(11)</a>, we calculate the apparent equilibrium constant for ATP synthesis as</p>
<div class="math notranslate nohighlight">
\[	K_{eq,\text{F}}^\prime = 
	    \left( \frac{[\Sigma{\rm ATP}]_x}{[\Sigma{\rm ADP}]_x[\Sigma{\rm Pi}]_x} \right)_{eq}
	    = \exp\left\{\frac{ \Delta_rG'^o_{\rm ATP}  + n_{\rm F} F \Delta\Psi}{R{\rm T}}\right\}
        \left( \frac{[{\rm H^+}]_c}{[{\rm H^+}]_x} \right)^{n_{\rm F}}. \]</div>
</div>
<div class="section" id="mathematical-modeling-atp-synthesis">
<span id="modelatpsynthesis"></span><h5>Mathematical modeling ATP synthesis<a class="headerlink" href="#mathematical-modeling-atp-synthesis" title="Permalink to this headline">¶</a></h5>
<p>A simple model of ATP synthesis kinetics can be constructed using the apparent equilibrium constant and mass-action kinetics in the form</p>
<div class="math notranslate nohighlight">
\[    J_{\text{F}} = X_{\text{F}} (K_{eq,\text{F}}^\prime [\Sigma \text{ADP}]_x [\Sigma \text{Pi}]_x - [\Sigma \text{ATP}]_x), \]</div>
<p>where <span class="math notranslate nohighlight">\(X_{\text{F}} = 1000 \ \text{mol s}^{-1} \ \text{(L mito)}^{-1}\)</span> is a rate constant set to an arbitrarily high value that maintains the reaction in equilibrium in model simulations. To simulate ATP synthesis at a given membrane potential, matrix pH, cytosolic pH, and cation concentrations, we have</p>
<div class="math notranslate nohighlight" id="equation-system-atpase">
<span class="eqno">(12)<a class="headerlink" href="#equation-system-atpase" title="Permalink to this equation">¶</a></span>\[\begin{split}    \left\{       
        \renewcommand{\arraystretch}{2}
        \begin{array}{rl}
            \dfrac{ {\rm d} [\Sigma \text{ATP}]_x }{{\rm d} t} &amp;= J_\text{F} / W_x  \\
            \dfrac{ {\rm d} [\Sigma \text{ADP}]_x }{{\rm d} t} &amp;= -J_\text{F} / W_x  \\ 
            \dfrac{ {\rm d} [\Sigma \text{Pi}]_x }{{\rm d} t}  &amp;= -J_\text{F} / W_x, 
        \end{array} 
        \renewcommand{\arraystretch}{1}
    \right. \end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(W_x \ \text{((L matrix water) (L mito)}^{-1}\)</span>) is the fraction of water volume in the mitochondrial matrix to total volume of the mitochondrion. Dissociation constants are listed in <a class="reference internal" href="#table-dissociationconstants"><span class="std std-numref">Table 1</span></a> and all other parameters are listed in <a class="reference internal" href="#table-biophysicalconstants"><span class="std std-numref">Table 2</span></a>.</p>
<table class="docutils align-default" id="table-biophysicalconstants">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Parameters for ATP synthesis in vitro.</span><a class="headerlink" href="#table-biophysicalconstants" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Source</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>F<span class="math notranslate nohighlight">\(_0\)</span>F<span class="math notranslate nohighlight">\(_1\)</span> ATP synthase constants</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n_{\text{F}}\)</span></p></td>
<td></td>
<td><p>Protons translocated</p></td>
<td><p><span class="math notranslate nohighlight">\(8/3 \)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#nicholls2013" id="id9">[11]</a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(X_\text{F}\)</span></p></td>
<td><p>mol s<span class="math notranslate nohighlight">\(^{-1}\)</span> (L mito)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Rate constant</p></td>
<td><p><span class="math notranslate nohighlight">\(1000 \)</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta_r G_\text{ATP}^\circ\)</span></p></td>
<td><p>kJ mol<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Reference Gibbs energy</p></td>
<td><p><span class="math notranslate nohighlight">\(4.99 \)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#li2011" id="id10">[7]</a></p></td>
</tr>
<tr class="row-even"><td><p>Biophysical constants</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(R\)</span></p></td>
<td><p>J mol<span class="math notranslate nohighlight">\(^{-1}\)</span> K<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Gas constant</p></td>
<td><p><span class="math notranslate nohighlight">\(8.314 \)</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td><p>K</p></td>
<td><p>Temperature</p></td>
<td><p><span class="math notranslate nohighlight">\(310.15 \)</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(F\)</span></p></td>
<td><p>C mol<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Faraday’s constant</p></td>
<td><p><span class="math notranslate nohighlight">\(96485\)</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(C_m\)</span></p></td>
<td><p>mol V<span class="math notranslate nohighlight">\(^{-1}\)</span> (L mito)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>IMM capacitance</p></td>
<td><p><span class="math notranslate nohighlight">\(3.1\text{e-}3\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#beard2005" id="id11">[1]</a></p></td>
</tr>
<tr class="row-odd"><td><p>Volume ratios</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(V_c\)</span></p></td>
<td><p>(L cyto) (L cell)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Cyto to cell ratio</p></td>
<td><p><span class="math notranslate nohighlight">\(0.6601\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id12">[15]</a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(V_m\)</span></p></td>
<td><p>(L mito) (L cell)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Mito to cell ratio</p></td>
<td><p><span class="math notranslate nohighlight">\(0.2882\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id13">[15]</a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(V_{m2c}\)</span></p></td>
<td><p>(L mito) (L cyto)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Mito to cyto ratio</p></td>
<td><p><span class="math notranslate nohighlight">\(V_m / V_c\)</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(W_c\)</span></p></td>
<td><p>(L cyto water) (L cyto)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Cyto water space ratio</p></td>
<td><p><span class="math notranslate nohighlight">\(0.8425\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id14">[15]</a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(W_m\)</span></p></td>
<td><p>(L mito water) (L mito)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Mito water space ratio</p></td>
<td><p><span class="math notranslate nohighlight">\(0.7238 \)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id15">[15]</a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(W_x\)</span></p></td>
<td><p>(L matrix water) (L mito)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Mito matrix water space ratio</p></td>
<td><p><span class="math notranslate nohighlight">\(0.9\)</span> <span class="math notranslate nohighlight">\(W_m\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id16">[15]</a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(W_i\)</span></p></td>
<td><p>(L IM water) (L mito)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>IMS water space ratio</p></td>
<td><p><span class="math notranslate nohighlight">\(0.1\)</span> <span class="math notranslate nohighlight">\(W_m\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id17">[15]</a></p></td>
</tr>
</tbody>
</table>
<p>The following code simulates steady state ATP, ADP, and Pi concentrations for <span class="math notranslate nohighlight">\(\Delta \Psi = 175 \ \text{mV}\)</span>. Here, a pH gradient is fixed across the IMM such that the pH in the matrix is slightly more basic than the cytosol, <span class="math notranslate nohighlight">\(\text{pH}_x = 7.4\)</span> and <span class="math notranslate nohighlight">\(\text{pH}_c = 7.2\)</span>. All other conditions remain unchanged.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Define system of ordinary differential equations from equation (12)</span>
<span class="k">def</span> <span class="nf">dXdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">DPsi</span><span class="p">,</span> <span class="n">pH_c</span><span class="p">):</span>
    <span class="c1"># Unpack X state variable</span>
    <span class="n">sumATP</span><span class="p">,</span> <span class="n">sumADP</span><span class="p">,</span> <span class="n">sumPi</span> <span class="o">=</span> <span class="n">X</span>
    
    <span class="c1"># Biophysical constants </span>
    <span class="n">R</span>   <span class="o">=</span> <span class="mf">8.314</span>          <span class="c1"># J (mol * K)**(-1)</span>
    <span class="n">T</span>   <span class="o">=</span> <span class="mf">310.15</span>         <span class="c1"># K</span>
    <span class="n">F</span>   <span class="o">=</span> <span class="mi">96485</span>          <span class="c1"># C mol**(-1)</span>
    <span class="n">C_m</span> <span class="o">=</span> <span class="mf">3.1e-3</span>         <span class="c1"># mol (V * L mito)**(-1)</span>
    
    <span class="c1"># F0F1 constants </span>
    <span class="n">n_F</span> <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">X_F</span> <span class="o">=</span> <span class="mi">1000</span>            <span class="c1"># mol (s * L mito)**(-1)</span>
    
    <span class="c1"># Dissociation constants</span>
    <span class="n">K_MgATP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.88</span><span class="p">)</span>
    <span class="n">K_MgADP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.00</span><span class="p">)</span>
    <span class="n">K_MgPi</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.66</span><span class="p">)</span>
    <span class="n">K_HATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.33</span><span class="p">)</span>
    <span class="n">K_HADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.26</span><span class="p">)</span>
    <span class="n">K_HPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.62</span><span class="p">)</span>
    <span class="n">K_KATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">K_KADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.89</span><span class="p">)</span>
    <span class="n">K_KPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.42</span><span class="p">)</span>

    <span class="c1"># Environment concentrations </span>
    <span class="n">pH_x</span> <span class="o">=</span> <span class="mf">7.4</span>          <span class="c1"># pH in matrix</span>
    <span class="n">H_x</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_x</span><span class="p">)</span>  <span class="c1"># M </span>
    <span class="n">H_c</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_c</span><span class="p">)</span>  <span class="c1"># M </span>
    <span class="n">K_x</span>  <span class="o">=</span> <span class="mf">150e-3</span>       <span class="c1"># M </span>
    <span class="n">Mg_x</span> <span class="o">=</span> <span class="mf">1e-3</span>         <span class="c1"># M </span>

    <span class="c1"># Binding polynomials</span>
    <span class="n">P_ATP</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KATP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="c1"># equation 6</span>
    <span class="n">P_ADP</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KADP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="c1"># equation 7 </span>
    <span class="n">P_Pi</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KPi</span>  <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="c1"># equation 8 </span>

    <span class="c1"># Volume ratios</span>
    <span class="n">W_m</span> <span class="o">=</span> <span class="mf">0.7238</span>         <span class="c1"># (L mito water) (L mito)**(-1)</span>
    <span class="n">W_x</span> <span class="o">=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">W_m</span>      <span class="c1"># (L matrix water) (L mito)**(-1)</span>
    
    <span class="c1"># Gibbs energy (equation 9)</span>
    <span class="n">DrGo_F</span>   <span class="o">=</span> <span class="mi">4990</span>      <span class="c1"># (J mol**(-1))</span>
    <span class="n">DrGapp_F</span> <span class="o">=</span> <span class="n">DrGo_F</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_x</span> <span class="o">*</span> <span class="n">P_ATP</span> <span class="o">/</span> <span class="p">(</span><span class="n">P_ADP</span> <span class="o">*</span> <span class="n">P_Pi</span><span class="p">))</span>
    
    <span class="c1"># Apparent equilibrium constant </span>
    <span class="n">Kapp_F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">DrGapp_F</span> <span class="o">+</span> <span class="n">n_F</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">H_x</span><span class="p">)</span> <span class="o">**</span> <span class="n">n_F</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))  </span>
    <span class="n">J_F</span> <span class="o">=</span> <span class="n">X_F</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_F</span> <span class="o">*</span> <span class="n">sumADP</span> <span class="o">*</span> <span class="n">sumPi</span> <span class="o">-</span> <span class="n">sumATP</span><span class="p">)</span>
       
    <span class="c1">###### Differential equations (equation 12) ######</span>
    <span class="n">dATP</span> <span class="o">=</span> <span class="n">J_F</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dADP</span> <span class="o">=</span> <span class="o">-</span><span class="n">J_F</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dPi</span>  <span class="o">=</span> <span class="o">-</span><span class="n">J_F</span> <span class="o">/</span> <span class="n">W_x</span>
    
    <span class="n">dX</span> <span class="o">=</span> <span class="p">(</span><span class="n">dATP</span><span class="p">,</span> <span class="n">dADP</span><span class="p">,</span> <span class="n">dPi</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dX</span>


<span class="c1"># Simple steady state simulation at 175 mV membrane potential </span>

<span class="c1"># Initial conditions (M)</span>
<span class="n">sumATP_0</span> <span class="o">=</span> <span class="mf">0.5e-3</span>
<span class="n">sumADP_0</span> <span class="o">=</span> <span class="mf">9.5e-3</span>
<span class="n">sumPi_0</span>  <span class="o">=</span> <span class="mf">1e-3</span>

<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sumATP_0</span><span class="p">,</span> <span class="n">sumADP_0</span><span class="p">,</span> <span class="n">sumPi_0</span><span class="p">])</span>

<span class="c1"># Inputs  </span>
<span class="n">DPsi</span> <span class="o">=</span> <span class="mf">175e-3</span> <span class="c1"># Constant membrane potential (V)</span>
<span class="n">pH_c</span> <span class="o">=</span> <span class="mf">7.2</span>    <span class="c1"># IMS/buffer pH </span>

<span class="n">solutions</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">DPsi</span><span class="p">,</span><span class="n">pH_c</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">t</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">y</span> 
<span class="n">results</span> <span class="o">=</span> <span class="n">results</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="c1"># Plot figure </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ATP]$_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ADP]$_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">,:],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$Pi]$_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mM)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Principles_15_0.png" src="_images/Principles_15_0.png" />
</div>
</div>
<p>The above simulation shows that under the clamped pH and <span class="math notranslate nohighlight">\(\Delta\Psi\)</span> conditions simulated here, the model is nearly in equilibrium at the initial conditions of ATP, ADP, and Pi concentrations. Most of the adenine nucleotide remains in the form of ADP and the ATP/ADP ratio in the matrix is approximately <span class="math notranslate nohighlight">\(1\)</span>:<span class="math notranslate nohighlight">\(20\)</span>, with the inorganic phosphate concentration of approximately <span class="math notranslate nohighlight">\(1 \ \text{mM}\)</span>.</p>
<p>To explore how the equilibrium changes with membrane potential, the following code computes the predicted equilibrium steady-state over a ranges of <span class="math notranslate nohighlight">\(\Delta\Psi\)</span> from <span class="math notranslate nohighlight">\(100\)</span> to <span class="math notranslate nohighlight">\(250 \ \text{mV}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Simulate over a range of Membrane potential from 100 mV to 250 mV ###</span>

<span class="c1"># Define array to iterate over</span>
<span class="n">membrane_potential</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">250</span><span class="p">)</span>    <span class="c1"># mV</span>

<span class="c1"># Constant external pH</span>
<span class="n">pH_c</span> <span class="o">=</span> <span class="mf">7.2</span> <span class="c1"># IMS/buffer pH</span>

<span class="c1"># Define arrays to store steady state results </span>
<span class="n">ATP_steady_DPsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">))</span>
<span class="n">ADP_steady_DPsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">))</span>
<span class="n">Pi_steady_DPsi</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">))</span>

<span class="c1"># Iterate through range of membrane potentials </span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">)):</span>
    <span class="n">DPsi</span> <span class="o">=</span> <span class="n">membrane_potential</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1000</span>      <span class="c1"># convert to V</span>
    <span class="n">temp_results</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">X_0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">DPsi</span><span class="p">,</span> <span class="n">pH_c</span><span class="p">,))</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="mi">1000</span>  <span class="c1"># Concentration in mM</span>
    <span class="n">ATP_steady_DPsi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">ADP_steady_DPsi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">Pi_steady_DPsi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    
<span class="c1"># Concentration vs DPsi</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">,</span> <span class="n">ATP_steady_DPsi</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ATP]$_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">,</span> <span class="n">ADP_steady_DPsi</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ADP]$_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">,</span> <span class="n">Pi_steady_DPsi</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$Pi]$_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Membrane potential (mV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mM)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Principles_17_0.png" src="_images/Principles_17_0.png" />
</div>
</div>
<p>The above simulations show that under physiological levels of <span class="math notranslate nohighlight">\(\Delta\)</span>pH, matrix ATP concentrations become essentially zero for values of the membrane potential less than approximately <span class="math notranslate nohighlight">\(150 \ \text{mV}\)</span>. At high levels of <span class="math notranslate nohighlight">\(\Delta\Psi\)</span> all of the available phosphate is used to phosphorylate ADP to ATP. Since the initial <span class="math notranslate nohighlight">\([\text{Pi}]\)</span> and <span class="math notranslate nohighlight">\([\text{ATP}]\)</span> are <span class="math notranslate nohighlight">\(1 \ \text{mM}\)</span> and <span class="math notranslate nohighlight">\(0.5 \ \text{mM}\)</span>, respectively, the maximum ATP obtained at the maximal <span class="math notranslate nohighlight">\(\Delta\Psi\)</span> is <span class="math notranslate nohighlight">\(1.5 \ \text{mM}\)</span>.</p>
</div>
</div>
</div>
<span id="document-BuildingModel"></span><div class="section" id="building-a-model-of-oxidative-atp-synthesis-from-energetic-components">
<h3>Building a model of oxidative ATP synthesis from energetic components<a class="headerlink" href="#building-a-model-of-oxidative-atp-synthesis-from-energetic-components" title="Permalink to this headline">¶</a></h3>
<p>Simulations in the preceding section illustrate how matrix ATP and ADP concentrations are governed by the contributors to the proton motive force. They also show how the matrix ATP/ADP ratio must typically be less than <span class="math notranslate nohighlight">\(1\)</span>, in contrast to the cytosolic ATP/ADP ratio, which is on the order of <span class="math notranslate nohighlight">\(100\)</span>. To understand the dependence of ATP synthesis and transport on the proton motive force, the kinetics of the processes that generate it, and the interplay of these processes, we can assemble models of the adenine nucleotide translocase (ANT), mitochondrial phosphate transport, and complexes I, III, and IV of the electron transport chain (ETC) to generate a core model of mitochondrial oxidative ATP synthesis.</p>
<div class="section" id="adenine-nucleotide-translocase">
<h4>Adenine nucleotide translocase<a class="headerlink" href="#adenine-nucleotide-translocase" title="Permalink to this headline">¶</a></h4>
<p>Following synthesis of ATP from ADP and Pi in the matrix, the final step in delivering ATP to the cytosol at physiological free energy levels is the electrically driven exchange of a matrix <span class="math notranslate nohighlight">\(\text{ATP}^{4-}\)</span> for a cytosolic <span class="math notranslate nohighlight">\(\text{ADP}^{3-}\)</span>. This exchange process,</p>
<div class="math notranslate nohighlight">
\[	(\text{ATP}^{4-})_x + (\text{ADP}^{3-})_c \rightleftharpoons (\text{ATP}^{4-})_c + (\text{ADP}^{3-})_x \, ,\]</div>
<p>is catalyzed by the ANT. Here, we assume rapid transport of species between the cytosol and the IMS, and therefore, equate IMS and cytosol species concentrations.</p>
<p>To simulate the kinetics of this process, we use the Metelkin et al. model <a class="bibtex reference internal" href="Abstract.html#metelkin2006" id="id1">[8]</a>, which accounts for pH and electrochemical dependencies. (Kinetic parameter value estimates for this model were updated by Wu et al. <a class="bibtex reference internal" href="Abstract.html#wu2008" id="id2">[3]</a>.) The steady-state flux of ANT is expressed</p>
<div class="math notranslate nohighlight">
\[	J_{\text{ANT}} = E_{\text{ANT}}  \dfrac{  \dfrac{ k_2^{\text{ANT}} q }{ K_o^D }  [ \text{ATP}^{4-} ]_x [ \text{ADP}^{3-}]_c  - \dfrac{ k_3^{\text{ANT}} }{ K_o^T } [ \text{ADP}^{3-} ]_x [ \text{ATP}^{4-} ]_c }{ \left(1 + \dfrac{ [ \text{ATP}^{4-} ]_c }{ K_o^T } + \dfrac{ [ \text{ADP}^{3-} ]_c }{ K_o^D } \right)( [ \text{ADP}^{3-} ]_x + [ \text{ATP}^{4-} ]_x q) }, \]</div>
<p>where <span class="math notranslate nohighlight">\(E_{\text{ANT}} \ \text{(mol (L mito)}^{-1})\)</span> is the total ANT content of the mitochondria and</p>
<div class="math notranslate nohighlight" id="equation-phi">
<span class="eqno">(13)<a class="headerlink" href="#equation-phi" title="Permalink to this equation">¶</a></span>\[\begin{split}	k_2^\text{ANT} &amp;=&amp; k_{2,o}^\text{ANT} e^{( -3A - 4B + C) \phi}, \nonumber \\ 
	k_3^\text{ANT} &amp;=&amp; k_{3,o}^\text{ANT} e^{(-4A - 3B + C) \phi}, \nonumber \\ 
	K_o^D &amp;=&amp; K_o^{D,0} e^{3 \delta_D \phi}, \nonumber \\
	K_o^T &amp;=&amp; K_o^{T,0} e^{4 \delta_T \phi}, \nonumber \\ 
	q &amp;=&amp; \dfrac{ k_3^\text{ANT} K_o^D }{ k_2^\text{ANT} K_o^T } e^\phi, \quad \text{and} \nonumber \\
	\phi &amp;=&amp; F \Delta \Psi / R{\rm T}.  \end{split}\]</div>
<p>All parameter values and units can be found in <a class="reference internal" href="#table-ant"><span class="std std-numref">Table 3</span></a>, reproduced from <a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id3">[15]</a>.</p>
<table class="docutils align-default" id="table-ant">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">Adenine nucleotide translocase (ANT) parameters.</span><a class="headerlink" href="#table-ant" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_\text{ANT}\)</span></p></td>
<td><p>mol (L mito)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>ANT activity</p></td>
<td><p><span class="math notranslate nohighlight">\(0.325\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\delta_D\)</span></p></td>
<td></td>
<td><p>ADP displacement binding constant</p></td>
<td><p><span class="math notranslate nohighlight">\(0.0167 \)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\delta_T\)</span></p></td>
<td></td>
<td><p>ATP displacement binding constant</p></td>
<td><p><span class="math notranslate nohighlight">\(0.0699 \)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k_{2,o}^\text{ANT}\)</span></p></td>
<td><p>s<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Forward translocation rate</p></td>
<td><p><span class="math notranslate nohighlight">\(0.159 \)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k_{3,o}^\text{ANT}\)</span></p></td>
<td><p>s<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Reverse translocation rate</p></td>
<td><p><span class="math notranslate nohighlight">\(0.501 \)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(K_o^{D,0}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu\)</span>mol (L cyto water)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>ADP binding constant</p></td>
<td><p><span class="math notranslate nohighlight">\(38.89 \)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(K_o^{T,0}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu\)</span>mol (L cyto water)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>ATP binding constant</p></td>
<td><p><span class="math notranslate nohighlight">\(56.05\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(A\)</span></p></td>
<td></td>
<td><p>Translocation displacement constant</p></td>
<td><p><span class="math notranslate nohighlight">\(0.2829 \)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(B\)</span></p></td>
<td></td>
<td><p>Translocation displacement constant</p></td>
<td><p><span class="math notranslate nohighlight">\( -0.2086 \)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(C\)</span></p></td>
<td></td>
<td><p>Translocation displacement constant</p></td>
<td><p><span class="math notranslate nohighlight">\(0.2372\)</span></p></td>
</tr>
</tbody>
</table>
<p>To simulate ANT and F<span class="math notranslate nohighlight">\(_0\)</span>F<span class="math notranslate nohighlight">\(_1\)</span> ATP synthase activity simultaneously, we extend the system of Equation <a class="reference internal" href="Abstract.html#equation-system-atpase">(12)</a> by adding states for cytosolic species <span class="math notranslate nohighlight">\([\Sigma \text{ATP} ]_c\)</span> and <span class="math notranslate nohighlight">\([\Sigma \text{ADP}]_c\)</span>, yielding</p>
<div class="math notranslate nohighlight" id="equation-system-atp-ant">
<span class="eqno">(14)<a class="headerlink" href="#equation-system-atp-ant" title="Permalink to this equation">¶</a></span>\[\begin{split}	\left\{ 
		\renewcommand{\arraystretch}{2} 
		\begin{array}{rlrl}
			\dfrac{ {\rm d} [\Sigma \text{ATP}]_x }{{\rm d} t} &amp;= (J_\text{F} - J_\text{ANT} ) / W_x, &amp; \dfrac{ {\rm d} [\Sigma \text{ATP}]_c }{{\rm d} t} &amp;= (V_{m2c} J_\text{ANT})  / W_c, \\
			\dfrac{ {\rm d} [\Sigma \text{ADP}]_x }{{\rm d} t} &amp;= (-J_\text{F} + J_\text{ANT}) / W_x, &amp; \dfrac{ {\rm d} [\Sigma \text{ADP}]_c }{{\rm d} t} &amp;= (-V_{m2c} J_\text{ANT}) / W_c, \\ 
			\dfrac{ {\rm d} [\Sigma \text{Pi}]_x }{{\rm d} t} &amp;= 0 &amp; &amp;\\
		\end{array}
		\renewcommand{\arraystretch}{1} 
	\right.\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(V_{m2c} \ \text{(L mito) (L cyto)}^{-1}\)</span> is the fraction of the volume of mitochondria per volume cytosol and <span class="math notranslate nohighlight">\(W_c \ \text{(L cyto water) (L cyto)}^{-1}\)</span> is the fraction of water volume in the cytoplasm to the total volume of the cytoplasm (<a class="reference internal" href="Abstract.html#table-biophysicalconstants"><span class="std std-numref">Table 2</span></a>).</p>
<p>Here, we clamp the matrix phosphate concentration at a constant value since the equation <a class="reference internal" href="#equation-system-atp-ant">(14)</a> does not account for phosphate transport between the matrix and the cytosol.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">###### Constants defining metabolite pools ######</span>
<span class="c1"># Volume fractions and water space fractions</span>
<span class="n">V_c</span> <span class="o">=</span> <span class="mf">0.6601</span>       <span class="c1"># cytosol volume fraction       # L cyto (L cell)**(-1)</span>
<span class="n">V_m</span> <span class="o">=</span> <span class="mf">0.2882</span>       <span class="c1"># mitochondrial volume fraction # L mito (L cell)**(-1)</span>
<span class="n">V_m2c</span> <span class="o">=</span> <span class="n">V_m</span> <span class="o">/</span> <span class="n">V_c</span>  <span class="c1"># mito to cyto volume ratio     # L mito (L cuvette)**(-1)</span>
<span class="n">W_c</span> <span class="o">=</span> <span class="mf">0.8425</span>      <span class="c1"># cytosol water space           # L cyto water (L cyto)**(-1)</span>
<span class="n">W_m</span> <span class="o">=</span> <span class="mf">0.7238</span>       <span class="c1"># mitochondrial water space     # L mito water (L mito)**(-1)</span>
<span class="n">W_x</span> <span class="o">=</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># matrix water space            # L matrix water (L mito)**(-1)</span>
<span class="n">W_i</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># intermembrane water space     # L IM water (L mito)**(-1)</span>

<span class="c1"># Membrane capacitance</span>
<span class="n">Cm</span>   <span class="o">=</span> <span class="mf">3.1e-3</span>

<span class="c1"># Membrane potential </span>
<span class="n">DPsi</span> <span class="o">=</span> <span class="mi">175</span><span class="o">/</span><span class="mi">1000</span>

<span class="c1">###### Set fixed pH, cation concentrations, and O2 partial pressure ######</span>
<span class="c1"># pH</span>
<span class="n">pH_x</span> <span class="o">=</span> <span class="mf">7.40</span>
<span class="n">pH_c</span> <span class="o">=</span> <span class="mf">7.20</span>

<span class="c1"># K+ concentrations</span>
<span class="n">K_x</span>  <span class="o">=</span> <span class="mf">100e-3</span>     <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">K_c</span>  <span class="o">=</span> <span class="mf">140e-3</span>     <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Mg2+ concentrations</span>
<span class="n">Mg_x</span> <span class="o">=</span> <span class="mf">1.0e-3</span>     <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">Mg_c</span> <span class="o">=</span> <span class="mf">1.0e-3</span>     <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Oxygen partial pressure</span>
<span class="n">PO2</span> <span class="o">=</span> <span class="mi">25</span>          <span class="c1"># mmHg</span>

<span class="c1">###### Parameter vector ###### </span>
<span class="n">X_F</span>   <span class="o">=</span> <span class="mi">1000</span>      <span class="c1"># Synthase activity </span>
<span class="n">E_ANT</span> <span class="o">=</span> <span class="mf">0.325</span>     <span class="c1"># Nucleotide transporter activity </span>
<span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">])</span>     <span class="c1"># Note: This array will be larger in the future parts</span>

<span class="c1">###### Initial Conditions ######</span>
<span class="c1"># Matrix species</span>
<span class="n">sumATP_x_0</span> <span class="o">=</span> <span class="mf">0.5e-3</span>  <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">sumADP_x_0</span> <span class="o">=</span> <span class="mf">9.5e-3</span>  <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">sumPi_x_0</span>  <span class="o">=</span> <span class="mf">1e-3</span>  <span class="c1"># mol (L matrix water)**(-1)</span>

<span class="c1"># Cytoplasmic species</span>
<span class="n">sumATP_c_0</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#9.95e-3        # mol (L cyto water)**(-1)</span>
<span class="n">sumADP_c_0</span> <span class="o">=</span> <span class="mf">10e-3</span> <span class="c1">#0.05e-3        # mol (L cyto water)**(-1)</span>

<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sumATP_x_0</span><span class="p">,</span> <span class="n">sumADP_x_0</span><span class="p">,</span> <span class="n">sumPi_x_0</span><span class="p">,</span> <span class="n">sumATP_c_0</span><span class="p">,</span> <span class="n">sumADP_c_0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">dXdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">activity_array</span><span class="p">):</span>
    <span class="c1"># Unpack variables </span>
    <span class="n">sumATP_x</span><span class="p">,</span> <span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span>  <span class="o">=</span> <span class="n">X</span>
    <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span> <span class="o">=</span> <span class="n">activity_array</span>

    <span class="c1"># Hydrogen ion concentration</span>
    <span class="n">H_x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_x</span><span class="p">)</span> <span class="c1"># mol (L matrix water)**(-1)</span>
    <span class="n">H_c</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_c</span><span class="p">)</span> <span class="c1"># mol (L cuvette water)**(-1)</span>

    <span class="c1"># Oxygen concentration</span>
    <span class="n">a_3</span>  <span class="o">=</span> <span class="mf">1.74e-6</span>   <span class="c1"># oxygen solubility in cuvette   # mol (L matrix water * mmHg)**(-1)</span>
    <span class="n">O2_x</span> <span class="o">=</span> <span class="n">a_3</span><span class="o">*</span><span class="n">PO2</span>   <span class="c1"># mol (L matrix water)**(-1)</span>

    <span class="c1"># Thermochemical constants</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span>          <span class="c1"># J (mol K)**(-1)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">+</span> <span class="mf">273.15</span>    <span class="c1"># K</span>
    <span class="n">F</span> <span class="o">=</span> <span class="mi">96485</span>          <span class="c1"># C mol**(-1)</span>
    
    <span class="c1"># Proton motive force parameters (dimensionless)</span>
    <span class="n">n_F</span>  <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
    
    <span class="c1"># Dissociation constants</span>
    <span class="n">K_MgATP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.88</span><span class="p">)</span>
    <span class="n">K_HATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.33</span><span class="p">)</span>
    <span class="n">K_KATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">K_MgADP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.00</span><span class="p">)</span>
    <span class="n">K_HADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.26</span><span class="p">)</span>
    <span class="n">K_KADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.89</span><span class="p">)</span>
    <span class="n">K_MgPi</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.66</span><span class="p">)</span>
    <span class="n">K_HPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.62</span><span class="p">)</span>
    <span class="n">K_KPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.42</span><span class="p">)</span>

    <span class="c1">## Binding polynomials</span>
    <span class="c1"># Matrix species # mol (L mito water)**(-1)</span>
    <span class="n">PATP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_x</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1"># Cytosol species # mol (L cuvette water)**(-1)</span>
    <span class="n">PATP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_c</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1">## Unbound species</span>
    <span class="c1"># Matrix species</span>
    <span class="n">ATP_x</span> <span class="o">=</span> <span class="n">sumATP_x</span> <span class="o">/</span> <span class="n">PATP_x</span> <span class="c1"># [ATP4-]_x</span>
    <span class="n">ADP_x</span> <span class="o">=</span> <span class="n">sumADP_x</span> <span class="o">/</span> <span class="n">PADP_x</span> <span class="c1"># [ADP3-]_x</span>
    <span class="n">Pi_x</span>  <span class="o">=</span> <span class="n">sumPi_x</span>  <span class="o">/</span> <span class="n">PPi_x</span>  <span class="c1"># [HPO42-]_x</span>
    
    <span class="c1"># Cytosol species </span>
    <span class="n">ATP_c</span> <span class="o">=</span> <span class="n">sumATP_c</span> <span class="o">/</span> <span class="n">PATP_c</span> <span class="c1"># [ATP4-]_c</span>
    <span class="n">ADP_c</span> <span class="o">=</span> <span class="n">sumADP_c</span> <span class="o">/</span> <span class="n">PADP_c</span> <span class="c1"># [ADP3-]_c</span>

    <span class="c1">###### F0F1-ATPase ######</span>
    <span class="c1"># ADP3-_x + HPO42-_x + H+_x + n_A*H+_i &lt;-&gt; ATP4- + H2O + n_A*H+_x</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_F</span>   <span class="o">=</span> <span class="mi">4990</span> 
    <span class="n">DrGapp_F</span> <span class="o">=</span> <span class="n">DrGo_F</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">PATP_x</span> <span class="o">/</span> <span class="p">(</span><span class="n">PADP_x</span> <span class="o">*</span> <span class="n">PPi_x</span><span class="p">))</span>
    
    <span class="c1"># Apparent equilibrium constant </span>
    <span class="n">Kapp_F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="p">(</span><span class="n">DrGapp_F</span> <span class="o">+</span> <span class="n">n_F</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">H_x</span><span class="p">)</span><span class="o">**</span><span class="n">n_F</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_F</span> <span class="o">=</span> <span class="n">X_F</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_F</span> <span class="o">*</span> <span class="n">sumADP_x</span> <span class="o">*</span> <span class="n">sumPi_x</span> <span class="o">-</span> <span class="n">sumATP_x</span><span class="p">)</span>
    
    <span class="c1">###### ANT ######</span>
    <span class="c1"># ATP4-_x + ADP3-_i &lt;-&gt; ATP4-_i + ADP3-_x</span>
    
    <span class="c1">#Constants</span>
    <span class="n">del_D</span>   <span class="o">=</span> <span class="mf">0.0167</span>
    <span class="n">del_T</span>   <span class="o">=</span> <span class="mf">0.0699</span>
    <span class="n">k2o_ANT</span> <span class="o">=</span> <span class="mf">9.54</span><span class="o">/</span><span class="mi">60</span>      <span class="c1"># s**(-1)</span>
    <span class="n">k3o_ANT</span> <span class="o">=</span> <span class="mf">30.05</span><span class="o">/</span><span class="mi">60</span>     <span class="c1"># s**(-1)</span>
    <span class="n">K0o_D</span>   <span class="o">=</span> <span class="mf">38.89e-6</span>     <span class="c1"># mol (L cuvette water)**(-1)</span>
    <span class="n">K0o_T</span>   <span class="o">=</span> <span class="mf">56.05e-6</span>     <span class="c1"># mol (L cuvette water)**(-1)</span>
    <span class="n">A</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2829</span>
    <span class="n">B</span>       <span class="o">=</span> <span class="o">-</span><span class="mf">0.2086</span>
    <span class="n">C</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2372</span>
    
    <span class="n">phi</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    
    <span class="c1"># Reaction rates (s**(-1))</span>
    <span class="n">k2_ANT</span> <span class="o">=</span> <span class="n">k2o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">k3_ANT</span> <span class="o">=</span> <span class="n">k3o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="c1"># Dissociation constants (M)</span>
    <span class="n">K0_D</span> <span class="o">=</span> <span class="n">K0o_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">del_D</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">K0_T</span> <span class="o">=</span> <span class="n">K0o_T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">del_T</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="n">q</span>     <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">K0_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">K0_T</span><span class="p">)</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">ADP_c</span> <span class="o">*</span> <span class="n">q</span> <span class="o">/</span> <span class="n">K0_D</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">ADP_x</span> <span class="o">*</span> <span class="n">ATP_c</span> <span class="o">/</span> <span class="n">K0_T</span>
    <span class="n">num</span>   <span class="o">=</span> <span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span>
    <span class="n">den</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">ATP_c</span><span class="o">/</span><span class="n">K0_T</span> <span class="o">+</span> <span class="n">ADP_c</span><span class="o">/</span><span class="n">K0_D</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ADP_x</span> <span class="o">+</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_ANT</span> <span class="o">=</span> <span class="n">E_ANT</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span>

    <span class="c1">###### Differential equations (equation 14) ######</span>
    <span class="c1"># Matrix species</span>
    <span class="n">dATP_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">J_F</span>  <span class="o">-</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dADP_x</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">J_F</span> <span class="o">+</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dPi_x</span>  <span class="o">=</span> <span class="mi">0</span> <span class="c1">#(-J_F ) / W_x</span>

    <span class="c1"># Cytosol species</span>
    <span class="n">dATP_c</span> <span class="o">=</span> <span class="p">(</span> <span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dADP_c</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>

    <span class="n">dX</span> <span class="o">=</span> <span class="p">[</span><span class="n">dATP_x</span><span class="p">,</span> <span class="n">dADP_x</span><span class="p">,</span> <span class="n">dPi_x</span><span class="p">,</span> <span class="n">dATP_c</span><span class="p">,</span> <span class="n">dADP_c</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dX</span>

<span class="c1"># Solve ODE</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">X_0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">activity_array</span><span class="p">,))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">t</span>
<span class="n">sumATP_x</span><span class="p">,</span> <span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">y</span>

<span class="c1"># Plot figures </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumATP_x</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ATP]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumADP_x</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ADP]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$Pi]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span><span class="mf">10.5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mM)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ATP]$_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ADP]$_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">10.5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/BuildingModel_5_0.png" src="_images/BuildingModel_5_0.png" />
</div>
</div>
<p>The above simulations of the system of Equation <a class="reference internal" href="#equation-system-atp-ant">(14)</a> show how the electrogenic nature of the ANT transport results in markedly different ATP/ADP ratios in the cytosol compared to the matrix. As we saw in the previous chapter, the ATP hydrolysis potential in the matrix is approximately <span class="math notranslate nohighlight">\(\text{-}45 \ \text{kJ mol}^{-1}\)</span>. The roughly <span class="math notranslate nohighlight">\(50\)</span>:<span class="math notranslate nohighlight">\(1\)</span> ratio of ATP to ADP in the cytosol is associated with a hydrolysis potential of approximately <span class="math notranslate nohighlight">\(\text{-}65 \ \text{kJ mol}^{-1}\)</span>. The difference of <span class="math notranslate nohighlight">\(20 \ \text{kJ mol}^{-1}\)</span> between the matrix and the cytosolic space is driven primarily by the membrane potential, which is equivalent to <span class="math notranslate nohighlight">\(20 \ \text{kJ mol}^{-1}\)</span>.</p>
</div>
<div class="section" id="inorganic-phosphate-transport">
<h4>Inorganic phosphate transport<a class="headerlink" href="#inorganic-phosphate-transport" title="Permalink to this headline">¶</a></h4>
<p>During active ATP synthesis, mitochondrial Pi is replenished via the activity of the phosphate-proton cotransporter (PiC), catalyzing the electroneutral cotransport of protonated inorganic phosphate, <span class="math notranslate nohighlight">\(\text{H}_2\text{PO}_4^{-}\)</span>, and <span class="math notranslate nohighlight">\(\text{H}^{+}\)</span> across the membrane. Again, we assume rapid transport between the cytoplasm and intermembrane space, and hence, we have</p>
<div class="math notranslate nohighlight">
\[    (\text{H}_2\text{PO}_4^{-})_x + (\text{H}^{+})_x \rightleftharpoons (\text{H}_2\text{PO}_4^{-})_c + (\text{H}^{+})_c.\]</div>
<p>Adopting the flux equation from Bazil et al. <a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id4">[15]</a>, we have</p>
<div class="math notranslate nohighlight">
\[    J_\text{PiC} = E_{\text{PiC}} \dfrac{ [\text{H}^{+} ]_{c} [\text{H}_2\text{PO}_4^{-}]_{c} - [\text{H}^{+}]_{x} [\text{H}_2\text{PO}_4^{-}]_{x} }{ [\text{H}_2\text{PO}_4^{-}]_c + k_{\text{PiC}} }, \]</div>
<p>where <span class="math notranslate nohighlight">\(E_{\text{PiC}} \ \text{(L matrix water) s}^{-1} \text{ (L mito)}^{-1}\)</span> is the PiC activity rate and <span class="math notranslate nohighlight">\(k_{\text{PiC}} = 1.61\)</span> mM is an effective Michaelis-Menten constant. The <span class="math notranslate nohighlight">\(\text{H}_2\text{PO}_4^{-}\)</span> concentrations in the matrix and cytosol are computed via the relationship</p>
<div class="math notranslate nohighlight">
\[    [\text{H}_2\text{PO}_4^{-}] = [\Sigma{\rm Pi}] \left( [{\rm H}^+]/K_{\rm HPi} \right) / P_{\rm Pi} . \]</div>
<p>To incorporate PiC into Equation <a class="reference internal" href="#equation-system-atp-ant">(14)</a>, we add a new state <span class="math notranslate nohighlight">\([\Sigma \text{Pi}]_c\)</span> such that at given membrane potential, matrix and cytosolic pH, and cation concentrations, we obtain</p>
<div class="math notranslate nohighlight" id="equation-system-atp-ant-pic">
<span class="eqno">(15)<a class="headerlink" href="#equation-system-atp-ant-pic" title="Permalink to this equation">¶</a></span>\[\begin{split}	\left\{ 
		\renewcommand{\arraystretch}{2} 
		\begin{array}{rlrl}
			\dfrac{ {\rm d} [\Sigma \text{ATP}]_x }{{\rm d} t} &amp;= (J_\text{F} - J_\text{ANT} ) / W_x,  &amp; \dfrac{ {\rm d} [\Sigma \text{ATP}]_c }{{\rm d} t} &amp;= (V_{m2c} J_\text{ANT})  / W_c \\
			\dfrac{ {\rm d} [\Sigma \text{ADP}]_x }{{\rm d} t} &amp;= (-J_\text{F} + J_\text{ANT}) / W_x, &amp; \dfrac{ {\rm d} [\Sigma \text{ADP}]_c }{{\rm d} t} &amp;= (-V_{m2c} J_\text{ANT}) / W_c, \\ 
			\dfrac{ {\rm d} [\Sigma \text{Pi}]_x }{{\rm d} t} &amp;= (-J_\text{F} + J_\text{PiC}) / W_x, &amp; \dfrac{ {\rm d} [\Sigma \text{Pi}]_c }{{\rm d} t} &amp;= (- V_{m2c} J_\text{PiC}) / W_c,
		\end{array}
		\renewcommand{\arraystretch}{1} 
	\right.\end{split}\]</div>
<p>The following code simulates the synthesis of ATP from ADP and Pi and their translocation across the IMM under physiological conditions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">###### Constants defining metabolite pools ######</span>
<span class="c1"># Volume fractions and water space fractions</span>
<span class="n">V_c</span> <span class="o">=</span> <span class="mf">0.6601</span>       <span class="c1"># cytosol volume fraction       # L cyto (L cell)**(-1)</span>
<span class="n">V_m</span> <span class="o">=</span> <span class="mf">0.2882</span>       <span class="c1"># mitochondrial volume fraction # L mito (L cell)**(-1)</span>
<span class="n">V_m2c</span> <span class="o">=</span> <span class="n">V_m</span> <span class="o">/</span> <span class="n">V_c</span>  <span class="c1"># mito to cyto volume ratio     # L mito (L cuvette)**(-1)</span>
<span class="n">W_c</span> <span class="o">=</span> <span class="mf">0.8425</span>      <span class="c1"># cytosol water space           # L cyto water (L cyto)**(-1)</span>
<span class="n">W_m</span> <span class="o">=</span> <span class="mf">0.7238</span>       <span class="c1"># mitochondrial water space     # L mito water (L mito)**(-1)</span>
<span class="n">W_x</span> <span class="o">=</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># matrix water space            # L matrix water (L mito)**(-1)</span>
<span class="n">W_i</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># intermembrane water space     # L IM water (L mito)**(-1)</span>

<span class="c1"># Membrane capacitance</span>
<span class="n">Cm</span> <span class="o">=</span> <span class="mf">3.1e-3</span>

<span class="c1"># Membrane potential </span>
<span class="n">DPsi</span> <span class="o">=</span> <span class="mi">175</span><span class="o">/</span><span class="mi">1000</span>

<span class="c1">###### Set fixed pH, cation concentrations, and O2 partial pressure ######</span>
<span class="c1"># pH</span>
<span class="n">pH_x</span> <span class="o">=</span> <span class="mf">7.40</span>
<span class="n">pH_c</span> <span class="o">=</span> <span class="mf">7.20</span>

<span class="c1"># K+ concentrations</span>
<span class="n">K_x</span>  <span class="o">=</span> <span class="mf">100e-3</span>      <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">K_c</span>  <span class="o">=</span> <span class="mf">140e-3</span>      <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Mg2+ concentrations</span>
<span class="n">Mg_x</span> <span class="o">=</span> <span class="mf">1.0e-3</span>        <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">Mg_c</span> <span class="o">=</span> <span class="mf">1.0e-3</span>        <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Oxygen partial pressure</span>
<span class="n">PO2</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1"># mmHg</span>

<span class="c1">###### Parameter vector ###### </span>
<span class="n">X_F</span>   <span class="o">=</span> <span class="mi">100</span>        <span class="c1"># Synthase activity </span>
<span class="n">E_ANT</span> <span class="o">=</span> <span class="mf">0.325</span>      <span class="c1"># Nucleotide transporter activity </span>
<span class="n">E_PiC</span> <span class="o">=</span> <span class="mf">5.0e6</span>      <span class="c1"># Phosphate transporter activity </span>

<span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">])</span>     

<span class="c1">###### Initial Conditions ######</span>
<span class="c1"># Matrix species</span>
<span class="n">sumATP_x_0</span> <span class="o">=</span> <span class="mf">0.5e-3</span>  <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">sumADP_x_0</span> <span class="o">=</span> <span class="mf">9.5e-3</span>  <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">sumPi_x_0</span>  <span class="o">=</span> <span class="mf">1e-3</span>  <span class="c1"># mol (L matrix water)**(-1)</span>

<span class="c1"># Cytosolic species</span>
<span class="n">sumATP_c_0</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># mol (L cyto water)**(-1)</span>
<span class="n">sumADP_c_0</span> <span class="o">=</span> <span class="mf">10e-3</span>   <span class="c1"># mol (L cyto water)**(-1)</span>
<span class="n">sumPi_c_0</span>  <span class="o">=</span> <span class="mf">10e-3</span>   <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sumATP_x_0</span><span class="p">,</span> <span class="n">sumADP_x_0</span><span class="p">,</span> <span class="n">sumPi_x_0</span><span class="p">,</span> <span class="n">sumATP_c_0</span><span class="p">,</span> <span class="n">sumADP_c_0</span><span class="p">,</span> <span class="n">sumPi_c_0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">dXdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">activity_array</span><span class="p">):</span>
    <span class="c1"># Unpack variables </span>
    <span class="n">sumATP_x</span><span class="p">,</span> <span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="p">,</span> <span class="n">sumPi_c</span>  <span class="o">=</span> <span class="n">X</span>
    <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span> <span class="o">=</span> <span class="n">activity_array</span>

    <span class="c1"># Hydrogen ion concentration</span>
    <span class="n">H_x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_x</span><span class="p">)</span> <span class="c1"># mol (L matrix water)**(-1)</span>
    <span class="n">H_c</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_c</span><span class="p">)</span> <span class="c1"># mol (L cuvette water)**(-1)</span>

    <span class="c1"># Oxygen concentration</span>
    <span class="n">a_3</span>  <span class="o">=</span> <span class="mf">1.74e-6</span>   <span class="c1"># oxygen solubility in cuvette   # mol (L matrix water * mmHg)**(-1)</span>
    <span class="n">O2_x</span> <span class="o">=</span> <span class="n">a_3</span><span class="o">*</span><span class="n">PO2</span>   <span class="c1"># mol (L matrix water)**(-1)</span>

    <span class="c1"># Thermochemical constants</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span>          <span class="c1"># J (mol K)**(-1)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">+</span> <span class="mf">273.15</span>    <span class="c1"># K</span>
    <span class="n">F</span> <span class="o">=</span> <span class="mi">96485</span>          <span class="c1"># C mol**(-1)</span>
    
    <span class="c1"># Proton motive force parameters (dimensionless)</span>
    <span class="n">n_F</span>  <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">n_C1</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">n_C3</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">n_C4</span> <span class="o">=</span> <span class="mi">4</span>
    
    <span class="c1"># Dissociation constants</span>
    <span class="n">K_MgATP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.88</span><span class="p">)</span>
    <span class="n">K_HATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.33</span><span class="p">)</span>
    <span class="n">K_KATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">K_MgADP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.00</span><span class="p">)</span>
    <span class="n">K_HADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.26</span><span class="p">)</span>
    <span class="n">K_KADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.89</span><span class="p">)</span>
    <span class="n">K_MgPi</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.66</span><span class="p">)</span>
    <span class="n">K_HPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.62</span><span class="p">)</span>
    <span class="n">K_KPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.42</span><span class="p">)</span>

    <span class="c1">## Binding polynomials</span>
    <span class="c1"># Matrix species # mol (L mito water)**(-1)</span>
    <span class="n">PATP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_x</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1"># Cytosol species # mol (L cuvette water)**(-1)</span>
    <span class="n">PATP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_c</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1">## Unbound species</span>
    <span class="c1"># Matrix species</span>
    <span class="n">ATP_x</span> <span class="o">=</span> <span class="n">sumATP_x</span> <span class="o">/</span> <span class="n">PATP_x</span> <span class="c1"># [ATP4-]_x</span>
    <span class="n">ADP_x</span> <span class="o">=</span> <span class="n">sumADP_x</span> <span class="o">/</span> <span class="n">PADP_x</span> <span class="c1"># [ADP3-]_x</span>
    <span class="n">Pi_x</span>  <span class="o">=</span> <span class="n">sumPi_x</span>  <span class="o">/</span> <span class="n">PPi_x</span>  <span class="c1"># [HPO42-]_x</span>
    
    <span class="c1"># Cytosol species </span>
    <span class="n">ATP_c</span> <span class="o">=</span> <span class="n">sumATP_c</span> <span class="o">/</span> <span class="n">PATP_c</span> <span class="c1"># [ATP4-]_c</span>
    <span class="n">ADP_c</span> <span class="o">=</span> <span class="n">sumADP_c</span> <span class="o">/</span> <span class="n">PADP_c</span> <span class="c1"># [ADP3-]_c</span>
    <span class="n">Pi_c</span>  <span class="o">=</span> <span class="n">sumPi_c</span>  <span class="o">/</span> <span class="n">PPi_c</span>  <span class="c1"># [HPO42-]_c</span>
    
    <span class="c1">###### H+-PI2 cotransporter ######</span>
    <span class="c1"># H2PO42-_x + H+_x = H2PO42-_c + H+_c</span>
    
    <span class="c1"># Constant</span>
    <span class="n">k_PiC</span> <span class="o">=</span> <span class="mf">1.61e-3</span>  <span class="c1"># mol (L cuvette)**(-1)</span>
    
    <span class="c1"># H2P04- species</span>
    <span class="n">HPi_c</span> <span class="o">=</span> <span class="n">Pi_c</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">K_HPi</span><span class="p">)</span>
    <span class="n">HPi_x</span> <span class="o">=</span> <span class="n">Pi_x</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">K_HPi</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_PiC</span> <span class="o">=</span> <span class="n">E_PiC</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">*</span> <span class="n">HPi_c</span> <span class="o">-</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">HPi_x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_PiC</span> <span class="o">+</span> <span class="n">HPi_c</span><span class="p">)</span>

    <span class="c1">###### F0F1-ATPase ######</span>
    <span class="c1"># ADP3-_x + HPO42-_x + H+_x + n_A*H+_i &lt;-&gt; ATP4- + H2O + n_A*H+_x</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_F</span> <span class="o">=</span> <span class="mi">4990</span> 
    <span class="n">DrGapp_F</span> <span class="o">=</span> <span class="n">DrGo_F</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">PATP_x</span> <span class="o">/</span> <span class="p">(</span><span class="n">PADP_x</span> <span class="o">*</span> <span class="n">PPi_x</span><span class="p">))</span>
    
    <span class="c1"># Apparent equilibrium constant </span>
    <span class="n">Kapp_F</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="p">(</span><span class="n">DrGapp_F</span> <span class="o">+</span> <span class="n">n_F</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">H_x</span><span class="p">)</span><span class="o">**</span><span class="n">n_F</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_F</span> <span class="o">=</span> <span class="n">X_F</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_F</span> <span class="o">*</span> <span class="n">sumADP_x</span> <span class="o">*</span> <span class="n">sumPi_x</span> <span class="o">-</span> <span class="n">sumATP_x</span><span class="p">)</span>
    
    <span class="c1">###### ANT ######</span>
    <span class="c1"># ATP4-_x + ADP3-_i &lt;-&gt; ATP4-_i + ADP3-_x</span>
    
    <span class="c1"># Constants </span>
    <span class="n">del_D</span>   <span class="o">=</span> <span class="mf">0.0167</span>
    <span class="n">del_T</span>   <span class="o">=</span> <span class="mf">0.0699</span>
    <span class="n">k2o_ANT</span> <span class="o">=</span> <span class="mf">9.54</span><span class="o">/</span><span class="mi">60</span>      <span class="c1"># s**(-1)</span>
    <span class="n">k3o_ANT</span> <span class="o">=</span> <span class="mf">30.05</span><span class="o">/</span><span class="mi">60</span>     <span class="c1"># s**(-1)</span>
    <span class="n">K0o_D</span>   <span class="o">=</span> <span class="mf">38.89e-6</span>     <span class="c1"># mol (L cuvette water)**(-1)</span>
    <span class="n">K0o_T</span>   <span class="o">=</span> <span class="mf">56.05e-6</span>     <span class="c1"># mol (L cuvette water)**(-1)</span>
    <span class="n">A</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2829</span>
    <span class="n">B</span>       <span class="o">=</span> <span class="o">-</span><span class="mf">0.2086</span>
    <span class="n">C</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2372</span>
    
    <span class="n">phi</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    
    <span class="c1"># Reaction rates (s**(-1))</span>
    <span class="n">k2_ANT</span> <span class="o">=</span> <span class="n">k2o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">k3_ANT</span> <span class="o">=</span> <span class="n">k3o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="c1"># Dissociation constants (M)</span>
    <span class="n">K0_D</span> <span class="o">=</span> <span class="n">K0o_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">del_D</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">K0_T</span> <span class="o">=</span> <span class="n">K0o_T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">del_T</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="n">q</span>     <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">K0_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">K0_T</span><span class="p">)</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">ADP_c</span> <span class="o">*</span> <span class="n">q</span> <span class="o">/</span> <span class="n">K0_D</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">ADP_x</span> <span class="o">*</span> <span class="n">ATP_c</span> <span class="o">/</span> <span class="n">K0_T</span>
    <span class="n">num</span>   <span class="o">=</span> <span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span>
    <span class="n">den</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">ATP_c</span><span class="o">/</span><span class="n">K0_T</span> <span class="o">+</span> <span class="n">ADP_c</span><span class="o">/</span><span class="n">K0_D</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ADP_x</span> <span class="o">+</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_ANT</span> <span class="o">=</span> <span class="n">E_ANT</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span>

    <span class="c1">###### Differential equations (equation 15) ######</span>
    <span class="c1"># Matrix species</span>
    <span class="n">dATP_x</span>  <span class="o">=</span> <span class="p">(</span><span class="n">J_F</span>  <span class="o">-</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dADP_x</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">J_F</span> <span class="o">+</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dPi_x</span>   <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">J_F</span> <span class="o">+</span> <span class="n">J_PiC</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>

    <span class="c1"># Buffer species</span>
    <span class="n">dATP_c</span> <span class="o">=</span> <span class="p">(</span> <span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dADP_c</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dPi_c</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_PiC</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>

    <span class="n">dX</span> <span class="o">=</span> <span class="p">[</span><span class="n">dATP_x</span><span class="p">,</span> <span class="n">dADP_x</span><span class="p">,</span> <span class="n">dPi_x</span><span class="p">,</span> <span class="n">dATP_c</span><span class="p">,</span> <span class="n">dADP_c</span><span class="p">,</span> <span class="n">dPi_c</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dX</span>

<span class="c1"># Solve ODE</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">X_0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">t_eval</span> <span class="o">=</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">activity_array</span><span class="p">,))</span>
<span class="n">sumATP_x</span><span class="p">,</span> <span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="p">,</span> <span class="n">sumPi_c</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">y</span>

<span class="c1"># Plot figures </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumATP_x</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ATP]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumADP_x</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ADP]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$Pi]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span><span class="mf">10.5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mM)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ATP]$_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ADP]$_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumPi_c</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$Pi]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">10.5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/BuildingModel_9_0.png" src="_images/BuildingModel_9_0.png" />
</div>
</div>
<p>For the above simulations, cytosolic inorganic phosphate is set to <span class="math notranslate nohighlight">\(10 \ \text{mM}\)</span> initially, and all other initial conditions remain unchanged. Driven by <span class="math notranslate nohighlight">\(\Delta \text{pH}\)</span>, a gradient in phosphate concentration is established, with a steady-state ratio of matrix-to-cytosol concentration of approximately <span class="math notranslate nohighlight">\(2.2\)</span>. As seen in the previous section, with a constant membrane potential of <span class="math notranslate nohighlight">\(175 \ \text{mV}\)</span>, the ATP/ADP ratio is maintained at a much higher level in the cytosol than in the matrix.</p>
<p>The final matrix and cytosol ATP and ADP concentrations depend not only on the membrane potential, but also on the total amount of exchangeable phosphate in the system. Here these simulations start with <span class="math notranslate nohighlight">\([\text{Pi}]_c = 10 \ \text{mM}\)</span> and <span class="math notranslate nohighlight">\([\text{Pi}]_x = 1 \ \text{mM}\)</span>. The initial <span class="math notranslate nohighlight">\(10 \ \text{mM}\)</span> of ADP in the cytosol becomes almost entirely phosphorylated to ATP, leaving <span class="math notranslate nohighlight">\(0.32 \ \text{mM}\)</span> of inorganic phosphate in the cytosol in the final steady state. To explore how these steady states depend on <span class="math notranslate nohighlight">\(\Delta\Psi\)</span>, the following code simulates the steady-state behavior of this system for a range of <span class="math notranslate nohighlight">\(\Delta\Psi\)</span> from <span class="math notranslate nohighlight">\(100\)</span> to <span class="math notranslate nohighlight">\(200 \ \text{mV}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Simulate over a range of Membrane potential from 100 mV to 250 mV ###</span>

<span class="c1"># Define array to iterate over</span>
<span class="n">membrane_potential</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">250</span><span class="p">)</span>    <span class="c1"># mV</span>

<span class="c1"># Constant external pH</span>
<span class="n">pH_c</span> <span class="o">=</span> <span class="mf">7.2</span> <span class="c1"># IMS/buffer pH</span>

<span class="c1"># Define arrays to store steady state results </span>
<span class="n">ATP_x_steady</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">))</span>
<span class="n">ADP_x_steady</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">))</span>
<span class="n">Pi_x_steady</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">))</span>

<span class="n">ATP_c_steady</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">))</span>
<span class="n">ADP_c_steady</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">))</span>
<span class="n">Pi_c_steady</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">))</span>

<span class="c1"># Iterate through range of membrane potentials </span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">)):</span>
    <span class="n">DPsi</span> <span class="o">=</span> <span class="n">membrane_potential</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1000</span>      <span class="c1"># convert to V</span>
    <span class="n">temp_results</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">X_0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">activity_array</span><span class="p">,))</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="mi">1000</span>  <span class="c1"># Concentration in mM</span>
    <span class="n">ATP_x_steady</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">ADP_x_steady</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">Pi_x_steady</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">ATP_c_steady</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">ADP_c_steady</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">Pi_c_steady</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 

<span class="c1"># Plot figures </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">,</span> <span class="n">ATP_x_steady</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ATP]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">,</span> <span class="n">ADP_x_steady</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ADP]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">,</span> <span class="n">Pi_x_steady</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$Pi]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Membrane potential (mV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mM)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">,</span> <span class="n">ATP_c_steady</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ATP]$_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">,</span> <span class="n">ADP_c_steady</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ADP]$_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">membrane_potential</span><span class="p">,</span> <span class="n">Pi_c_steady</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$Pi]$_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Membrane potential (mV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mM)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/BuildingModel_11_0.png" src="_images/BuildingModel_11_0.png" />
</div>
</div>
<p>Simulation of this system reinforces the fact that ATP cannot be synthesized at physiological free energy levels for mitochondrial membrane potential of less than approximately <span class="math notranslate nohighlight">\(150 \ \text{mV}\)</span>.</p>
</div>
<div class="section" id="respiratory-complexes-and-nadh-synthesis">
<h4>Respiratory complexes and NADH synthesis<a class="headerlink" href="#respiratory-complexes-and-nadh-synthesis" title="Permalink to this headline">¶</a></h4>
<p>The previous sections have assumed a constant membrane potential. To account for the processes that generate the membrane potential, we model proton pumping associated with  the respiratory complexes I, III, and IV of the ETC (<a class="reference internal" href="Abstract.html#mitofig"><span class="std std-numref">Fig. 1</span></a>).</p>
<div class="section" id="etc-complex-i">
<h5>ETC complex I<a class="headerlink" href="#etc-complex-i" title="Permalink to this headline">¶</a></h5>
<p>Coupled with the translocation of <span class="math notranslate nohighlight">\(n_\text{C1} = 4\)</span> protons across the IMM against the electrochemical gradient, electrons are transferred from NADH to ubiquinone (<span class="math notranslate nohighlight">\(Q\)</span>) at complex I of the ETC via the reaction</p>
<div class="math notranslate nohighlight" id="equation-reaction-c1">
<span class="eqno">(16)<a class="headerlink" href="#equation-reaction-c1" title="Permalink to this equation">¶</a></span>\[    (\text{NADH}^{2-})_x + (\text{H}^{+})_x + (\text{Q})_x + n_\text{C1} (\text{H}^{+})_x \rightleftharpoons (\text{NAD}^{-})_x + (\text{QH}_2)_x + \text{H}_2\text{O} + n_\text{C1}(\text{H}^+)_c.\]</div>
<p>Since protons move against the gradient when the reaction proceeds in the left-to-right direction, the overall Gibbs energy for the reaction of Equation <a class="reference internal" href="#equation-reaction-c1">(16)</a> is</p>
<div class="math notranslate nohighlight" id="equation-drg-c1">
<span class="eqno">(17)<a class="headerlink" href="#equation-drg-c1" title="Permalink to this equation">¶</a></span>\[\begin{split}    \Delta G_\text{C1} &amp;= \Delta_r G_\text{C1} - n_\text{C1} \Delta G_{\rm H} \nonumber \\
    &amp;= \Delta_r G_\text{C1}^\circ + R{\rm T} \ln \left( \dfrac{ [\text{NAD}^{-}]_x [\text{QH}_2]_x }{ [\text{NADH}^{2-}]_x [\text{Q}]_x} \cdot  \dfrac{1}{[\text{H}^{+}]_x } \right) + n_\text{C1} F \Delta \Psi - R{\rm T} \ln \left( \dfrac{ [\text{H}^{+}]_x }{ [\text{H}^{+}]_c } \right)^{n_{\text{C1}}} \nonumber \\ 
    &amp;= \Delta_r G'^{\circ}_\text{C1} + R{\rm T} \ln \left( \dfrac{ [\text{NAD}^{-}]_x [\text{QH}_2]_x }{ [\text{NADH}^{2-}]_x [\text{Q}]_x} \right) + n_\text{C1} F \Delta \Psi - R{\rm T} \ln \left( \dfrac{ [\text{H}^{+}]_x }{ [\text{H}^{+}]_c } \right)^{n_{\text{C1}}}, \end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[    \Delta_r G'^\circ_\text{C1} = \Delta_r G^\circ_\text{C1} - R \text{T} \ln ( [\text{H}^+]_x )\]</div>
<p>is the apparent Gibbs energy for Equation <a class="reference internal" href="#equation-reaction-c1">(16)</a>. The apparent equilibrium constant is</p>
<div class="math notranslate nohighlight">
\[    K'_{eq,\text{C1}} = \left(\dfrac{ [\text{NAD}^{-}]_x [\text{QH}_2]_x }{ [\text{NADH}^{2-}]_x [\text{Q}]_x} \right)_{eq} = \exp \left\{ \dfrac{ - ( \Delta_r G'^\circ_\text{C1} + n_\text{C1} F \Delta \Psi) }{ R \text{T}} \right\} \left( \dfrac{ [\text{H}^{+}]_x }{ [\text{H}^{+}]_c } \right)^{n_\text{C1}}.\]</div>
<p>To simulate the flux of complex I, <span class="math notranslate nohighlight">\(J_{\text{C1}} \ \text{(mol s}^{-1} \text{ (L mito)}^{-1})\)</span>, across the IMM by mass-action kinetics, we have</p>
<div class="math notranslate nohighlight" id="equation-eq-complexi">
<span class="eqno">(18)<a class="headerlink" href="#equation-eq-complexi" title="Permalink to this equation">¶</a></span>\[    J_{\text{C1}} = X_{\text{C1}} ( K_{eq,\text{C1}}^\prime [\text{NADH}^{2-}]_x [\text{Q}]_x - [\text{NAD}^{-}]_x [\text{QH}_2]_x ),\]</div>
<p>for <span class="math notranslate nohighlight">\(X_\text{C1} \ \text{(mol s}^{-1} \text{ (L mito)}^{-1})\)</span> the a rate constant. <a class="reference internal" href="#table-etc"><span class="std std-numref">Table 4</span></a> lists the constants for complex I.</p>
</div>
<div class="section" id="etc-complex-iii">
<h5>ETC complex III<a class="headerlink" href="#etc-complex-iii" title="Permalink to this headline">¶</a></h5>
<p>The reaction catalyzed by complex III reduces two cytochrome c proteins for every  <span class="math notranslate nohighlight">\(\text{QH}_2\)</span> oxidized</p>
<div class="math notranslate nohighlight" id="equation-reaction-c3">
<span class="eqno">(19)<a class="headerlink" href="#equation-reaction-c3" title="Permalink to this equation">¶</a></span>\[    (\text{QH}_2)_x + 2 \ (\text{c}_{ox}^{3+})_i + n_\text{C3} (\text{H}^+)_x \rightleftharpoons (\text{Q})_x + 2 \ (\text{c}_{red}^{2+})_i + 2 \ (\text{H}^{+})_c + n_\text{C3} (\text{H}^+)_c,\]</div>
<p>where <span class="math notranslate nohighlight">\(\text{c}_{ox}^{3+}\)</span> and <span class="math notranslate nohighlight">\(\text{c}_{red}^{2+}\)</span> are the oxidized and reduced cytochrome c species and the subscript <span class="math notranslate nohighlight">\(i\)</span> indicates that cytochrome c is confined to the IMS. This reaction is coupled with the transport of <span class="math notranslate nohighlight">\(n_{\text{C3}} = 2\)</span> protons from the matrix to the cytosol against the electrochemical gradient. Thus, the Gibbs energy for the overall reaction given in Equation <a class="reference internal" href="#equation-reaction-c3">(19)</a> is</p>
<div class="math notranslate nohighlight" id="equation-drg-c3">
<span class="eqno">(20)<a class="headerlink" href="#equation-drg-c3" title="Permalink to this equation">¶</a></span>\[\begin{split}    \Delta G_{\text{C3}} &amp;= \Delta_r G_\text{C3} - n_\text{C3} \Delta G_\text{\rm H} \nonumber \\ 
    &amp;= \Delta_r G_{\text{C3}}^\circ + R{\rm T} \ln \left( \dfrac{ [\text{Q}]_x [\text{c}_{red}^{2+}]_i^2 }{ [\text{QH}_2]_x [\text{c}_{ox}^{3+}]_i^2} \cdot [\text{H}^{+}]_c^2 \right) + n_\text{C3} F \Delta \Psi -
    R{\rm T} \ln \left( \dfrac{ [\text{H}^{+}]_x }{ [\text{H}^{+}]_c} \right)^{n_\text{C3}} \nonumber \\ 
    &amp;= \Delta_r G'^\circ_\text{C3} + R{\rm T} \ln \left( \dfrac{ [\text{Q}]_x [\text{c}_{red}^{2+}]_i^2 }{ [\text{QH}_2]_x [\text{c}_{ox}^{3+}]_i^2}\right) + n_\text{C3} F \Delta \Psi -
    R{\rm T} \ln \left( \dfrac{ [\text{H}^{+}]_x }{ [\text{H}^{+}]_c} \right)^{n_\text{C3}},\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[    \Delta_r G'^\circ_\text{C3} = \Delta_r G^\circ_\text{C3} + 2 R \text{T} \ln ([\text{H}^+]_c)\]</div>
<p>is the apparent Gibbs energy for complex III. The apparent equilibrium constant is</p>
<div class="math notranslate nohighlight">
\[    K_{eq,\text{C3}}^\prime = \left( \dfrac{ [\text{Q}]_x [\text{c}_{red}^{2+}]_i^2 }{ [\text{QH}_2]_x [\text{c}_{ox}^{3+}]_i^2 } \right)_{eq} = \exp \left\{ \dfrac{ -(\Delta_r G'^\circ_\text{C3} + n_\text{C3} F 
    \Delta \Psi )}{ R \text{T}} \right\} \left( \dfrac{ [\text{H}^{+}]_x}{ [\text{H}^{+}]_c} \right)^{n_\text{C3}}, \]</div>
<p>To simulate the flux of complex III, <span class="math notranslate nohighlight">\(J_\text{C3} \ \text{(mol s}^{-1} \text{ (L mito)}^{-1})\)</span>, by mass-action kinetics, we have</p>
<div class="math notranslate nohighlight">
\[    J_{\text{C3}} = X_{\text{C3}} (K_{eq,\text{C3}}^\prime [\text{QH}_2]_x [\text{c}_{ox}^{3+}]_i^2 - [\text{Q}]_x [\text{c}_{red}^{2+}]_i^2 ),\]</div>
<p>where <span class="math notranslate nohighlight">\(X_{\text{C3}} \ \text{(mol s}^{-1} \text{ (L mito)}^{-1})\)</span> is the rate constant.</p>
</div>
<div class="section" id="etc-complex-iv">
<h5>ETC complex IV<a class="headerlink" href="#etc-complex-iv" title="Permalink to this headline">¶</a></h5>
<p>In the final step of the ECT catalzyed by complex IV, electrons are transferred from cytochrome c to oxygen, forming water</p>
<div class="math notranslate nohighlight" id="equation-reaction-c4">
<span class="eqno">(21)<a class="headerlink" href="#equation-reaction-c4" title="Permalink to this equation">¶</a></span>\[    2 \ (\text{c}_{red}^{2+})_i + \frac{1}{2} (\text{O}_2)_x + 2 \ (\text{H}^{+})_c + n_\text{C4} ([\text{H}^+])_x \rightleftharpoons 2 \ (\text{c}^{3+}_{ox})_i + \text{H}_2\text{O} + n_\text{C4} ([\text{H}^+])_c, \]</div>
<p>coupled with the translocation of <span class="math notranslate nohighlight">\(n_\text{C4} = 4\)</span> protons across the IMM against against the electrochemical gradient. The Gibbs energy of the reaction in Equation <a class="reference internal" href="#equation-reaction-c4">(21)</a> is</p>
<div class="math notranslate nohighlight" id="equation-drg-c4">
<span class="eqno">(22)<a class="headerlink" href="#equation-drg-c4" title="Permalink to this equation">¶</a></span>\[\begin{split}    \Delta G_\text{C4} &amp;= \Delta_r G_\text{C4} - n_\text{C4} \Delta G_{\rm H} \nonumber \\
    &amp;= \Delta_r G_{\text{C4}}^o + R{\rm T} \ln \left( \dfrac{ [\text{c}^{3+}_{ox}]^2_i }{ [\text{c}^{2+}_{red}]^2_i [\text{O}_2]^{1/2}_x } \cdot \dfrac{1}{[\text{H}^{+}]^2_c}\right) + n_{\text{C4}} F \Delta \Psi -  R{\rm T} \ln \left( \dfrac{ [\text{H}^{+}]_x }{ [\text{H}^{+}]_c} \right)^{n_{\text{C4}}} \nonumber \\ 
    &amp;= \Delta_r G'^\circ_{\text{C4}} + R{\rm T} \ln \left( \dfrac{ [\text{c}^{3+}_{ox}]^2_i }{ [\text{c}^{2+}_{red}]^2_i [\text{O}_2]^{1/2}_x } \right) + n_{\text{C4}} F \Delta \Psi -  R{\rm T} \ln \left( \dfrac{ [\text{H}^{+}]_x }{ [\text{H}^{+}]_c} \right)^{n_{\text{C4}}},
    \label{DrG_C4} \end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[    \Delta_r G'^\circ_\text{C4} = \Delta_r G^\circ_\text{C4} - 2 R \text{T} \ln([\text{H}^+]_c)\]</div>
<p>is the apparent Gibbs energy for complex IV. The apparent equilibrium constant is</p>
<div class="math notranslate nohighlight">
\[    K_{eq,\text{C4}}^\prime = \left( \dfrac{ [\text{c}^{3+}_{ox}]_i^2 }{ [\text{c}^{2+}_{red}]_i^2 [\text{O}_2]_x^{1/2} } \right)_{eq} = \exp \left\{ \dfrac{-(\Delta_r G'^\circ_\text{C4} + n_\text{C4} F \Delta \Psi )}{ R \text{T} } \right\} \left( \dfrac{ [\text{H}^+]_x }{[\text{H}^+]_c} \right)^{n_\text{C4}}.\]</div>
<p>To simulate the flux of complex IV, <span class="math notranslate nohighlight">\(J_{\text{C4}} \ \text{(mol s}^{-1} \text{ (L mito)}^{-1})\)</span>, we use mass-action kinetics and account for binding of oxygen to complex IV as</p>
<div class="math notranslate nohighlight">
\[    J_{\text{C4}} = X_{\text{C4}} \left( \dfrac{1}{1 + \frac{k_{\text{O}_2}}{[\text{O}_2]
    }} \right) \left[ \left(K_{eq,\text{C4}}^\prime\right)^{1/2} [\text{c}_{red}^{2+}]_i [\text{O}_2]_x^{1/4} - [\text{c}_{ox}^{3+}]_i \right],\]</div>
<p>where <span class="math notranslate nohighlight">\(X_{\text{C4}} \ \text{(mol s}^{-1} \text{ (L mito)}^{-1})\)</span> is the rate constant and <span class="math notranslate nohighlight">\(k_{\text{O}_2}\)</span> is the <span class="math notranslate nohighlight">\(\text{O}_2\)</span> binding constant (<a class="reference internal" href="#table-etc"><span class="std std-numref">Table 4</span></a>). For this study, we assume a partial pressure of <span class="math notranslate nohighlight">\(\text{O}_2\)</span> at <span class="math notranslate nohighlight">\(25 \ \text{mmHg}\)</span>.</p>
</div>
<div class="section" id="dehydrogenase-activity">
<h5>Dehydrogenase activity<a class="headerlink" href="#dehydrogenase-activity" title="Permalink to this headline">¶</a></h5>
<p>We do not explicitly model the full TCA cycle but rather the combined action of NADH-producing reactions, that is,</p>
<div class="math notranslate nohighlight">
\[    (\text{NAD}^{-})_x \rightleftharpoons (\text{NADH}^{2-})_x + (\text{H}^{+})_x\]</div>
<p>From Beard <a class="bibtex reference internal" href="Abstract.html#beard2005" id="id5">[1]</a>, the flux of NADH dehydrogenase is assumed to be phosphate-dependent</p>
<div class="math notranslate nohighlight">
\[    J_{\text{DH}} = X_{\text{DH}} (r [\text{NAD}^-] - [\text{NADH}^{2-}]) \left( \dfrac{ 1 + [\Sigma \text{Pi}]_x/k_{\text{Pi},1} }{ 1 + [\Sigma \text{Pi}]_x/k_{\text{Pi},2} } \right),\]</div>
<p>where <span class="math notranslate nohighlight">\(X_\text{DH} \text{ (mol s}^{-1} \text{ (L mito)}^{-1})\)</span> is the dehydrogenase activity and <span class="math notranslate nohighlight">\(r\)</span> (dimensionless), <span class="math notranslate nohighlight">\(k_{\text{Pi},1} \ \text{(mol (L matrix water)}^{-1})\)</span>, and <span class="math notranslate nohighlight">\(k_{\text{Pi},2} \ \text{(mol (L matrix water)}^{-1})\)</span> are constants. Parameter values can be found in <a class="reference internal" href="#table-etc"><span class="std std-numref">Table 4</span></a>.</p>
</div>
<div class="section" id="proton-leak">
<h5>Proton leak<a class="headerlink" href="#proton-leak" title="Permalink to this headline">¶</a></h5>
<p>To simulate proton leakage across the IMM, we adopt the Goldman-Hodgkins-Katz formulation from Wu et al. <a class="bibtex reference internal" href="Abstract.html#wu2008" id="id6">[3]</a>,</p>
<div class="math notranslate nohighlight">
\[    J_{\text{H}} = X_\text{H} ( [\text{H}^{+}]_c \ e^{\phi/2} - [\text{H}^{+}]_x \ e^{-\phi/2}) \]</div>
<p>where <span class="math notranslate nohighlight">\(X_\text{H} \ \text{(mol s}^{-1} \text{ (L mito)}^{-1})\)</span> is the proton leak activity and <span class="math notranslate nohighlight">\(\phi\)</span> is given in Equation <a class="reference internal" href="#equation-phi">(13)</a>.</p>
<table class="docutils align-default" id="table-etc">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">Respiratory complex and inorganic phosphate transport parameters</span><a class="headerlink" href="#table-etc" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Source</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_{\text{C}1}\)</span></p></td>
<td></td>
<td><p>Protons translocated by complex I</p></td>
<td><p><span class="math notranslate nohighlight">\(4 \)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#nicholls2013" id="id7">[11]</a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n_{\text{C}3}\)</span></p></td>
<td></td>
<td><p>Protons translocated by complex III</p></td>
<td><p><span class="math notranslate nohighlight">\(2 \)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#nicholls2013" id="id8">[11]</a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_{\text{C}4}\)</span></p></td>
<td></td>
<td><p>Protons translocated by complex IV</p></td>
<td><p><span class="math notranslate nohighlight">\(4 \)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#nicholls2013" id="id9">[11]</a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(X_\text{C1}\)</span></p></td>
<td><p>mol s<span class="math notranslate nohighlight">\(^{-1}\)</span> (L mito)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Complex I rate constant</p></td>
<td><p><span class="math notranslate nohighlight">\(1\text{e}4\)</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(X_\text{C3}\)</span></p></td>
<td><p>mol s<span class="math notranslate nohighlight">\(^{-1}\)</span> (L mito)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Complex III rate constant</p></td>
<td><p><span class="math notranslate nohighlight">\(1\text{e}6\)</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(X_\text{C4}\)</span></p></td>
<td><p>mol s<span class="math notranslate nohighlight">\(^{-1}\)</span> (L mito)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Complex IV rate constant</p></td>
<td><p><span class="math notranslate nohighlight">\(0.0125\)</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(X_\text{DH}\)</span></p></td>
<td><p>mol s<span class="math notranslate nohighlight">\(^{-1}\)</span> (L mito)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>NADH dehydrogenase rate constant</p></td>
<td><p><span class="math notranslate nohighlight">\(0.1732\)</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(X_\text{H}\)</span></p></td>
<td><p>mol s<span class="math notranslate nohighlight">\(^{-1}\)</span> (L mito)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Proton leak activity</p></td>
<td><p><span class="math notranslate nohighlight">\(1\text{e}3\)</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(r\)</span></p></td>
<td></td>
<td><p>Dehydrogenase parameter</p></td>
<td><p><span class="math notranslate nohighlight">\(6.8385 \)</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k_{\text{Pi},1}\)</span></p></td>
<td><p>mmol (L matrix water)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Dehydrogenase parameter</p></td>
<td><p><span class="math notranslate nohighlight">\(0.466 \)</span></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k_{\text{Pi},2}\)</span></p></td>
<td><p>mmol (L matrix water)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Dehydrogenase parameter</p></td>
<td><p><span class="math notranslate nohighlight">\(0.658 \)</span></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k_{\text{PiC}}\)</span></p></td>
<td><p>mmol (L cell)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>PiC constant</p></td>
<td><p><span class="math notranslate nohighlight">\(1.61\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id10">[15]</a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k_{\text{O}_2}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu\)</span>mol (L matrix water)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>O<span class="math notranslate nohighlight">\(_2\)</span> binding constant</p></td>
<td><p><span class="math notranslate nohighlight">\(120\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#wu2007" id="id11">[4]</a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta_r G^o_\text{C1}\)</span></p></td>
<td><p>kJ mol<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Gibbs energy of reaction for complex I</p></td>
<td><p><span class="math notranslate nohighlight">\( -109.7 \)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#li2011" id="id12">[7]</a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Delta_r G^o_\text{C3}\)</span></p></td>
<td><p>kJ mol<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Gibbs energy of reaction for complex III</p></td>
<td><p><span class="math notranslate nohighlight">\(46.7 \)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#li2011" id="id13">[7]</a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta_r G^o_\text{C4}\)</span></p></td>
<td><p>kJ mol<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Gibbs energy of reaction for complex IV</p></td>
<td><p><span class="math notranslate nohighlight">\( -202.2 \)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#li2011" id="id14">[7]</a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\([\text{NAD}]_{tot}\)</span></p></td>
<td><p>mmol (L matrix water)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Total NAD pool in the matrix</p></td>
<td><p><span class="math notranslate nohighlight">\(2.97\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#wu2007" id="id15">[4]</a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\([\text{Q}]_{tot}\)</span></p></td>
<td><p>mmol (L matrix water)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Total Q pool in the matrix</p></td>
<td><p><span class="math notranslate nohighlight">\(1.35\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#wu2007" id="id16">[4]</a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\([\text{c}]_{tot}\)</span></p></td>
<td><p>mmol (L IM water)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Total cytochrome c pool in the IMS</p></td>
<td><p><span class="math notranslate nohighlight">\(2.70\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#wu2007" id="id17">[4]</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="simulating-atp-synthesis-in-vitro">
<h4>Simulating ATP synthesis in vitro<a class="headerlink" href="#simulating-atp-synthesis-in-vitro" title="Permalink to this headline">¶</a></h4>
<p>The flux expressions developed above may be used to simulate mitochondrial ATP synthesis in vitro, governed by the system of equations</p>
<div class="math notranslate nohighlight" id="equation-system-singlemito">
<span class="eqno">(23)<a class="headerlink" href="#equation-system-singlemito" title="Permalink to this equation">¶</a></span>\[\begin{split}    	\left\{ 
		\renewcommand{\arraystretch}{2.5} 
		\begin{array}{rl}
		    \dfrac{ {\rm d} \Delta \Psi }{{\rm d} t} &amp; =( n_\text{C1} J_\text{C1} + n_\text{C3} J_\text{C3} + n_\text{C4} J_\text{C4} - n_\text{F} J_\text{F} - J_\text{ANT} - J_\text{H}) / C_m &amp; \\ 
		    \hline 
			\dfrac{ {\rm d} [\Sigma \text{ATP}]_x }{{\rm d} t} &amp;= (J_\text{F} - J_\text{ANT} ) / W_x  \\
			\dfrac{ {\rm d} [\Sigma \text{ADP}]_x }{{\rm d} t} &amp;= (-J_\text{F} + J_\text{ANT}) / W_x \\ 
			\dfrac{ {\rm d} [\Sigma \text{Pi}]_x }{{\rm d} t} &amp;= (-J_\text{F} + J_\text{PiC}) / W_x  \quad \text{matrix species}\\ 
			\dfrac{ {\rm d} [\text{NADH}^{2-}]_x }{{\rm d} t} &amp;= (J_\text{DH} - J_\text{C1}) / W_x  \\ 
			\dfrac{ {\rm d} [\text{QH}_2]_x }{{\rm d} t} &amp;= (J_\text{C1} - J_\text{C3}) / W_x \\ 
			\hline 
			\dfrac{ {\rm d} [\text{c}_{red}^{2+}]_i}{{\rm d} t} &amp;= 2(J_\text{C3} - J_\text{C4}) / W_i \quad \text{intermembrane space species}\\
			\hline 
			\dfrac{ {\rm d} [\Sigma \text{ATP}]_c }{{\rm d} t} &amp;= (V_{m2c} J_\text{ANT} - J_\text{AtC} )/ W_c \\
			\dfrac{ {\rm d} [\Sigma \text{ADP}]_c }{{\rm d} t} &amp;= (-V_{m2c} J_\text{ANT} + J_\text{AtC} ) / W_c \quad \text{cytoplasm species}\\
			\dfrac{ {\rm d} [\Sigma \text{Pi}]_c }{{\rm d} t} &amp;= (- V_{m2c} J_\text{PiC} + J_\text{AtC}) / W_c,  
		\end{array}
		\renewcommand{\arraystretch}{1} 
	\right.\end{split}\]</div>
<p>Here, we incorporate a constant ATP consumption flux, <span class="math notranslate nohighlight">\(J_\text{AtC} \ \text{(mol s}^{-1} \text{ (L cyto)}^{-1})\)</span>, that is</p>
<div class="math notranslate nohighlight">
\[    J_\text{AtC} = X_\text{AtC}/V_c\]</div>
<p>where <span class="math notranslate nohighlight">\(V_c\)</span> is the ratio of the volume of cytosol per L cell. <span class="math notranslate nohighlight">\(X_\text{AtC}\)</span> is the ATP consumption rate expressed in units of mmol s<span class="math notranslate nohighlight">\(^{-1}\)</span> (L cell)<span class="math notranslate nohighlight">\(^{-1}\)</span>. Equation <a class="reference internal" href="#equation-system-singlemito">(23)</a> does not explicitly treat matrix or external <span class="math notranslate nohighlight">\(\text{pH}\)</span>, <span class="math notranslate nohighlight">\(\text{K}^+\)</span>, <span class="math notranslate nohighlight">\(\text{Mg}^{2+}\)</span>, or <span class="math notranslate nohighlight">\(\text{O}_2\)</span> as variables. Reasonable clamped concentrations for these variables are <span class="math notranslate nohighlight">\({\rm pH}_x = 7.4\)</span>, <span class="math notranslate nohighlight">\({\rm pH}_c = 7.2\)</span>, <span class="math notranslate nohighlight">\([\text{Mg}^{2+}]_x = 1 \ \text{mmol (L matrix water)}^{-1}\)</span>, <span class="math notranslate nohighlight">\([\text{Mg}^{2+}]_c = 1 \ \text{mmol (L cyto water)}^{-1}\)</span>, <span class="math notranslate nohighlight">\([\text{K}^{+}]_x = 100 \ \text{mmol (L matrix water)}^{-1}\)</span>, and <span class="math notranslate nohighlight">\([K^{+}]_c = 140 \ \text{mmol (L cyto water)}^{-1}\)</span>, and <span class="math notranslate nohighlight">\(\text{O}_2\)</span> partial pressure of <span class="math notranslate nohighlight">\(25 \ \text{mmHg}\)</span>. Respiratory reactants are determined from a total concentration of metabolites within the mitochondrion, that is, the total pools for NAD, cytochrome c, and Q species are</p>
<div class="math notranslate nohighlight">
\[\begin{split}    [\text{NAD}]_{tot} &amp;= [\text{NAD}^-]_x + [\text{NADH}^{2-}]_x \\
    [\text{c}]_{tot} &amp;= [\text{c}^{2+}_{red}]_i + [\text{c}^{3+}_{ox}]_i, \quad \text{and}  \\
    [\text{Q}]_{tot} &amp;= [\text{Q}]_x + [\text{QH}_2]_x. \end{split}\]</div>
<p>The pools are <span class="math notranslate nohighlight">\([\text{NAD}]_{tot} = 2.97 \ \text{mmol (L matrix water)}^{-1}\)</span>, <span class="math notranslate nohighlight">\([\text{c}]_{tot} = 2.7 \ \text{mmol (L IMS water)}^{-1}\)</span>, and <span class="math notranslate nohighlight">\([\text{Q}]_{tot} = 1.35 \ \text{mmol (L matrix water)}^{-1}\)</span>. Initial conditions are set under the assumption that the TAN for both the matrix and cytosol is <span class="math notranslate nohighlight">\(10 \ \text{mM}\)</span>, but the ATP/ADP ratio is <span class="math notranslate nohighlight">\(&lt;\)</span><span class="math notranslate nohighlight">\(1\)</span> in the matrix and <span class="math notranslate nohighlight">\(\sim\)</span><span class="math notranslate nohighlight">\(100\)</span> in the cytosol. The following code simulates in vitro mitochondrial function without ATP consumption in the external (cytosolic space).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">###### Constants defining metabolite pools ######</span>
<span class="c1"># Volume fractions and water space fractions</span>
<span class="n">V_c</span> <span class="o">=</span> <span class="mf">0.6601</span>       <span class="c1"># cytosol volume fraction       # L cyto (L cell)**(-1)</span>
<span class="n">V_m</span> <span class="o">=</span> <span class="mf">0.2882</span>       <span class="c1"># mitochondrial volume fraction # L mito (L cell)**(-1)</span>
<span class="n">V_m2c</span> <span class="o">=</span> <span class="n">V_m</span> <span class="o">/</span> <span class="n">V_c</span>  <span class="c1"># mito to cyto volume ratio     # L mito (L cuvette)**(-1)</span>
<span class="n">W_c</span> <span class="o">=</span> <span class="mf">0.8425</span>      <span class="c1"># cytosol water space           # L cyto water (L cyto)**(-1)</span>
<span class="n">W_m</span> <span class="o">=</span> <span class="mf">0.7238</span>       <span class="c1"># mitochondrial water space     # L mito water (L mito)**(-1)</span>
<span class="n">W_x</span> <span class="o">=</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># matrix water space            # L matrix water (L mito)**(-1)</span>
<span class="n">W_i</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># intermembrane water space     # L IM water (L mito)**(-1)</span>

<span class="c1"># Total pool concentrations</span>
<span class="n">NAD_tot</span> <span class="o">=</span> <span class="mf">2.97e-3</span>  <span class="c1"># NAD+ and NADH conc            # mol (L matrix water)**(-1)</span>
<span class="n">Q_tot</span>   <span class="o">=</span> <span class="mf">1.35e-3</span>  <span class="c1"># Q and QH2 conc                # mol (L matrix water)**(-1)</span>
<span class="n">c_tot</span>   <span class="o">=</span> <span class="mf">2.7e-3</span>   <span class="c1"># cytochrome c ox and red conc  # mol (L IM water)**(-1)</span>

<span class="c1"># Membrane capacitance</span>
<span class="n">Cm</span> <span class="o">=</span> <span class="mf">3.1e-3</span>

<span class="c1">###### Set fixed pH, cation concentrations, and O2 partial pressure ######</span>
<span class="c1"># pH</span>
<span class="n">pH_x</span> <span class="o">=</span> <span class="mf">7.40</span>
<span class="n">pH_c</span> <span class="o">=</span> <span class="mf">7.20</span>

<span class="c1"># K+ concentrations</span>
<span class="n">K_x</span>  <span class="o">=</span> <span class="mf">100e-3</span>      <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">K_c</span>  <span class="o">=</span> <span class="mf">140e-3</span>      <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Mg2+ concentrations</span>
<span class="n">Mg_x</span> <span class="o">=</span> <span class="mf">1.0e-3</span>        <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">Mg_c</span> <span class="o">=</span> <span class="mf">1.0e-3</span>        <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Oxygen partial pressure</span>
<span class="n">PO2</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1"># mmHg</span>

<span class="c1">###### Parameter vector ###### </span>
<span class="n">X_DH</span>  <span class="o">=</span> <span class="mf">0.1732</span>
<span class="n">X_C1</span>  <span class="o">=</span> <span class="mf">1.0e4</span>
<span class="n">X_C3</span>  <span class="o">=</span> <span class="mf">1.0e6</span>
<span class="n">X_C4</span>  <span class="o">=</span> <span class="mf">0.0125</span>
<span class="n">X_F</span>   <span class="o">=</span> <span class="mf">1.0e3</span>
<span class="n">E_ANT</span> <span class="o">=</span> <span class="mf">0.325</span>
<span class="n">E_PiC</span> <span class="o">=</span> <span class="mf">5.0e6</span>
<span class="n">X_H</span>   <span class="o">=</span> <span class="mf">1.0e3</span>
<span class="n">X_AtC</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_AtC</span><span class="p">])</span>

<span class="c1">###### Initial Conditions ######</span>
<span class="c1"># Membrane Potential</span>
<span class="n">DPsi_0</span> <span class="o">=</span> <span class="mi">175</span><span class="o">/</span><span class="mi">1000</span>      <span class="c1"># V</span>

<span class="c1"># Matrix species</span>
<span class="n">sumATP_x_0</span> <span class="o">=</span> <span class="mf">0.5e-3</span>         <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">sumADP_x_0</span> <span class="o">=</span> <span class="mf">9.5e-3</span>         <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">sumPi_x_0</span>  <span class="o">=</span> <span class="mf">1.0e-3</span>         <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">NADH_x_0</span>   <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="n">NAD_tot</span>  <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">QH2_x_0</span>    <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Q_tot</span>    <span class="c1"># mol (L matrix water)**(-1)</span>

<span class="c1"># IMS species</span>
<span class="n">cred_i_0</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">c_tot</span> <span class="c1"># mol (L IMS water)**(-1)</span>

<span class="c1"># Cytosolic species</span>
<span class="n">sumATP_c_0</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># mol (L cyto water)**(-1)</span>
<span class="n">sumADP_c_0</span> <span class="o">=</span> <span class="mf">10e-3</span>   <span class="c1"># mol (L cyto water)**(-1)</span>
<span class="n">sumPi_c_0</span>  <span class="o">=</span> <span class="mf">10e-3</span>   <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">DPsi_0</span><span class="p">,</span> <span class="n">sumATP_x_0</span><span class="p">,</span> <span class="n">sumADP_x_0</span><span class="p">,</span> <span class="n">sumPi_x_0</span><span class="p">,</span> <span class="n">NADH_x_0</span><span class="p">,</span> <span class="n">QH2_x_0</span><span class="p">,</span> <span class="n">cred_i_0</span><span class="p">,</span> <span class="n">sumATP_c_0</span><span class="p">,</span> <span class="n">sumADP_c_0</span><span class="p">,</span> <span class="n">sumPi_c_0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">dXdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">activity_array</span><span class="p">,</span> <span class="n">solve_ode</span><span class="p">):</span>
    <span class="c1"># Unpack variables </span>
    <span class="n">DPsi</span><span class="p">,</span> <span class="n">sumATP_x</span><span class="p">,</span><span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">NADH_x</span><span class="p">,</span> <span class="n">QH2_x</span><span class="p">,</span> <span class="n">cred_i</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="p">,</span> <span class="n">sumPi_c</span> <span class="o">=</span> <span class="n">X</span>
    <span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_AtC</span> <span class="o">=</span> <span class="n">activity_array</span>

    <span class="c1"># Hydrogen ion concentration</span>
    <span class="n">H_x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_x</span><span class="p">)</span> <span class="c1"># mol (L matrix water)**(-1)</span>
    <span class="n">H_c</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_c</span><span class="p">)</span> <span class="c1"># mol (L cuvette water)**(-1)</span>

    <span class="c1"># Oxygen concentration</span>
    <span class="n">a_3</span>  <span class="o">=</span> <span class="mf">1.74e-6</span>   <span class="c1"># oxygen solubility in cuvette   # mol (L matrix water * mmHg)**(-1)</span>
    <span class="n">O2_x</span> <span class="o">=</span> <span class="n">a_3</span><span class="o">*</span><span class="n">PO2</span>   <span class="c1"># mol (L matrix water)**(-1)</span>

    <span class="c1"># Thermochemical constants</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span>          <span class="c1"># J (mol K)**(-1)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">+</span> <span class="mf">273.15</span>    <span class="c1"># K</span>
    <span class="n">F</span> <span class="o">=</span> <span class="mi">96485</span>          <span class="c1"># C mol**(-1)</span>
    
    <span class="c1"># Proton motive force parameters (dimensionless)</span>
    <span class="n">n_F</span>  <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">n_C1</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">n_C3</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">n_C4</span> <span class="o">=</span> <span class="mi">4</span>
    
    <span class="c1"># Dissociation constants</span>
    <span class="n">K_MgATP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.88</span><span class="p">)</span>
    <span class="n">K_HATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.33</span><span class="p">)</span>
    <span class="n">K_KATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">K_MgADP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.00</span><span class="p">)</span>
    <span class="n">K_HADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.26</span><span class="p">)</span>
    <span class="n">K_KADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.89</span><span class="p">)</span>
    <span class="n">K_MgPi</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.66</span><span class="p">)</span>
    <span class="n">K_HPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.62</span><span class="p">)</span>
    <span class="n">K_KPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.42</span><span class="p">)</span>

    <span class="c1"># Other concentrations computed from the state variables:</span>
    <span class="n">NAD_x</span> <span class="o">=</span> <span class="n">NAD_tot</span> <span class="o">-</span> <span class="n">NADH_x</span>  <span class="c1">## mol (L matrix water)**(-1)</span>
    <span class="n">Q_x</span>   <span class="o">=</span> <span class="n">Q_tot</span> <span class="o">-</span> <span class="n">QH2_x</span>     <span class="c1">## mol (L matrix water)**(-1)</span>
    <span class="n">cox_i</span> <span class="o">=</span> <span class="n">c_tot</span> <span class="o">-</span> <span class="n">cred_i</span>    <span class="c1">## mol (L matrix water)**(-1)</span>

    <span class="c1">## Binding polynomials</span>
    <span class="c1"># Matrix species # mol (L mito water)**(-1)</span>
    <span class="n">PATP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_x</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1"># Cytosol species # mol (L cuvette water)**(-1)</span>
    <span class="n">PATP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_c</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1">## Unbound species</span>
    <span class="c1"># Matrix species</span>
    <span class="n">ATP_x</span> <span class="o">=</span> <span class="n">sumATP_x</span> <span class="o">/</span> <span class="n">PATP_x</span> <span class="c1"># [ATP4-]_x</span>
    <span class="n">ADP_x</span> <span class="o">=</span> <span class="n">sumADP_x</span> <span class="o">/</span> <span class="n">PADP_x</span> <span class="c1"># [ADP3-]_x</span>
    <span class="n">Pi_x</span>  <span class="o">=</span> <span class="n">sumPi_x</span>  <span class="o">/</span> <span class="n">PPi_x</span>  <span class="c1"># [HPO42-]_x</span>
    
    <span class="c1"># Cytosolic species </span>
    <span class="n">ATP_c</span> <span class="o">=</span> <span class="n">sumATP_c</span> <span class="o">/</span> <span class="n">PATP_c</span> <span class="c1"># [ATP4-]_c</span>
    <span class="n">ADP_c</span> <span class="o">=</span> <span class="n">sumADP_c</span> <span class="o">/</span> <span class="n">PADP_c</span> <span class="c1"># [ADP3-]_c</span>
    <span class="n">Pi_c</span>  <span class="o">=</span> <span class="n">sumPi_c</span>  <span class="o">/</span> <span class="n">PPi_c</span>  <span class="c1"># [HPO42-]_c</span>
    
    <span class="c1">###### NADH Dehydrogenase ######</span>

    <span class="c1"># Constants</span>
    <span class="n">r</span>      <span class="o">=</span> <span class="mf">6.8385</span>
    <span class="n">k_Pi1</span>  <span class="o">=</span> <span class="mf">4.659e-4</span>    <span class="c1"># mol (L matrix water)**(-1)</span>
    <span class="n">k_Pi2</span>  <span class="o">=</span> <span class="mf">6.578e-4</span>    <span class="c1"># mol (L matrix water)**(-1)</span>
    
    <span class="c1"># Flux</span>
    <span class="n">J_DH</span> <span class="o">=</span> <span class="n">X_DH</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">NAD_x</span> <span class="o">-</span> <span class="n">NADH_x</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sumPi_x</span> <span class="o">/</span> <span class="n">k_Pi1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">sumPi_x</span> <span class="o">/</span> <span class="n">k_Pi2</span><span class="p">))</span>

    <span class="c1">###### Complex I ######</span>
    <span class="c1"># NADH_x + Q_x + 5H+_x &lt;-&gt; NAD+_x + QH2_x + 4H+_i + 4DPsi</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">109680</span> 
    <span class="n">DrGapp_C1</span> <span class="o">=</span> <span class="n">DrGo_C1</span> <span class="o">-</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_x</span><span class="p">)</span> 
    
    <span class="c1"># Apparent equilibrium constant </span>
    <span class="n">Kapp_C1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C1</span> <span class="o">+</span> <span class="n">n_C1</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C1</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C1</span> <span class="o">=</span> <span class="n">X_C1</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_C1</span> <span class="o">*</span> <span class="n">NADH_x</span> <span class="o">*</span> <span class="n">Q_x</span> <span class="o">-</span> <span class="n">NAD_x</span> <span class="o">*</span> <span class="n">QH2_x</span><span class="p">)</span>
    
    <span class="c1">###### Complex III ######</span>
    <span class="c1"># QH2_x + 2cuvetteC(ox)3+_i + 2H+_x &lt;-&gt; Q_x + 2cuvetteC(red)2+_i + 4H+_i + 2DPsi</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C3</span> <span class="o">=</span> <span class="mi">46690</span> 
    <span class="n">DrGapp_C3</span> <span class="o">=</span> <span class="n">DrGo_C3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_c</span><span class="p">)</span> 
    
    <span class="c1"># Apparent equilibrium constant </span>
    <span class="n">Kapp_C3</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C3</span> <span class="o">+</span> <span class="n">n_C3</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C3</span> 
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C3</span> <span class="o">=</span> <span class="n">X_C3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_C3</span> <span class="o">*</span> <span class="n">cox_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">QH2_x</span> <span class="o">-</span> <span class="n">cred_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Q_x</span><span class="p">)</span>

    <span class="c1">###### Complex IV ######</span>
    <span class="c1"># 2 cytoC(red)2+_i + 0.5O2_x + 4H+_x &lt;-&gt; cytoC(ox)3+_x + H2O_x + 2H+_i +2DPsi</span>
    
    <span class="c1"># Constant</span>
    <span class="n">k_O2</span> <span class="o">=</span> <span class="mf">1.2e-4</span>      <span class="c1"># mol (L matrix water)**(-1)</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C4</span> <span class="o">=</span> <span class="o">-</span><span class="mi">202160</span>  <span class="c1"># J mol**(-1)</span>
    <span class="n">DrGapp_C4</span> <span class="o">=</span> <span class="n">DrGo_C4</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_c</span><span class="p">)</span>
    
    <span class="c1"># Apparent equilibrium constant </span>
    <span class="n">Kapp_C4</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C4</span> <span class="o">+</span> <span class="n">n_C4</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C4</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C4</span> <span class="o">=</span> <span class="n">X_C4</span> <span class="o">*</span><span class="p">(</span><span class="n">Kapp_C4</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">cred_i</span> <span class="o">*</span> <span class="n">O2_x</span><span class="o">**</span><span class="mf">0.25</span> <span class="o">-</span> <span class="n">cox_i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">k_O2</span> <span class="o">/</span> <span class="n">O2_x</span><span class="p">))</span>

    <span class="c1">###### F1F0-ATPase ######</span>
    <span class="c1"># ADP3-_x + HPO42-_x + H+_x + n_A*H+_i &lt;-&gt; ATP4- + H2O + n_A*H+_x</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_F</span> <span class="o">=</span> <span class="mi">4990</span> 
    <span class="n">DrGapp_F</span> <span class="o">=</span> <span class="n">DrGo_F</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">PATP_x</span> <span class="o">/</span> <span class="p">(</span><span class="n">PADP_x</span> <span class="o">*</span> <span class="n">PPi_x</span><span class="p">))</span>
    
    <span class="c1"># Apparent equilibrium constant</span>
    <span class="n">Kapp_F</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="p">(</span><span class="n">DrGapp_F</span> <span class="o">+</span> <span class="n">n_F</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">H_x</span><span class="p">)</span><span class="o">**</span><span class="n">n_F</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_F</span> <span class="o">=</span> <span class="n">X_F</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_F</span> <span class="o">*</span> <span class="n">sumADP_x</span> <span class="o">*</span> <span class="n">sumPi_x</span> <span class="o">-</span> <span class="n">sumATP_x</span><span class="p">)</span>
    
    <span class="c1">###### ANT ######</span>
    <span class="c1"># ATP4-_x + ADP3-_i &lt;-&gt; ATP4-_i + ADP3-_x</span>
    
    <span class="c1"># Constants </span>
    <span class="n">del_D</span>   <span class="o">=</span> <span class="mf">0.0167</span>
    <span class="n">del_T</span>   <span class="o">=</span> <span class="mf">0.0699</span>
    <span class="n">k2o_ANT</span> <span class="o">=</span> <span class="mf">9.54</span><span class="o">/</span><span class="mi">60</span>      <span class="c1"># s**(-1)</span>
    <span class="n">k3o_ANT</span> <span class="o">=</span> <span class="mf">30.05</span><span class="o">/</span><span class="mi">60</span>     <span class="c1"># s**(-1)</span>
    <span class="n">K0o_D</span>   <span class="o">=</span> <span class="mf">38.89e-6</span>     <span class="c1"># mol (L cuvette water)**(-1)</span>
    <span class="n">K0o_T</span>   <span class="o">=</span> <span class="mf">56.05e-6</span>     <span class="c1"># mol (L cuvette water)**(-1)</span>
    <span class="n">A</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2829</span>
    <span class="n">B</span>       <span class="o">=</span> <span class="o">-</span><span class="mf">0.2086</span>
    <span class="n">C</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2372</span>
    
    <span class="n">phi</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    
    <span class="c1"># Reaction rates</span>
    <span class="n">k2_ANT</span> <span class="o">=</span> <span class="n">k2o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">k3_ANT</span> <span class="o">=</span> <span class="n">k3o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="c1"># Dissociation constants</span>
    <span class="n">K0_D</span> <span class="o">=</span> <span class="n">K0o_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">del_D</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">K0_T</span> <span class="o">=</span> <span class="n">K0o_T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">del_T</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="n">q</span>     <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">K0_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">K0_T</span><span class="p">)</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">ADP_c</span> <span class="o">*</span> <span class="n">q</span> <span class="o">/</span> <span class="n">K0_D</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">ADP_x</span> <span class="o">*</span> <span class="n">ATP_c</span> <span class="o">/</span> <span class="n">K0_T</span>
    <span class="n">num</span>   <span class="o">=</span> <span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span>
    <span class="n">den</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">ATP_c</span><span class="o">/</span><span class="n">K0_T</span> <span class="o">+</span> <span class="n">ADP_c</span><span class="o">/</span><span class="n">K0_D</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ADP_x</span> <span class="o">+</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_ANT</span> <span class="o">=</span> <span class="n">E_ANT</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span>
    
    <span class="c1">###### H+-PI2 cotransporter ######</span>
    <span class="c1"># H2PO42-_x + H+_x = H2PO42-_c + H+_c</span>
    
    <span class="c1"># Constant</span>
    <span class="n">k_PiC</span> <span class="o">=</span> <span class="mf">1.61e-3</span>  <span class="c1"># mol (L cuvette)**(-1)</span>
    
    <span class="c1"># H2P04- species</span>
    <span class="n">HPi_c</span> <span class="o">=</span> <span class="n">Pi_c</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">K_HPi</span><span class="p">)</span>
    <span class="n">HPi_x</span> <span class="o">=</span> <span class="n">Pi_x</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">K_HPi</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_PiC</span> <span class="o">=</span> <span class="n">E_PiC</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">*</span> <span class="n">HPi_c</span> <span class="o">-</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">HPi_x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_PiC</span> <span class="o">+</span> <span class="n">HPi_c</span><span class="p">)</span>

    <span class="c1">###### H+ leak ######</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_H</span> <span class="o">=</span> <span class="n">X_H</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">phi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">phi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="c1">###### ATPase ######</span>
    <span class="c1"># ATP4- + H2O = ADP3- + PI2- + H+</span>
    
    <span class="c1">#Flux (mol (s * L cyto)**(-1))</span>
    <span class="n">J_AtC</span> <span class="o">=</span> <span class="n">X_AtC</span> <span class="o">/</span> <span class="n">V_c</span>

    <span class="c1">###### Differential equations (equation 23) ######</span>
    <span class="c1"># Membrane potential</span>
    <span class="n">dDPsi</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_C1</span> <span class="o">*</span> <span class="n">J_C1</span> <span class="o">+</span> <span class="n">n_C3</span> <span class="o">*</span> <span class="n">J_C3</span> <span class="o">+</span> <span class="n">n_C4</span> <span class="o">*</span> <span class="n">J_C4</span> <span class="o">-</span> <span class="n">n_F</span> <span class="o">*</span> <span class="n">J_F</span> <span class="o">-</span> <span class="n">J_ANT</span> <span class="o">-</span> <span class="n">J_H</span><span class="p">)</span> <span class="o">/</span> <span class="n">Cm</span>

    <span class="c1"># Matrix species</span>
    <span class="n">dATP_x</span>  <span class="o">=</span> <span class="p">(</span><span class="n">J_F</span>  <span class="o">-</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dADP_x</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">J_F</span> <span class="o">+</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dPi_x</span>   <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">J_F</span> <span class="o">+</span> <span class="n">J_PiC</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dNADH_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">J_DH</span>  <span class="o">-</span> <span class="n">J_C1</span><span class="p">)</span>  <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dQH2_x</span>  <span class="o">=</span> <span class="p">(</span><span class="n">J_C1</span>  <span class="o">-</span> <span class="n">J_C3</span><span class="p">)</span>  <span class="o">/</span> <span class="n">W_x</span>
    
    <span class="c1"># IMS species</span>
    <span class="n">dcred_i</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">J_C3</span> <span class="o">-</span> <span class="n">J_C4</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_i</span>
    
    <span class="c1"># Buffer species</span>
    <span class="n">dATP_c</span> <span class="o">=</span> <span class="p">(</span> <span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span> <span class="o">-</span> <span class="n">J_AtC</span> <span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dADP_c</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span> <span class="o">+</span> <span class="n">J_AtC</span> <span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dPi_c</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_PiC</span> <span class="o">+</span> <span class="n">J_AtC</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>

    <span class="n">dX</span> <span class="o">=</span> <span class="p">[</span><span class="n">dDPsi</span><span class="p">,</span> <span class="n">dATP_x</span><span class="p">,</span> <span class="n">dADP_x</span><span class="p">,</span> <span class="n">dPi_x</span><span class="p">,</span> <span class="n">dNADH_x</span><span class="p">,</span> <span class="n">dQH2_x</span><span class="p">,</span> <span class="n">dcred_i</span><span class="p">,</span> <span class="n">dATP_c</span><span class="p">,</span> <span class="n">dADP_c</span><span class="p">,</span> <span class="n">dPi_c</span><span class="p">]</span>
    
    <span class="c1"># Need to be able to calculate fluxes after the fact </span>
    <span class="k">if</span> <span class="n">solve_ode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dX</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">PATP_x</span><span class="p">,</span> <span class="n">PADP_x</span><span class="p">,</span> <span class="n">PPi_x</span><span class="p">,</span> <span class="n">PATP_c</span><span class="p">,</span> <span class="n">PADP_c</span><span class="p">,</span> <span class="n">PPi_c</span><span class="p">,</span> <span class="n">J_DH</span><span class="p">,</span> <span class="n">J_C1</span><span class="p">,</span> <span class="n">J_C3</span><span class="p">,</span> <span class="n">J_C4</span><span class="p">,</span> <span class="n">J_F</span><span class="p">,</span> <span class="n">J_ANT</span><span class="p">,</span> <span class="n">J_PiC</span><span class="p">,</span> <span class="n">DrGapp_F</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">dX</span><span class="p">,</span> <span class="n">J</span>
   
    
<span class="c1"># Time vector </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
    
<span class="c1"># Solve ODE</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">X_0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">activity_array</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">DPsi</span><span class="p">,</span> <span class="n">sumATP_x</span><span class="p">,</span><span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">NADH_x</span><span class="p">,</span> <span class="n">QH2_x</span><span class="p">,</span> <span class="n">cred_i</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="p">,</span> <span class="n">sumPi_c</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">y</span>

<span class="c1"># Plot figures </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumATP_x</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ATP]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumADP_x</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ADP]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$Pi]$_x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mM)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span><span class="mf">10.5</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ATP]$_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$ADP]$_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sumPi_c</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;[$\Sigma$Pi]$_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mM)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span><span class="mf">10.5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/BuildingModel_21_0.png" src="_images/BuildingModel_21_0.png" />
</div>
</div>
<p>The above simulations reach a final steady state where the phophate metabolite concentrations are <span class="math notranslate nohighlight">\([\text{ATP}]_x = 0.9 \ \text{mM}\)</span>, <span class="math notranslate nohighlight">\([\text{ADP}]_x = 9.1 \ \text{mM} \)</span>, <span class="math notranslate nohighlight">\([\text{Pi}]_x = 0.4 \ \text{mM}\)</span>, <span class="math notranslate nohighlight">\([\text{ATP}]_c = 9.9 \ \text{mM}\)</span>, <span class="math notranslate nohighlight">\([\text{ADP}]_c = 0.1 \ \text{mM}\)</span>, <span class="math notranslate nohighlight">\([\text{Pi}]_c = 0.2 \ \text{mM}\)</span>, and the membrane potential is <span class="math notranslate nohighlight">\(186 \ \text{mV}\)</span>. This state represents a <em>resting</em> energetic state with no ATP hydrolyis in the cytosol. The Gibbs energy of ATP hydrolysis associated with this predicted state is <span class="math notranslate nohighlight">\(\Delta G_{\rm ATP} = \text{-}70 \ \text{kJ mol}^{-1}\)</span>, as calculated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sumATP_c_ss</span> <span class="o">=</span> <span class="n">sumATP_c</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">sumADP_c_ss</span> <span class="o">=</span> <span class="n">sumADP_c</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">sumPi_c_ss</span> <span class="o">=</span> <span class="n">sumPi_c</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">H_c</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_c</span><span class="p">)</span> <span class="c1"># mol (L cuvette water)**(-1)</span>
<span class="c1"># Thermochemical constants</span>
<span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span>          <span class="c1"># J (mol K)**(-1)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">+</span> <span class="mf">273.15</span>    <span class="c1"># K</span>

<span class="c1"># Dissociation constants</span>
<span class="n">K_MgATP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.88</span><span class="p">)</span>
<span class="n">K_HATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.33</span><span class="p">)</span>
<span class="n">K_KATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">K_MgADP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.00</span><span class="p">)</span>
<span class="n">K_HADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.26</span><span class="p">)</span>
<span class="n">K_KADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.89</span><span class="p">)</span>
<span class="n">K_MgPi</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.66</span><span class="p">)</span>
<span class="n">K_HPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.62</span><span class="p">)</span>
<span class="n">K_KPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.42</span><span class="p">)</span>

<span class="c1">## Binding polynomials</span>
<span class="c1"># Cytosol species # mol (L cuvette water)**(-1)</span>
<span class="n">PATP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KATP</span>
<span class="n">PADP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KADP</span>
<span class="n">PPi_c</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KPi</span>

<span class="n">DrGo_ATP</span> <span class="o">=</span> <span class="mi">4990</span>
<span class="n">DrG_ATP_apparent</span> <span class="o">=</span> <span class="n">DrGo_ATP</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_c</span> <span class="o">*</span> <span class="n">PATP_c</span> <span class="o">/</span> <span class="p">(</span><span class="n">PADP_c</span> <span class="o">*</span> <span class="n">PPi_c</span><span class="p">))</span>

<span class="c1"># Use equation 9 to calculate cytosolic Gibbs energy </span>
<span class="n">DrG_ATP</span> <span class="o">=</span> <span class="n">DrG_ATP_apparent</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">sumADP_c_ss</span> <span class="o">*</span> <span class="n">sumPi_c_ss</span> <span class="o">/</span> <span class="n">sumATP_c_ss</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cytosolic Gibbs energy of ATP hydrolysis (kJ mol^(-1))&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DrG_ATP</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cytosolic Gibbs energy of ATP hydrolysis (kJ mol^(-1))
-70.22745953514723
</pre></div>
</div>
</div>
</div>
</div>
</div>
<span id="document-InVitroModel"></span><div class="section" id="simulation-of-respiratory-control-in-vitro">
<h3>Simulation of respiratory control in vitro<a class="headerlink" href="#simulation-of-respiratory-control-in-vitro" title="Permalink to this headline">¶</a></h3>
<p>The integrated model developed in the previous section can be adapted to simulate in vitro experiments performed using suspensions of mitochondria purified from primary tissues. To simulate in vitro experiments, the major change that we make to the model is to replace the cytosolic components of the model with variables and associated volumes of distribution representing experimental buffers used in specific experiments. Here, we set <span class="math notranslate nohighlight">\(V_c = 1\)</span>, <span class="math notranslate nohighlight">\(V_m = 5\text{e-}4\)</span>, and <span class="math notranslate nohighlight">\(W_c = 1\)</span> to represent mitochondria suspended in a buffer solution, i.e., in this virtual experiment, the mitochondria take up <span class="math notranslate nohighlight">\(0.05\%\)</span> of the volume of the experimental media.</p>
<p>The following code simulates an experiment in which the non-energized mitochondrial state (state 1), is followed by a leak state (state 2), followed by oxidative phosphorylation state (state 3), followed by another leak state (state 4) <a class="bibtex reference internal" href="Abstract.html#gnaiger2020" id="id1">[10]</a>. The virtual experiment represents a real experiment in which a purified suspension of mitochondria is introduced to a buffer containing no fuel substrates at time <span class="math notranslate nohighlight">\(t=0\)</span>. This non-energized state is simulated by setting the dehydrogenase activity in the model to <span class="math notranslate nohighlight">\(X_{\rm DH} = 0\)</span> for <span class="math notranslate nohighlight">\(0 \leq t &lt; 25 \ \text{s}\)</span>. State 2 is achieved by setting <span class="math notranslate nohighlight">\(X_{\rm DH}\)</span> to <span class="math notranslate nohighlight">\(0.1732\)</span> for <span class="math notranslate nohighlight">\(25 \leq t &lt; 75 \ \text{s}\)</span> to represent the addision of substrates (such as pyruvate and malate) to fuel NADH production. At time <span class="math notranslate nohighlight">\(t = 75 \ \text{s}\)</span>, <span class="math notranslate nohighlight">\(0.375 \ \mu\text{M}\)</span> of ADP is introduced into the respiration buffer to initiate the active oxidative phosphorylation state, or state 3. State 4 occurs when the ADP is nearly fully phosphorylated at approximately <span class="math notranslate nohighlight">\(t = 170 \ \text{s}\)</span>, and the system returns to a leak state. Note that this experiment is conducted under high external inorganic phosphate conditions (i.e., <span class="math notranslate nohighlight">\([\text{Pi}]_c = 5 \ \text{mM}\)</span>).</p>
<table class="docutils align-default" id="table-invitro">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Isolated mitochondria in silico experiment.</span><a class="headerlink" href="#table-invitro" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter or Condition</p></th>
<th class="head"><p>State 1</p></th>
<th class="head"><p>State 2</p></th>
<th class="head"><p>State 3 and 4</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(X_\text{DH}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.1732\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\( - \)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\([\text{NADH}]_x\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\([\text{ATP}]_c\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\([\text{ADP}]_c\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\( -\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(+375\)</span> <span class="math notranslate nohighlight">\(\mu\)</span>M</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\([\text{Pi}]_c\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-\)</span></p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">###### Constants defining metabolite pools ######</span>
<span class="c1"># Volume fractions and water space fractions</span>
<span class="n">V_c</span> <span class="o">=</span> <span class="mf">1.0</span>          <span class="c1"># buffer volume fraction        # L buffer (L cuvette)**(-1)</span>
<span class="n">V_m</span> <span class="o">=</span> <span class="mf">0.0005</span>       <span class="c1"># mitochondrial volume fraction # L mito (L cuvette)**(-1)</span>
<span class="n">V_m2c</span> <span class="o">=</span> <span class="n">V_m</span> <span class="o">/</span> <span class="n">V_c</span>  <span class="c1"># mito to cyto volume ratio     # L mito (L cuvette)**(-1)</span>
<span class="n">W_c</span> <span class="o">=</span> <span class="mf">1.0</span>          <span class="c1"># buffer water space            # L buffer water (L buffer)**(-1)</span>
<span class="n">W_m</span> <span class="o">=</span> <span class="mf">0.7238</span>       <span class="c1"># mitochondrial water space     # L mito water (L mito)**(-1)</span>
<span class="n">W_x</span> <span class="o">=</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># matrix water space            # L matrix water (L mito)**(-1)</span>
<span class="n">W_i</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># intermembrane water space     # L IM water (L mito)**(-1)</span>

<span class="c1"># Total pool concentrations</span>
<span class="n">NAD_tot</span> <span class="o">=</span> <span class="mf">2.97e-3</span>  <span class="c1"># NAD+ and NADH conc            # mol (L matrix water)**(-1)</span>
<span class="n">Q_tot</span>   <span class="o">=</span> <span class="mf">1.35e-3</span>  <span class="c1"># Q and QH2 conc                # mol (L matrix water)**(-1)</span>
<span class="n">c_tot</span>   <span class="o">=</span> <span class="mf">2.7e-3</span>   <span class="c1"># cytochrome c ox and red conc  # mol (L IM water)**(-1)</span>

<span class="c1"># Membrane capacitance</span>
<span class="n">Cm</span> <span class="o">=</span> <span class="mf">3.1e-3</span>

<span class="c1">###### Set fixed pH, cation concentrations, and O2 partial pressure ######</span>
<span class="c1"># pH</span>
<span class="n">pH_x</span> <span class="o">=</span> <span class="mf">7.40</span>
<span class="n">pH_c</span> <span class="o">=</span> <span class="mf">7.20</span>

<span class="c1"># K+ concentrations</span>
<span class="n">K_x</span>  <span class="o">=</span> <span class="mf">100e-3</span>      <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">K_c</span>  <span class="o">=</span> <span class="mf">140e-3</span>      <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Mg2+ concentrations</span>
<span class="n">Mg_x</span> <span class="o">=</span> <span class="mf">1.0e-3</span>        <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">Mg_c</span> <span class="o">=</span> <span class="mf">1.0e-3</span>        <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Oxygen partial pressure</span>
<span class="n">PO2</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1"># mmHg</span>

<span class="c1">###### Parameter vector ###### </span>
<span class="n">X_DH</span>  <span class="o">=</span> <span class="mf">0.1732</span>
<span class="n">X_C1</span>  <span class="o">=</span> <span class="mf">1.0e4</span>
<span class="n">X_C3</span>  <span class="o">=</span> <span class="mf">1.0e6</span>
<span class="n">X_C4</span>  <span class="o">=</span> <span class="mf">0.0125</span>
<span class="n">X_F</span>   <span class="o">=</span> <span class="mf">1.0e3</span>
<span class="n">E_ANT</span> <span class="o">=</span> <span class="mf">0.325</span>
<span class="n">E_PiC</span> <span class="o">=</span> <span class="mf">5.0e6</span>
<span class="n">X_H</span>   <span class="o">=</span> <span class="mf">1.0e3</span>
<span class="n">X_AtC</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_AtC</span><span class="p">])</span>

<span class="c1">###### Initial Conditions ######</span>
<span class="c1"># Membrane Potential</span>
<span class="n">DPsi_0</span> <span class="o">=</span> <span class="mi">175</span><span class="o">/</span><span class="mi">1000</span>      <span class="c1"># V</span>

<span class="c1"># Matrix species</span>
<span class="n">sumATP_x_0</span> <span class="o">=</span> <span class="mf">0.5e-3</span>        <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">sumADP_x_0</span> <span class="o">=</span> <span class="mf">9.5e-3</span>        <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">sumPi_x_0</span>  <span class="o">=</span> <span class="mf">0.3e-3</span>        <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">NADH_x_0</span>   <span class="o">=</span> <span class="mi">0</span>             <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">QH2_x_0</span>    <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Q_tot</span>   <span class="c1"># mol (L matrix water)**(-1)</span>

<span class="c1"># IMS species</span>
<span class="n">cred_i_0</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">c_tot</span> <span class="c1"># mol (L IMS water)**(-1)</span>

<span class="c1"># Cytosolic species</span>
<span class="n">sumATP_c_0</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># mol (L cyto water)^(-1)</span>
<span class="n">sumADP_c_0</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># mol (L cyto water)^(-1)</span>
<span class="n">sumPi_c_0</span>  <span class="o">=</span> <span class="mf">5.0e-3</span>  <span class="c1"># mol (L cyto water)^(-1)</span>

<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">DPsi_0</span><span class="p">,</span> <span class="n">sumATP_x_0</span><span class="p">,</span> <span class="n">sumADP_x_0</span><span class="p">,</span> <span class="n">sumPi_x_0</span><span class="p">,</span> <span class="n">NADH_x_0</span><span class="p">,</span> <span class="n">QH2_x_0</span><span class="p">,</span> <span class="n">cred_i_0</span><span class="p">,</span> <span class="n">sumATP_c_0</span><span class="p">,</span> <span class="n">sumADP_c_0</span><span class="p">,</span> <span class="n">sumPi_c_0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">dXdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">activity_array</span><span class="p">,</span> <span class="n">solve_ode</span><span class="p">):</span>
    <span class="c1"># Unpack variables </span>
    <span class="n">DPsi</span><span class="p">,</span> <span class="n">sumATP_x</span><span class="p">,</span><span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">NADH_x</span><span class="p">,</span> <span class="n">QH2_x</span><span class="p">,</span> <span class="n">cred_i</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="p">,</span> <span class="n">sumPi_c</span> <span class="o">=</span> <span class="n">X</span>
    <span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_AtC</span> <span class="o">=</span> <span class="n">activity_array</span>

    <span class="c1"># Hydrogen ion concentration</span>
    <span class="n">H_x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_x</span><span class="p">)</span> <span class="c1"># mol (L matrix water)**(-1)</span>
    <span class="n">H_c</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_c</span><span class="p">)</span> <span class="c1"># mol (L cuvette water)**(-1)</span>

    <span class="c1"># Oxygen concentration</span>
    <span class="n">a_3</span>  <span class="o">=</span> <span class="mf">1.74e-6</span>   <span class="c1"># oxygen solubility in cuvette   # mol (L matrix water * mmHg)**(-1)</span>
    <span class="n">O2_x</span> <span class="o">=</span> <span class="n">a_3</span><span class="o">*</span><span class="n">PO2</span>   <span class="c1"># mol (L matrix water)**(-1)</span>

    <span class="c1"># Thermochemical constants</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span>          <span class="c1"># J (mol K)**(-1)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">+</span> <span class="mf">273.15</span>    <span class="c1"># K</span>
    <span class="n">F</span> <span class="o">=</span> <span class="mi">96485</span>          <span class="c1"># C mol**(-1)</span>
    
    <span class="c1"># Proton motive force parameters (dimensionless)</span>
    <span class="n">n_F</span>  <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">n_C1</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">n_C3</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">n_C4</span> <span class="o">=</span> <span class="mi">4</span>
    
    <span class="c1"># Dissociation constants</span>
    <span class="n">K_MgATP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.88</span><span class="p">)</span>
    <span class="n">K_HATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.33</span><span class="p">)</span>
    <span class="n">K_KATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">K_MgADP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.00</span><span class="p">)</span>
    <span class="n">K_HADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.26</span><span class="p">)</span>
    <span class="n">K_KADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.89</span><span class="p">)</span>
    <span class="n">K_MgPi</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.66</span><span class="p">)</span>
    <span class="n">K_HPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.62</span><span class="p">)</span>
    <span class="n">K_KPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.42</span><span class="p">)</span>

    <span class="c1"># Other concentrations computed from the state variables</span>
    <span class="n">NAD_x</span> <span class="o">=</span> <span class="n">NAD_tot</span> <span class="o">-</span> <span class="n">NADH_x</span>  <span class="c1">## mol (L matrix water)**(-1)</span>
    <span class="n">Q_x</span>   <span class="o">=</span> <span class="n">Q_tot</span> <span class="o">-</span> <span class="n">QH2_x</span>     <span class="c1">## mol (L matrix water)**(-1)</span>
    <span class="n">cox_i</span> <span class="o">=</span> <span class="n">c_tot</span> <span class="o">-</span> <span class="n">cred_i</span>    <span class="c1">## mol (L matrix water)**(-1)</span>

    <span class="c1">## Binding polynomials</span>
    <span class="c1"># Matrix species # mol (L mito water)**(-1)</span>
    <span class="n">PATP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_x</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1"># Cytosol species # mol (L cuvette water)**(-1)</span>
    <span class="n">PATP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_c</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1">## Unbound species</span>
    <span class="c1"># Matrix species</span>
    <span class="n">ATP_x</span> <span class="o">=</span> <span class="n">sumATP_x</span> <span class="o">/</span> <span class="n">PATP_x</span> <span class="c1"># [ATP4-]_x</span>
    <span class="n">ADP_x</span> <span class="o">=</span> <span class="n">sumADP_x</span> <span class="o">/</span> <span class="n">PADP_x</span> <span class="c1"># [ADP3-]_x</span>
    <span class="n">Pi_x</span>  <span class="o">=</span> <span class="n">sumPi_x</span>  <span class="o">/</span> <span class="n">PPi_x</span>  <span class="c1"># [HPO42-]_x</span>
    
    <span class="c1"># Cytosolic species </span>
    <span class="n">ATP_c</span> <span class="o">=</span> <span class="n">sumATP_c</span> <span class="o">/</span> <span class="n">PATP_c</span> <span class="c1"># [ATP4-]_c</span>
    <span class="n">ADP_c</span> <span class="o">=</span> <span class="n">sumADP_c</span> <span class="o">/</span> <span class="n">PADP_c</span> <span class="c1"># [ADP3-]_c</span>
    <span class="n">Pi_c</span>  <span class="o">=</span> <span class="n">sumPi_c</span>  <span class="o">/</span> <span class="n">PPi_c</span>  <span class="c1"># [HPO42-]_c</span>
    
    
    <span class="c1">###### NADH Dehydrogenase ######</span>

    <span class="c1"># Constants</span>
    <span class="n">r</span>      <span class="o">=</span> <span class="mf">6.8385</span>
    <span class="n">k_Pi1</span>  <span class="o">=</span> <span class="mf">4.659e-4</span>    <span class="c1"># mol (L matrix water)**(-1)</span>
    <span class="n">k_Pi2</span>  <span class="o">=</span> <span class="mf">6.578e-4</span>    <span class="c1"># mol (L matrix water)**(-1)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_DH</span> <span class="o">=</span> <span class="n">X_DH</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">NAD_x</span> <span class="o">-</span> <span class="n">NADH_x</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sumPi_x</span> <span class="o">/</span> <span class="n">k_Pi1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">sumPi_x</span> <span class="o">/</span> <span class="n">k_Pi2</span><span class="p">))</span>

    <span class="c1">###### Complex I ######</span>
    <span class="c1"># NADH_x + Q_x + 5H+_x &lt;-&gt; NAD+_x + QH2_x + 4H+_i + 4DPsi</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">109680</span> 
    <span class="n">DrGapp_C1</span> <span class="o">=</span> <span class="n">DrGo_C1</span> <span class="o">-</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_x</span><span class="p">)</span> 
    
    <span class="c1"># Apparent equilibrium constant </span>
    <span class="n">Kapp_C1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C1</span> <span class="o">+</span> <span class="n">n_C1</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C1</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C1</span> <span class="o">=</span> <span class="n">X_C1</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_C1</span> <span class="o">*</span> <span class="n">NADH_x</span> <span class="o">*</span> <span class="n">Q_x</span> <span class="o">-</span> <span class="n">NAD_x</span> <span class="o">*</span> <span class="n">QH2_x</span><span class="p">)</span>
    
    <span class="c1">###### Complex III ######</span>
    <span class="c1"># QH2_x + 2cuvetteC(ox)3+_i + 2H+_x &lt;-&gt; Q_x + 2cuvetteC(red)2+_i + 4H+_i + 2DPsi</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C3</span> <span class="o">=</span> <span class="mi">46690</span> 
    <span class="n">DrGapp_C3</span> <span class="o">=</span> <span class="n">DrGo_C3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_c</span><span class="p">)</span> 
    
    <span class="c1"># Apparent equilibrium constant </span>
    <span class="n">Kapp_C3</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C3</span> <span class="o">+</span> <span class="n">n_C3</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C3</span> 
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C3</span> <span class="o">=</span> <span class="n">X_C3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_C3</span> <span class="o">*</span> <span class="n">cox_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">QH2_x</span> <span class="o">-</span> <span class="n">cred_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Q_x</span><span class="p">)</span>

    <span class="c1">###### Complex IV ######</span>
    <span class="c1"># 2 cytoC(red)2+_i + 0.5O2_x + 4H+_x &lt;-&gt; cytoC(ox)3+_x + H2O_x + 2H+_i +2DPsi</span>
    
    <span class="c1"># Constant</span>
    <span class="n">k_O2</span> <span class="o">=</span> <span class="mf">1.2e-4</span>      <span class="c1"># mol (L matrix water)**(-1)</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C4</span> <span class="o">=</span> <span class="o">-</span><span class="mi">202160</span>  <span class="c1"># J mol**(-1)</span>
    <span class="n">DrGapp_C4</span> <span class="o">=</span> <span class="n">DrGo_C4</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_c</span><span class="p">)</span>
    
    <span class="c1"># Apparent equilibrium constant </span>
    <span class="n">Kapp_C4</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C4</span> <span class="o">+</span> <span class="n">n_C4</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C4</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C4</span> <span class="o">=</span> <span class="n">X_C4</span> <span class="o">*</span><span class="p">(</span><span class="n">Kapp_C4</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">cred_i</span> <span class="o">*</span> <span class="n">O2_x</span><span class="o">**</span><span class="mf">0.25</span> <span class="o">-</span> <span class="n">cox_i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">k_O2</span> <span class="o">/</span> <span class="n">O2_x</span><span class="p">))</span>

    <span class="c1">###### F0F1-ATPase ######</span>
    <span class="c1"># ADP3-_x + HPO42-_x + H+_x + n_A*H+_i &lt;-&gt; ATP4- + H2O + n_A*H+_x</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_F</span> <span class="o">=</span> <span class="mi">4990</span> 
    <span class="n">DrGapp_F</span> <span class="o">=</span> <span class="n">DrGo_F</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">PATP_x</span> <span class="o">/</span> <span class="p">(</span><span class="n">PADP_x</span> <span class="o">*</span> <span class="n">PPi_x</span><span class="p">))</span>
    
    <span class="c1"># Apparent equilibrium constant</span>
    <span class="n">Kapp_F</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="p">(</span><span class="n">DrGapp_F</span> <span class="o">+</span> <span class="n">n_F</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">H_x</span><span class="p">)</span><span class="o">**</span><span class="n">n_F</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_F</span> <span class="o">=</span> <span class="n">X_F</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_F</span> <span class="o">*</span> <span class="n">sumADP_x</span> <span class="o">*</span> <span class="n">sumPi_x</span> <span class="o">-</span> <span class="n">sumATP_x</span><span class="p">)</span>
    
    <span class="c1">###### ANT ######</span>
    <span class="c1"># ATP4-_x + ADP3-_i &lt;-&gt; ATP4-_i + ADP3-_x</span>
    
    <span class="c1"># Constants </span>
    <span class="n">del_D</span>   <span class="o">=</span> <span class="mf">0.0167</span>
    <span class="n">del_T</span>   <span class="o">=</span> <span class="mf">0.0699</span>
    <span class="n">k2o_ANT</span> <span class="o">=</span> <span class="mf">9.54</span><span class="o">/</span><span class="mi">60</span>      <span class="c1"># s**(-1)</span>
    <span class="n">k3o_ANT</span> <span class="o">=</span> <span class="mf">30.05</span><span class="o">/</span><span class="mi">60</span>     <span class="c1"># s**(-1)</span>
    <span class="n">K0o_D</span>   <span class="o">=</span> <span class="mf">38.89e-6</span>     <span class="c1"># mol (L cuvette water)**(-1)</span>
    <span class="n">K0o_T</span>   <span class="o">=</span> <span class="mf">56.05e-6</span>     <span class="c1"># mol (L cuvette water)**(-1)</span>
    <span class="n">A</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2829</span>
    <span class="n">B</span>       <span class="o">=</span> <span class="o">-</span><span class="mf">0.2086</span>
    <span class="n">C</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2372</span>
    
    <span class="n">phi</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    
    <span class="c1"># Reaction rates</span>
    <span class="n">k2_ANT</span> <span class="o">=</span> <span class="n">k2o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">k3_ANT</span> <span class="o">=</span> <span class="n">k3o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="c1"># Dissociation constants</span>
    <span class="n">K0_D</span> <span class="o">=</span> <span class="n">K0o_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">del_D</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">K0_T</span> <span class="o">=</span> <span class="n">K0o_T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">del_T</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="n">q</span>     <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">K0_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">K0_T</span><span class="p">)</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">ADP_c</span> <span class="o">*</span> <span class="n">q</span> <span class="o">/</span> <span class="n">K0_D</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">ADP_x</span> <span class="o">*</span> <span class="n">ATP_c</span> <span class="o">/</span> <span class="n">K0_T</span>
    <span class="n">num</span>   <span class="o">=</span> <span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span>
    <span class="n">den</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">ATP_c</span><span class="o">/</span><span class="n">K0_T</span> <span class="o">+</span> <span class="n">ADP_c</span><span class="o">/</span><span class="n">K0_D</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ADP_x</span> <span class="o">+</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_ANT</span> <span class="o">=</span> <span class="n">E_ANT</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span>
    
    <span class="c1">###### H+-PI2 cotransporter ######</span>
    <span class="c1"># H2PO42-_x + H+_x = H2PO42-_c + H+_c</span>
    
    <span class="c1"># Constant</span>
    <span class="n">k_PiC</span> <span class="o">=</span> <span class="mf">1.61e-3</span>  <span class="c1"># mol (L cuvette)**(-1)</span>
    
    <span class="c1"># H2P04- species</span>
    <span class="n">HPi_c</span> <span class="o">=</span> <span class="n">Pi_c</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">K_HPi</span><span class="p">)</span>
    <span class="n">HPi_x</span> <span class="o">=</span> <span class="n">Pi_x</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">K_HPi</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_PiC</span> <span class="o">=</span> <span class="n">E_PiC</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">*</span> <span class="n">HPi_c</span> <span class="o">-</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">HPi_x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_PiC</span> <span class="o">+</span> <span class="n">HPi_c</span><span class="p">)</span>

    <span class="c1">###### H+ leak ######</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_H</span> <span class="o">=</span> <span class="n">X_H</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">phi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">phi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="c1">###### ATPase ######</span>
    <span class="c1"># ATP4- + H2O = ADP3- + PI2- + H+</span>
    
    <span class="c1">#Flux (mol (s * L cyto)**(-1))</span>
    <span class="n">J_AtC</span> <span class="o">=</span> <span class="n">X_AtC</span> <span class="o">/</span> <span class="n">V_c</span>

    <span class="c1">###### Differential equations (equation 23) ######</span>
    <span class="c1"># Membrane potential</span>
    <span class="n">dDPsi</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_C1</span> <span class="o">*</span> <span class="n">J_C1</span> <span class="o">+</span> <span class="n">n_C3</span> <span class="o">*</span> <span class="n">J_C3</span> <span class="o">+</span> <span class="n">n_C4</span> <span class="o">*</span> <span class="n">J_C4</span> <span class="o">-</span> <span class="n">n_F</span> <span class="o">*</span> <span class="n">J_F</span> <span class="o">-</span> <span class="n">J_ANT</span> <span class="o">-</span> <span class="n">J_H</span><span class="p">)</span> <span class="o">/</span> <span class="n">Cm</span>

    <span class="c1"># Matrix species</span>
    <span class="n">dATP_x</span>  <span class="o">=</span> <span class="p">(</span><span class="n">J_F</span>  <span class="o">-</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dADP_x</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">J_F</span> <span class="o">+</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dPi_x</span>   <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">J_F</span> <span class="o">+</span> <span class="n">J_PiC</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dNADH_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">J_DH</span>  <span class="o">-</span> <span class="n">J_C1</span><span class="p">)</span>  <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dQH2_x</span>  <span class="o">=</span> <span class="p">(</span><span class="n">J_C1</span>  <span class="o">-</span> <span class="n">J_C3</span><span class="p">)</span>  <span class="o">/</span> <span class="n">W_x</span>
    
    <span class="c1"># IMS species</span>
    <span class="n">dcred_i</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">J_C3</span> <span class="o">-</span> <span class="n">J_C4</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_i</span>
    
    <span class="c1"># Buffer species</span>
    <span class="n">dATP_c</span> <span class="o">=</span> <span class="p">(</span> <span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span> <span class="o">-</span> <span class="n">J_AtC</span> <span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dADP_c</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span> <span class="o">+</span> <span class="n">J_AtC</span> <span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dPi_c</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_PiC</span> <span class="o">+</span> <span class="n">J_AtC</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>

    <span class="n">dX</span> <span class="o">=</span> <span class="p">[</span><span class="n">dDPsi</span><span class="p">,</span> <span class="n">dATP_x</span><span class="p">,</span> <span class="n">dADP_x</span><span class="p">,</span> <span class="n">dPi_x</span><span class="p">,</span> <span class="n">dNADH_x</span><span class="p">,</span> <span class="n">dQH2_x</span><span class="p">,</span> <span class="n">dcred_i</span><span class="p">,</span> <span class="n">dATP_c</span><span class="p">,</span> <span class="n">dADP_c</span><span class="p">,</span> <span class="n">dPi_c</span><span class="p">]</span>
    
    <span class="c1"># Need to be able to calculate fluxes after the fact </span>
    <span class="k">if</span> <span class="n">solve_ode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dX</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">PATP_x</span><span class="p">,</span> <span class="n">PADP_x</span><span class="p">,</span> <span class="n">PPi_x</span><span class="p">,</span> <span class="n">PATP_c</span><span class="p">,</span> <span class="n">PADP_c</span><span class="p">,</span> <span class="n">PPi_c</span><span class="p">,</span> <span class="n">J_DH</span><span class="p">,</span> <span class="n">J_C1</span><span class="p">,</span> <span class="n">J_C3</span><span class="p">,</span> <span class="n">J_C4</span><span class="p">,</span> <span class="n">J_F</span><span class="p">,</span> <span class="n">J_ANT</span><span class="p">,</span> <span class="n">J_PiC</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">dX</span><span class="p">,</span> <span class="n">J</span>

<span class="c1">### Four State Model ###</span>
<span class="c1"># State 1 - no substrates</span>
<span class="n">t_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_AtC</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">X_DH</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Kept non-zero for solver stability</span>
<span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_AtC</span><span class="p">])</span>
<span class="n">state_1_results</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">],</span> <span class="n">X_0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">t_eval</span> <span class="o">=</span> <span class="n">t_1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">activity_array</span><span class="p">,</span><span class="mi">1</span><span class="p">,))</span>

<span class="c1"># State 2 - Add substrate (i.e. turn on X_DH)</span>
<span class="n">t_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">75</span><span class="p">,(</span><span class="mi">75</span> <span class="o">-</span> <span class="mi">25</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_DH</span> <span class="o">=</span> <span class="mf">0.0866</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_AtC</span><span class="p">])</span>
<span class="n">state_2_results</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span><span class="mi">75</span><span class="p">],</span> <span class="n">state_1_results</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">t_eval</span> <span class="o">=</span> <span class="n">t_2</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">activity_array</span><span class="p">,</span><span class="mi">1</span><span class="p">,))</span>

<span class="c1"># State 3 and 4 - Add ADP</span>
<span class="n">t_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">75</span><span class="p">,</span><span class="mi">200</span><span class="p">,(</span><span class="mi">200</span> <span class="o">-</span> <span class="mi">75</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">state_2_results</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.375e-3</span> <span class="c1"># Molar</span>
<span class="n">state_3_results</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="p">[</span><span class="mi">75</span><span class="p">,</span><span class="mi">200</span><span class="p">],</span> <span class="n">state_2_results</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">t_eval</span> <span class="o">=</span> <span class="n">t_3</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">activity_array</span><span class="p">,</span><span class="mi">1</span><span class="p">,))</span>

<span class="c1"># Concatenate Results</span>
<span class="c1"># Note: need to prevent duplicating points</span>
<span class="n">all_results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">state_1_results</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">state_2_results</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">state_3_results</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">state_1_results</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">state_2_results</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">state_3_results</span><span class="o">.</span><span class="n">t</span><span class="p">))</span>

<span class="n">DPsi</span><span class="p">,</span> <span class="n">sumATP_x</span><span class="p">,</span> <span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">NADH_x</span><span class="p">,</span> <span class="n">QH2_x</span><span class="p">,</span> <span class="n">cred_i</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="p">,</span> <span class="n">sumPi_c</span> <span class="o">=</span> <span class="n">all_results</span>


<span class="c1"># Calculate complex IV Flux</span>
<span class="n">J_C4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
    <span class="n">dX</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="n">dXdt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">all_results</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">activity_array</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">J_C4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>

<span class="c1"># Convert complex IV flux to oxygen flux in nmol O2 / U Citrate Synthase</span>
<span class="n">JO2</span> <span class="o">=</span> <span class="n">J_C4</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mf">1e9</span> <span class="o">*</span> <span class="mf">0.0000012232</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_full-width docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">205</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">205</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">),(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">205</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">75</span><span class="p">,</span><span class="mi">75</span><span class="p">),(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">205</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">150</span><span class="p">,</span><span class="mi">150</span><span class="p">),(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">205</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">JO2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">205</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">205</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="s1">&#39;State 1&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="s1">&#39;State 2&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">112.5</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="s1">&#39;State 3&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">175</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="s1">&#39;State 4&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Times (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;OCR (nmol O$_2$ min$^{-1}$ U CS$^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">205</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">),(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">75</span><span class="p">,</span><span class="mi">75</span><span class="p">),(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">150</span><span class="p">,</span><span class="mi">150</span><span class="p">),(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">NADH_x</span><span class="o">/</span><span class="n">NAD_tot</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">205</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;State 1&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;State 2&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">112.5</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;State 3&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">175</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;State 4&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Times (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[NADH]$_x$ (mM)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">75</span><span class="p">,</span><span class="mi">210</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">),(</span><span class="mi">75</span><span class="p">,</span><span class="mi">210</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">75</span><span class="p">,</span><span class="mi">75</span><span class="p">),(</span><span class="mi">75</span><span class="p">,</span><span class="mi">210</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">150</span><span class="p">,</span><span class="mi">150</span><span class="p">),(</span><span class="mi">75</span><span class="p">,</span><span class="mi">210</span><span class="p">),</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.75</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">DPsi</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">75</span><span class="p">,</span><span class="mi">210</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">205</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;State 1&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;State 2&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">112.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;State 3&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">175</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;State 4&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Times (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\Delta \Psi$ (mV)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/InVitroModel_3_0.png" src="_images/InVitroModel_3_0.png" />
</div>
</div>
<p>During the leak states, NADH and <span class="math notranslate nohighlight">\(\Delta\Psi\)</span> are maintained at a maximal values while the OCR represents the oxidative flux necessary to balance proton leak across the IMM. During state 3 (oxidative phosphorylation), the OCR markedly increases while the magnitudes of NADH and <span class="math notranslate nohighlight">\(\Delta\Psi\)</span> are temporarily decreased. This simple model overestimates the degree to which the NADH becomes depleted during state 3.</p>
<p>Predictions of the in vitro model may also be compared to quasi-steady state data on OCRs, phosphate metabolite levels, <span class="math notranslate nohighlight">\(\Delta\Psi\)</span>, NADH, and cytochrome c redox state, analyzed by Bazil et al. <a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id2">[15]</a>. In their experiments, several steady state ATP demand levels were achieved by titrating ATP hydrolyzing enzymes into the respiration buffer. We simulate this experiment with our model by varying the rate of the external ATP consuming process, <span class="math notranslate nohighlight">\(J_\text{AtC}\)</span>. We vary <span class="math notranslate nohighlight">\(J_\text{AtC}\)</span> by adusting the ATP consumption rate <span class="math notranslate nohighlight">\(X_\text{AtC}\)</span> from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(60 \ \text{mol s}^{-1} \ \text{(L cell)}^{-1}\)</span>. Experiments were conducted under conditions of two different approximately constant external phosphate concentrations (1 and 5 mM) and with external <span class="math notranslate nohighlight">\(\text{TAN} = 5 \ \text{mM}\)</span>. The following code computes the steady state of the in vitro model at different levels of <span class="math notranslate nohighlight">\(J_\text{AtC}\)</span> and compares the measured data on OCR, <span class="math notranslate nohighlight">\(\Delta\Psi\)</span>, NADH, cytochrome c redox state, and buffer ADP concentration to data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">###### Constants defining metabolite pools ######</span>
<span class="c1"># Volume fractions and water space fractions</span>
<span class="n">V_c</span> <span class="o">=</span> <span class="mf">1.0</span>          <span class="c1"># buffer volume fraction        # L buffer (L cuvette)**(-1)</span>
<span class="n">V_m</span> <span class="o">=</span> <span class="mf">0.0005</span>       <span class="c1"># mitochondrial volume fraction # L mito (L cuvette)**(-1)</span>
<span class="n">V_m2c</span> <span class="o">=</span> <span class="n">V_m</span> <span class="o">/</span> <span class="n">V_c</span>  <span class="c1"># mito to cyto volume ratio     # L mito (L cuvette)**(-1)</span>
<span class="n">W_c</span> <span class="o">=</span> <span class="mf">1.0</span>          <span class="c1"># buffer water space            # L buffer water (L buffer)**(-1)</span>
<span class="n">W_m</span> <span class="o">=</span> <span class="mf">0.7238</span>       <span class="c1"># mitochondrial water space     # L mito water (L mito)**(-1)</span>
<span class="n">W_x</span> <span class="o">=</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># matrix water space            # L matrix water (L mito)**(-1)</span>
<span class="n">W_i</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># intermembrane water space     # L IM water (L mito)**(-1)</span>

<span class="c1"># Total pool concentrations</span>
<span class="n">NAD_tot</span> <span class="o">=</span> <span class="mf">2.97e-3</span>  <span class="c1"># NAD+ and NADH conc            # mol (L matrix water)**(-1)</span>
<span class="n">Q_tot</span>   <span class="o">=</span> <span class="mf">1.35e-3</span>  <span class="c1"># Q and QH2 conc                # mol (L matrix water)**(-1)</span>
<span class="n">c_tot</span>   <span class="o">=</span> <span class="mf">2.7e-3</span>   <span class="c1"># cytochrome c ox and red conc  # mol (L IM water)**(-1)</span>

<span class="c1"># Membrane capacitance</span>
<span class="n">Cm</span> <span class="o">=</span> <span class="mf">3.1e-3</span>

<span class="c1">###### Set fixed pH, cation concentrations, and O2 partial pressure ######</span>
<span class="c1"># pH</span>
<span class="n">pH_x</span> <span class="o">=</span> <span class="mf">7.40</span>
<span class="n">pH_c</span> <span class="o">=</span> <span class="mf">7.20</span>

<span class="c1"># K+ concentrations</span>
<span class="n">K_x</span>  <span class="o">=</span> <span class="mf">100e-3</span>      <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">K_c</span>  <span class="o">=</span> <span class="mf">140e-3</span>      <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Mg2+ concentrations</span>
<span class="n">Mg_x</span> <span class="o">=</span> <span class="mf">1.0e-3</span>        <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">Mg_c</span> <span class="o">=</span> <span class="mf">1.0e-3</span>        <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Oxygen partial pressure</span>
<span class="n">PO2</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1"># mmHg</span>

<span class="n">conc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pH_x</span><span class="p">,</span> <span class="n">pH_c</span><span class="p">,</span> <span class="n">K_x</span><span class="p">,</span> <span class="n">K_c</span><span class="p">,</span> <span class="n">Mg_x</span><span class="p">,</span> <span class="n">Mg_c</span><span class="p">,</span> <span class="n">PO2</span><span class="p">])</span>

<span class="c1">###### Parameter vector ###### </span>
<span class="n">X_DH</span>  <span class="o">=</span> <span class="mf">0.1732</span>
<span class="n">X_C1</span>  <span class="o">=</span> <span class="mf">1.0e4</span>
<span class="n">X_C3</span>  <span class="o">=</span> <span class="mf">1.0e6</span>
<span class="n">X_C4</span>  <span class="o">=</span> <span class="mf">0.0125</span>
<span class="n">X_F</span>   <span class="o">=</span> <span class="mf">1.0e3</span>
<span class="n">E_ANT</span> <span class="o">=</span> <span class="mf">0.325</span>
<span class="n">E_PiC</span> <span class="o">=</span> <span class="mf">5.0e6</span>
<span class="n">X_H</span>   <span class="o">=</span> <span class="mf">1.0e3</span>
<span class="n">X_AtC</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_AtC</span><span class="p">])</span>

<span class="c1">###### Initial Conditions ######</span>
<span class="c1"># Membrane Potential</span>
<span class="n">Psi_0</span> <span class="o">=</span> <span class="mi">175</span><span class="o">/</span><span class="mi">1000</span>      <span class="c1"># Volts</span>

<span class="c1"># Total Pool Sizes</span>
<span class="n">NAD_tot</span> <span class="o">=</span> <span class="mf">2.97e-3</span>  <span class="c1"># NAD+ and NADH conc            # mol (L matrix water)^(-1)</span>
<span class="n">Q_tot</span>   <span class="o">=</span> <span class="mf">1.35e-3</span>  <span class="c1"># Q and QH2 conc                # mol (L matrix water)^(-1)</span>
<span class="n">c_tot</span>   <span class="o">=</span> <span class="mf">2.7e-3</span>

<span class="c1"># Matrix species</span>
<span class="n">sumATP_x_0</span> <span class="o">=</span> <span class="mf">0.5e-3</span>  <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">sumADP_x_0</span> <span class="o">=</span> <span class="mf">9.5e-3</span>  <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">sumPi_x_0</span>  <span class="o">=</span> <span class="mf">0.3e-3</span>  <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">NADH_x_0</span>   <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">NAD_tot</span>  <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">QH2_x_0</span>    <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Q_tot</span>    <span class="c1"># mol (L matrix water)**(-1)</span>

<span class="c1"># IMS species</span>
<span class="n">cred_i_0</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">c_tot</span> <span class="c1"># mol (L IMS water)**(-1)</span>

<span class="c1"># Cytosoo=lic species</span>
<span class="n">sumATP_c_0</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># mol (L cyto water)^(-1)</span>
<span class="n">sumADP_c_0</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># mol (L cyto water)^(-1)</span>
<span class="n">sumPi_c_0</span>  <span class="o">=</span> <span class="mf">5.0e-3</span>  <span class="c1"># mol (L cyto water)^(-1)</span>

<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Psi_0</span><span class="p">,</span> <span class="n">sumATP_x_0</span><span class="p">,</span> <span class="n">sumADP_x_0</span><span class="p">,</span> <span class="n">sumPi_x_0</span><span class="p">,</span> <span class="n">NADH_x_0</span><span class="p">,</span> <span class="n">QH2_x_0</span><span class="p">,</span> <span class="n">cred_i_0</span><span class="p">,</span> <span class="n">sumATP_c_0</span><span class="p">,</span> <span class="n">sumADP_c_0</span><span class="p">,</span> <span class="n">sumPi_c_0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">dXdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">activity_array</span><span class="p">,</span> <span class="n">solve_ode</span><span class="p">):</span>
    <span class="c1"># Unpack variables </span>
    <span class="n">DPsi</span><span class="p">,</span> <span class="n">sumATP_x</span><span class="p">,</span><span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">NADH_x</span><span class="p">,</span> <span class="n">QH2_x</span><span class="p">,</span> <span class="n">cred_i</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="p">,</span> <span class="n">sumPi_c</span> <span class="o">=</span> <span class="n">X</span>
    <span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_AtC</span> <span class="o">=</span> <span class="n">activity_array</span>

    <span class="c1"># Hydrogen ion concentration</span>
    <span class="n">H_x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_x</span><span class="p">)</span> <span class="c1"># mol (L matrix water)**(-1)</span>
    <span class="n">H_c</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_c</span><span class="p">)</span> <span class="c1"># mol (L cuvette water)**(-1)</span>

    <span class="c1"># Oxygen concentration</span>
    <span class="n">a_3</span>  <span class="o">=</span> <span class="mf">1.74e-6</span>   <span class="c1"># oxygen solubility in cuvette   # mol (L matrix water * mmHg)**(-1)</span>
    <span class="n">O2_x</span> <span class="o">=</span> <span class="n">a_3</span><span class="o">*</span><span class="n">PO2</span>   <span class="c1"># mol (L matrix water)**(-1)</span>

    <span class="c1"># Thermochemical constants</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span>          <span class="c1"># J (mol K)**(-1)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">+</span> <span class="mf">273.15</span>    <span class="c1"># K</span>
    <span class="n">F</span> <span class="o">=</span> <span class="mi">96485</span>          <span class="c1"># C mol**(-1)</span>
    
    <span class="c1"># Proton motive force parameters (dimensionless)</span>
    <span class="n">n_F</span>  <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">n_C1</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">n_C3</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">n_C4</span> <span class="o">=</span> <span class="mi">4</span>
    
    <span class="c1"># Dissociation constants</span>
    <span class="n">K_MgATP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.88</span><span class="p">)</span>
    <span class="n">K_HATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.33</span><span class="p">)</span>
    <span class="n">K_KATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">K_MgADP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.00</span><span class="p">)</span>
    <span class="n">K_HADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.26</span><span class="p">)</span>
    <span class="n">K_KADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.89</span><span class="p">)</span>
    <span class="n">K_MgPi</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.66</span><span class="p">)</span>
    <span class="n">K_HPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.62</span><span class="p">)</span>
    <span class="n">K_KPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.42</span><span class="p">)</span>

    <span class="c1">## Other concentrations computed from the state variables:</span>
    <span class="n">NAD_x</span> <span class="o">=</span> <span class="n">NAD_tot</span> <span class="o">-</span> <span class="n">NADH_x</span>  <span class="c1">## mol (L matrix water)**(-1)</span>
    <span class="n">Q_x</span>   <span class="o">=</span> <span class="n">Q_tot</span> <span class="o">-</span> <span class="n">QH2_x</span>     <span class="c1">## mol (L matrix water)**(-1)</span>
    <span class="n">cox_i</span> <span class="o">=</span> <span class="n">c_tot</span> <span class="o">-</span> <span class="n">cred_i</span>    <span class="c1">## mol (L matrix water)**(-1)</span>

    <span class="c1">## Binding polynomials</span>
    <span class="c1"># Matrix species # mol (L mito water)**(-1)</span>
    <span class="n">PATP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_x</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1"># Cytosol species # mol (L cuvette water)**(-1)</span>
    <span class="n">PATP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_c</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1">## Unbound species</span>
    <span class="c1"># Matrix species</span>
    <span class="n">ATP_x</span> <span class="o">=</span> <span class="n">sumATP_x</span> <span class="o">/</span> <span class="n">PATP_x</span> <span class="c1"># [ATP4-]_x</span>
    <span class="n">ADP_x</span> <span class="o">=</span> <span class="n">sumADP_x</span> <span class="o">/</span> <span class="n">PADP_x</span> <span class="c1"># [ADP3-]_x</span>
    <span class="n">Pi_x</span>  <span class="o">=</span> <span class="n">sumPi_x</span>  <span class="o">/</span> <span class="n">PPi_x</span>  <span class="c1"># [HPO42-]_x</span>
    
    <span class="c1"># Cytosol species</span>
    <span class="n">ATP_c</span> <span class="o">=</span> <span class="n">sumATP_c</span> <span class="o">/</span> <span class="n">PATP_c</span> <span class="c1"># [ATP4-]_c</span>
    <span class="n">ADP_c</span> <span class="o">=</span> <span class="n">sumADP_c</span> <span class="o">/</span> <span class="n">PADP_c</span> <span class="c1"># [ADP3-]_c</span>
    <span class="n">Pi_c</span>  <span class="o">=</span> <span class="n">sumPi_c</span>  <span class="o">/</span> <span class="n">PPi_c</span>  <span class="c1"># [HPO42-]_c</span>
    
    
    <span class="c1">###### NADH Dehydrogenase ######</span>

    <span class="c1"># Constants</span>
    <span class="n">r</span>      <span class="o">=</span> <span class="mf">6.8385</span>
    <span class="n">k_Pi1</span>  <span class="o">=</span> <span class="mf">4.659e-4</span>    <span class="c1"># mol (L matrix water)**(-1)</span>
    <span class="n">k_Pi2</span>  <span class="o">=</span> <span class="mf">6.578e-4</span>    <span class="c1"># mol (L matrix water)**(-1)</span>
    
    <span class="c1"># Flux</span>
    <span class="n">J_DH</span> <span class="o">=</span> <span class="n">X_DH</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">NAD_x</span> <span class="o">-</span> <span class="n">NADH_x</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sumPi_x</span> <span class="o">/</span> <span class="n">k_Pi1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">sumPi_x</span> <span class="o">/</span> <span class="n">k_Pi2</span><span class="p">))</span>

    <span class="c1">###### Complex I ######</span>
    <span class="c1"># NADH_x + Q_x + 5H+_x &lt;-&gt; NAD+_x + QH2_x + 4H+_i + 4DPsi</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">109680</span> 
    <span class="n">DrGapp_C1</span> <span class="o">=</span> <span class="n">DrGo_C1</span> <span class="o">-</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_x</span><span class="p">)</span> 
    
    <span class="c1"># Apparent equilibrium constant</span>
    <span class="n">Kapp_C1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C1</span> <span class="o">+</span> <span class="n">n_C1</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C1</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C1</span> <span class="o">=</span> <span class="n">X_C1</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_C1</span> <span class="o">*</span> <span class="n">NADH_x</span> <span class="o">*</span> <span class="n">Q_x</span> <span class="o">-</span> <span class="n">NAD_x</span> <span class="o">*</span> <span class="n">QH2_x</span><span class="p">)</span>
    
    <span class="c1">###### Complex III ######</span>
    <span class="c1"># QH2_x + 2cuvetteC(ox)3+_i + 2H+_x &lt;-&gt; Q_x + 2cuvetteC(red)2+_i + 4H+_i + 2DPsi</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C3</span> <span class="o">=</span> <span class="mi">46690</span>
    <span class="n">DrGapp_C3</span> <span class="o">=</span> <span class="n">DrGo_C3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_c</span><span class="p">)</span> 
    
    <span class="c1"># Apparent equilibrium constant</span>
    <span class="n">Kapp_C3</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C3</span> <span class="o">+</span> <span class="n">n_C3</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C3</span> 
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C3</span> <span class="o">=</span> <span class="n">X_C3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_C3</span> <span class="o">*</span> <span class="n">cox_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">QH2_x</span> <span class="o">-</span> <span class="n">cred_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Q_x</span><span class="p">)</span>

    <span class="c1">###### Complex IV ######</span>
    <span class="c1"># 2 cytoC(red)2+_i + 0.5O2_x + 4H+_x &lt;-&gt; cytoC(ox)3+_x + H2O_x + 2H+_i + 2DPsi</span>
    
    <span class="c1"># Constants</span>
    <span class="n">k_O2</span> <span class="o">=</span> <span class="mf">1.2e-4</span>      <span class="c1"># mol (L matrix water)**(-1)</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C4</span> <span class="o">=</span> <span class="o">-</span><span class="mi">202160</span>  <span class="c1"># J mol**(-1)</span>
    <span class="n">DrGapp_C4</span> <span class="o">=</span> <span class="n">DrGo_C4</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_c</span><span class="p">)</span>
    
    <span class="c1"># Apparent equilibrium constant</span>
    <span class="n">Kapp_C4</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C4</span> <span class="o">+</span> <span class="n">n_C4</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C4</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C4</span> <span class="o">=</span> <span class="n">X_C4</span> <span class="o">*</span><span class="p">(</span><span class="n">Kapp_C4</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">cred_i</span> <span class="o">*</span> <span class="n">O2_x</span><span class="o">**</span><span class="mf">0.25</span> <span class="o">-</span> <span class="n">cox_i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">k_O2</span> <span class="o">/</span> <span class="n">O2_x</span><span class="p">))</span>

    <span class="c1">###### F0F1-ATPase ######</span>
    <span class="c1"># ADP3-_x + HPO42-_x + H+_x + n_A*H+_i &lt;-&gt; ATP4- + H2O + n_A*H+_x</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_F</span> <span class="o">=</span> <span class="mi">4990</span> 
    <span class="n">DrGapp_F</span> <span class="o">=</span> <span class="n">DrGo_F</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">PATP_x</span> <span class="o">/</span> <span class="p">(</span><span class="n">PADP_x</span> <span class="o">*</span> <span class="n">PPi_x</span><span class="p">))</span>
    
    <span class="c1"># Apparent equilibrium constant</span>
    <span class="n">Kapp_F</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="p">(</span><span class="n">DrGapp_F</span> <span class="o">+</span> <span class="n">n_F</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">H_x</span><span class="p">)</span><span class="o">**</span><span class="n">n_F</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_F</span> <span class="o">=</span> <span class="n">X_F</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_F</span> <span class="o">*</span> <span class="n">sumADP_x</span> <span class="o">*</span> <span class="n">sumPi_x</span> <span class="o">-</span> <span class="n">sumATP_x</span><span class="p">)</span>
    
    <span class="c1">###### ANT ######</span>
    <span class="c1"># ATP4-_x + ADP3-_i &lt;-&gt; ATP4-_i + ADP3-_x</span>
    
    <span class="c1"># Constants</span>
    <span class="n">del_D</span>   <span class="o">=</span> <span class="mf">0.0167</span>
    <span class="n">del_T</span>   <span class="o">=</span> <span class="mf">0.0699</span>
    <span class="n">k2o_ANT</span> <span class="o">=</span> <span class="mf">9.54</span><span class="o">/</span><span class="mi">60</span>      <span class="c1"># s**(-1)</span>
    <span class="n">k3o_ANT</span> <span class="o">=</span> <span class="mf">30.05</span><span class="o">/</span><span class="mi">60</span>     <span class="c1"># s**(-1)</span>
    <span class="n">K0o_D</span>   <span class="o">=</span> <span class="mf">38.89e-6</span>     <span class="c1"># mol (L cuvette water)**(-1)</span>
    <span class="n">K0o_T</span>   <span class="o">=</span> <span class="mf">56.05e-6</span>     <span class="c1"># mol (L cuvette water)**(-1)</span>
    <span class="n">A</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2829</span>
    <span class="n">B</span>       <span class="o">=</span> <span class="o">-</span><span class="mf">0.2086</span>
    <span class="n">C</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2372</span>
    
    <span class="n">phi</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    
    <span class="c1"># Reaction rates</span>
    <span class="n">k2_ANT</span> <span class="o">=</span> <span class="n">k2o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">k3_ANT</span> <span class="o">=</span> <span class="n">k3o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="c1"># Dissociation constants</span>
    <span class="n">K0_D</span> <span class="o">=</span> <span class="n">K0o_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">del_D</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">K0_T</span> <span class="o">=</span> <span class="n">K0o_T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">del_T</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="n">q</span>     <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">K0_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">K0_T</span><span class="p">)</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">ADP_c</span> <span class="o">*</span> <span class="n">q</span> <span class="o">/</span> <span class="n">K0_D</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">ADP_x</span> <span class="o">*</span> <span class="n">ATP_c</span> <span class="o">/</span> <span class="n">K0_T</span>
    <span class="n">num</span>   <span class="o">=</span> <span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span>
    <span class="n">den</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">ATP_c</span><span class="o">/</span><span class="n">K0_T</span> <span class="o">+</span> <span class="n">ADP_c</span><span class="o">/</span><span class="n">K0_D</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ADP_x</span> <span class="o">+</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_ANT</span> <span class="o">=</span> <span class="n">E_ANT</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span>
    
    <span class="c1">###### H+-PI2 cotransporter ######</span>
    <span class="c1"># H2PO42-_x + H+_x = H2PO42-_c + H+_c</span>
    
    <span class="c1"># Constant</span>
    <span class="n">k_PiC</span> <span class="o">=</span> <span class="mf">1.61e-3</span>  <span class="c1"># mol (L cuvette)**(-1)</span>
    
    <span class="c1"># H2P04- species</span>
    <span class="n">HPi_c</span> <span class="o">=</span> <span class="n">Pi_c</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">K_HPi</span><span class="p">)</span>
    <span class="n">HPi_x</span> <span class="o">=</span> <span class="n">Pi_x</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">K_HPi</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_PiC</span> <span class="o">=</span> <span class="n">E_PiC</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">*</span> <span class="n">HPi_c</span> <span class="o">-</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">HPi_x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_PiC</span> <span class="o">+</span> <span class="n">HPi_c</span><span class="p">)</span>

    <span class="c1">###### H+ leak ######</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_H</span> <span class="o">=</span> <span class="n">X_H</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">phi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">phi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="c1">###### ATPase ######</span>
    <span class="c1"># ATP4- + H2O = ADP3- + PI2- + H+</span>
    
    <span class="c1">#Flux (mol (s * L cyto)**(-1))</span>
    <span class="n">J_AtC</span> <span class="o">=</span> <span class="n">X_AtC</span> <span class="o">/</span> <span class="n">V_c</span>

    <span class="c1">###### Differential equations (equation 23) ######</span>
    <span class="c1"># Membrane potential</span>
    <span class="n">dDPsi</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_C1</span> <span class="o">*</span> <span class="n">J_C1</span> <span class="o">+</span> <span class="n">n_C3</span> <span class="o">*</span> <span class="n">J_C3</span> <span class="o">+</span> <span class="n">n_C4</span> <span class="o">*</span> <span class="n">J_C4</span> <span class="o">-</span> <span class="n">n_F</span> <span class="o">*</span> <span class="n">J_F</span> <span class="o">-</span> <span class="n">J_ANT</span> <span class="o">-</span> <span class="n">J_H</span><span class="p">)</span> <span class="o">/</span> <span class="n">Cm</span>

    <span class="c1"># Matrix species</span>
    <span class="n">dATP_x</span>  <span class="o">=</span> <span class="p">(</span><span class="n">J_F</span>  <span class="o">-</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dADP_x</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">J_F</span> <span class="o">+</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dPi_x</span>   <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">J_F</span> <span class="o">+</span> <span class="n">J_PiC</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dNADH_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">J_DH</span>  <span class="o">-</span> <span class="n">J_C1</span><span class="p">)</span>  <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dQH2_x</span>  <span class="o">=</span> <span class="p">(</span><span class="n">J_C1</span>  <span class="o">-</span> <span class="n">J_C3</span><span class="p">)</span>  <span class="o">/</span> <span class="n">W_x</span>
    
    <span class="c1"># IMS species</span>
    <span class="n">dcred_i</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">J_C3</span> <span class="o">-</span> <span class="n">J_C4</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_i</span>
    
    <span class="c1"># Buffer species</span>
    <span class="n">dATP_c</span> <span class="o">=</span> <span class="p">(</span> <span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span> <span class="o">-</span> <span class="n">J_AtC</span> <span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dADP_c</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span> <span class="o">+</span> <span class="n">J_AtC</span> <span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dPi_c</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_PiC</span> <span class="o">+</span> <span class="n">J_AtC</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>

    <span class="n">dX</span> <span class="o">=</span> <span class="p">[</span><span class="n">dDPsi</span><span class="p">,</span> <span class="n">dATP_x</span><span class="p">,</span> <span class="n">dADP_x</span><span class="p">,</span> <span class="n">dPi_x</span><span class="p">,</span> <span class="n">dNADH_x</span><span class="p">,</span> <span class="n">dQH2_x</span><span class="p">,</span> <span class="n">dcred_i</span><span class="p">,</span> <span class="n">dATP_c</span><span class="p">,</span> <span class="n">dADP_c</span><span class="p">,</span> <span class="n">dPi_c</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">solve_ode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dX</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">PATP_x</span><span class="p">,</span> <span class="n">PADP_x</span><span class="p">,</span> <span class="n">PPi_x</span><span class="p">,</span> <span class="n">PATP_c</span><span class="p">,</span> <span class="n">PADP_c</span><span class="p">,</span> <span class="n">PPi_c</span><span class="p">,</span> <span class="n">J_DH</span><span class="p">,</span> <span class="n">J_C1</span><span class="p">,</span> <span class="n">J_C3</span><span class="p">,</span> <span class="n">J_C4</span><span class="p">,</span> <span class="n">J_F</span><span class="p">,</span> <span class="n">J_ANT</span><span class="p">,</span> <span class="n">J_PiC</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">dX</span><span class="p">,</span> <span class="n">J</span>


<span class="c1">###### Run Low Pi experiments ######</span>

<span class="c1"># Membrane potential</span>
<span class="n">DPsi_0</span> <span class="o">=</span> <span class="mi">175</span><span class="o">*</span><span class="mf">1e-3</span>

<span class="c1"># Matrix species</span>
<span class="n">ATP_x_0</span>  <span class="o">=</span> <span class="mf">0.5e-3</span>
<span class="n">ADP_x_0</span>  <span class="o">=</span> <span class="mf">9.5e-3</span>
<span class="n">Pi_x_0</span>   <span class="o">=</span> <span class="mf">0.3e-3</span>
<span class="n">NADH_x_0</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">NAD_tot</span>
<span class="n">QH2_x_0</span>  <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Q_tot</span>

<span class="c1"># IMS species</span>
<span class="n">cred_i_0</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">c_tot</span>

<span class="c1"># Cytosol species</span>
<span class="n">ATP_c_0</span> <span class="o">=</span> <span class="mf">5.0e-3</span>
<span class="n">ADP_c_0</span> <span class="o">=</span> <span class="mf">0.0e-3</span>
<span class="n">Pi_c_0</span>  <span class="o">=</span> <span class="mf">1.0e-3</span>

<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">DPsi_0</span><span class="p">,</span> <span class="n">ATP_x_0</span><span class="p">,</span> <span class="n">ADP_x_0</span><span class="p">,</span> <span class="n">Pi_x_0</span><span class="p">,</span> <span class="n">NADH_x_0</span><span class="p">,</span> <span class="n">QH2_x_0</span><span class="p">,</span> <span class="n">cred_i_0</span><span class="p">,</span> <span class="n">ATP_c_0</span><span class="p">,</span> <span class="n">ADP_c_0</span><span class="p">,</span> <span class="n">Pi_c_0</span> <span class="p">])</span>

<span class="c1"># range of ATP consumption rates</span>
<span class="n">X_AtC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">6e-6</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>   <span class="c1"># Increase max hydrolysis to find apparent Km.</span>
<span class="n">steady_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_AtC</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_0</span><span class="p">)))</span>
<span class="n">JO2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_AtC</span><span class="p">))</span>

<span class="c1"># looping through different ATP consumptions states</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_AtC</span><span class="p">)):</span>
   <span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_AtC</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
   <span class="c1"># run for long time to acheive steady-state</span>
   <span class="n">steady_state_temp_results</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">],</span> <span class="n">X_0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">activity_array</span><span class="p">,</span><span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
   <span class="n">steady_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">steady_state_temp_results</span>
   <span class="n">f</span><span class="p">,</span><span class="n">J</span> <span class="o">=</span> <span class="n">dXdt</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">steady_state_temp_results</span><span class="p">,</span> <span class="n">activity_array</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
   <span class="n">J_C4</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="c1"># oxygen flux in mol O / sec / (L mito)</span>

   <span class="c1"># convert to units of nmol / min / UCS</span>
   <span class="c1"># using the conversion factor 0.0012232 mL of mito per UCS</span>
   <span class="n">JO2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">J_C4</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mf">1e9</span> <span class="o">*</span> <span class="mf">0.0000012232</span>

<span class="n">DPsi_low_pi</span><span class="p">,</span> <span class="n">ATP_x_low_pi</span><span class="p">,</span> <span class="n">ADP_x_low_pi</span><span class="p">,</span> <span class="n">Pi_x_low_pi</span><span class="p">,</span> <span class="n">NADH_x_low_pi</span><span class="p">,</span> <span class="n">QH2_x_low_pi</span><span class="p">,</span> <span class="n">cred_i_low_pi</span><span class="p">,</span> <span class="n">ATP_c_low_pi</span><span class="p">,</span> <span class="n">ADP_c_low_pi</span><span class="p">,</span> <span class="n">Pi_c_low_pi</span> <span class="o">=</span> <span class="n">steady_state</span><span class="o">.</span><span class="n">T</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># Low Pi Plotting  Plotting</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">JO2</span><span class="p">,</span> <span class="n">NADH_x_low_pi</span><span class="o">/</span><span class="n">NAD_tot</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">)</span>   <span class="c1"># NADH</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">JO2</span><span class="p">,</span> <span class="n">DPsi_low_pi</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;1 mM Pi Model&#39;</span><span class="p">)</span>      <span class="c1"># Membrane Potential</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">JO2</span><span class="p">,</span> <span class="n">cred_i_low_pi</span><span class="o">/</span><span class="n">c_tot</span><span class="p">,</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>      <span class="c1"># Cytochrome C</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">JO2</span><span class="p">,</span> <span class="n">ADP_c_low_pi</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">)</span>     <span class="c1"># ADP</span>

<span class="c1">###### Running High Pi experiments ######</span>
 
<span class="c1"># Membrane potential</span>
<span class="n">DPsi_0</span> <span class="o">=</span> <span class="mi">175</span><span class="o">*</span><span class="mf">1e-3</span>

<span class="c1"># Matrix species</span>
<span class="n">ATP_x_0</span>  <span class="o">=</span> <span class="mf">0.5e-3</span>
<span class="n">ADP_x_0</span>  <span class="o">=</span> <span class="mf">9.5e-3</span>
<span class="n">Pi_x_0</span>   <span class="o">=</span> <span class="mf">0.3e-3</span>
<span class="n">NADH_x_0</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">NAD_tot</span>
<span class="n">QH2_x_0</span>  <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Q_tot</span>

<span class="c1"># IM species</span>
<span class="n">cred_i_0</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">c_tot</span>

<span class="c1"># Cytosol species</span>
<span class="n">ATP_c_0</span> <span class="o">=</span> <span class="mf">5.0e-3</span>
<span class="n">ADP_c_0</span> <span class="o">=</span> <span class="mf">0.0e-3</span>
<span class="n">Pi_c_0</span>  <span class="o">=</span> <span class="mf">5.0e-3</span>

<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">DPsi_0</span><span class="p">,</span> <span class="n">ATP_x_0</span><span class="p">,</span> <span class="n">ADP_x_0</span><span class="p">,</span> <span class="n">Pi_x_0</span><span class="p">,</span> <span class="n">NADH_x_0</span><span class="p">,</span> <span class="n">QH2_x_0</span><span class="p">,</span> <span class="n">cred_i_0</span><span class="p">,</span> <span class="n">ATP_c_0</span><span class="p">,</span> <span class="n">ADP_c_0</span><span class="p">,</span> <span class="n">Pi_c_0</span> <span class="p">])</span>

<span class="c1"># range of ATP consumption rates</span>
<span class="n">X_AtC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">6e-6</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>   <span class="c1"># Increase max hydrolysis to find apparent Km.</span>
<span class="n">steady_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_AtC</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_0</span><span class="p">)))</span>
<span class="n">JO2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_AtC</span><span class="p">))</span>

<span class="c1"># looping through different ATP consumptions states</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_AtC</span><span class="p">)):</span>
   <span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_AtC</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
   <span class="c1"># run for long time to acheive steady-state</span>
   <span class="n">steady_state_temp_results</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">],</span> <span class="n">X_0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">activity_array</span><span class="p">,</span><span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
   <span class="n">steady_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">steady_state_temp_results</span>
   <span class="n">f</span><span class="p">,</span><span class="n">J</span> <span class="o">=</span> <span class="n">dXdt</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">steady_state_temp_results</span><span class="p">,</span> <span class="n">activity_array</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
   <span class="n">J_C4</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="c1"># oxygen flux in mol O / sec / (L mito)</span>

   <span class="c1"># convert to units of nmol / min / UCS</span>
   <span class="c1"># using the conversion factor 0.0012232 mL of mito per UCS</span>
   <span class="n">JO2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">J_C4</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mf">1e9</span> <span class="o">*</span> <span class="mf">0.0000012232</span>

<span class="n">DPsi_hi_pi</span><span class="p">,</span> <span class="n">ATP_x_hi_pi</span><span class="p">,</span> <span class="n">ADP_x_hi_pi</span><span class="p">,</span> <span class="n">Pi_x_hi_pi</span><span class="p">,</span> <span class="n">NADH_x_hi_pi</span><span class="p">,</span> <span class="n">QH2_x_hi_pi</span><span class="p">,</span> <span class="n">cred_i_hi_pi</span><span class="p">,</span> <span class="n">ATP_c_hi_pi</span><span class="p">,</span> <span class="n">ADP_c_hi_pi</span><span class="p">,</span> <span class="n">Pi_c_hi_pi</span> <span class="o">=</span> <span class="n">steady_state</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># High Pi Plotting  Plotting</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">JO2</span><span class="p">,</span> <span class="n">NADH_x_hi_pi</span><span class="o">/</span><span class="n">NAD_tot</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>   <span class="c1"># NADH</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">JO2</span><span class="p">,</span> <span class="n">DPsi_hi_pi</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;5 mM Pi Model&#39;</span><span class="p">)</span>      <span class="c1"># Membrane Potential</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">JO2</span><span class="p">,</span> <span class="n">cred_i_hi_pi</span><span class="o">/</span><span class="n">c_tot</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>      <span class="c1"># Cytochrome C</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">JO2</span><span class="p">,</span> <span class="n">ADP_c_hi_pi</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span>  <span class="s1">&#39;red&#39;</span><span class="p">)</span>     <span class="c1"># ADP</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.8</span><span class="p">])</span>

<span class="c1"># Plot experimental data</span>

<span class="c1"># NADH data</span>
<span class="n">data_NADH</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.494</span><span class="p">,</span>      <span class="mf">0.7284</span><span class="p">,</span>                <span class="mf">14.509</span><span class="p">,</span> <span class="mf">0.6642</span><span class="p">,</span>
       <span class="mf">51.927</span><span class="p">,</span>        <span class="mf">0.4879</span><span class="p">,</span>                <span class="mf">53.625</span><span class="p">,</span> <span class="mf">0.4821</span><span class="p">,</span>
       <span class="mf">71.967</span><span class="p">,</span>        <span class="mf">0.4241</span><span class="p">,</span>                <span class="mf">77.07</span><span class="p">,</span>    <span class="mf">0.3901</span><span class="p">,</span>
       <span class="mf">86.95</span><span class="p">,</span>          <span class="mf">0.4063</span><span class="p">,</span>                <span class="mf">108.57</span><span class="p">,</span> <span class="mf">0.3688</span><span class="p">,</span>
       <span class="mf">105.62</span><span class="p">,</span>        <span class="mf">0.3964</span><span class="p">,</span>                <span class="mf">144.36</span><span class="p">,</span> <span class="mf">0.3695</span><span class="p">]</span>
<span class="n">data_NADH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_NADH</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_NADH</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_NADH</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_NADH</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">data_NADH</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;NADH (normalized)&#39;</span><span class="p">)</span>


<span class="c1"># Membrane potential data</span>
<span class="n">data_DPsi</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.494</span><span class="p">,</span> <span class="mf">183.2317</span><span class="p">,</span>                         <span class="mf">14.509</span><span class="p">,</span> <span class="mf">183.4706</span><span class="p">,</span>
        <span class="mf">51.927</span><span class="p">,</span>       <span class="mf">167.5529</span><span class="p">,</span>                         <span class="mf">53.625</span><span class="p">,</span> <span class="mf">167.9643</span><span class="p">,</span>
        <span class="mf">105.62</span><span class="p">,</span>       <span class="mf">162.3817</span><span class="p">,</span>                         <span class="mf">144.36</span><span class="p">,</span> <span class="mf">156.2841</span><span class="p">]</span>

<span class="n">data_DPsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_DPsi</span><span class="p">,(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_DPsi</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_DPsi</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;1 mM Pi Exp&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_DPsi</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">data_DPsi</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;5 mM Pi Exp&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Membrane Potential $\Psi$ (mV)&#39;</span><span class="p">)</span>


<span class="c1"># Cytochrome C</span>
<span class="n">data_cred</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.494</span><span class="p">,</span> <span class="mf">0.1862</span><span class="p">,</span>                <span class="mf">14.509</span><span class="p">,</span> <span class="mf">0.1931</span><span class="p">,</span>
        <span class="mf">51.927</span><span class="p">,</span>       <span class="mf">0.2658</span><span class="p">,</span>                <span class="mf">53.625</span><span class="p">,</span> <span class="mf">0.2576</span><span class="p">,</span>
        <span class="mf">105.62</span><span class="p">,</span>       <span class="mf">0.3147</span><span class="p">,</span>                <span class="mf">144.36</span><span class="p">,</span> <span class="mf">0.2959</span><span class="p">];</span>

<span class="n">data_cred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_cred</span><span class="p">,(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_cred</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_cred</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_cred</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">data_cred</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;OCR (nmol O$_2$ min$^{-1}$ U CS$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cyt C $^{2+}$ (Normalized)&#39;</span><span class="p">)</span>

<span class="c1"># Buffer ADP</span>
<span class="n">data_ADP</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.494</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">14.509</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
            <span class="mf">51.927</span><span class="p">,</span> <span class="mf">0.0561</span><span class="p">,</span> <span class="mf">53.625</span><span class="p">,</span> <span class="mf">0.0049</span><span class="p">,</span>
            <span class="mf">71.967</span><span class="p">,</span> <span class="mf">0.1827</span><span class="p">,</span> <span class="mf">77.07</span><span class="p">,</span>    <span class="mf">0.0578</span><span class="p">,</span>
            <span class="mf">86.95</span><span class="p">,</span> <span class="mf">0.3589</span><span class="p">,</span> <span class="mf">108.57</span><span class="p">,</span> <span class="mf">0.1648</span><span class="p">,</span>
            <span class="mf">105.62</span><span class="p">,</span> <span class="mf">0.6622</span><span class="p">,</span> <span class="mf">144.36</span><span class="p">,</span> <span class="mf">0.4716</span><span class="p">]</span>

<span class="n">data_ADP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data_ADP</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_ADP</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data_ADP</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>  <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_ADP</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">data_ADP</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span>  <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;OCR (nmol O$_2$ min$^{-1}$ U CS$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Buffer ADP (Normalized)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/InVitroModel_5_0.png" src="_images/InVitroModel_5_0.png" />
</div>
</div>
<p>The match to the data is remarkably good considering how much simpler the model developed here is compared to the model of Bazil et al. <a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id3">[15]</a>. The Bazil et al. model accounts for the mechanisms underlying oxidative phosphorylation and associated side reactions at a deeper level of detail, and thus, finds broader applications. Yet the basic frameworks of our models are equivalent.</p>
</div>
<span id="document-InVivoModel"></span><div class="section" id="simulation-of-cardiac-energetics-in-vivo">
<h3>Simulation of cardiac energetics in vivo<a class="headerlink" href="#simulation-of-cardiac-energetics-in-vivo" title="Permalink to this headline">¶</a></h3>
<p>In this final section we apply the developed model, which is shown to match data on the relationships between ATP synthesis and phosphate metabolite levels in vitro, to predict the nature of those relationships in vivo.</p>
<div class="section" id="creatine-kinase">
<h4>Creatine kinase<a class="headerlink" href="#creatine-kinase" title="Permalink to this headline">¶</a></h4>
<p>To use the mitochondrial model developed above to simulate energetics in muscle in vivo, we must account for the cytosolic creatine kinase reaction</p>
<div class="math notranslate nohighlight" id="equation-creatine">
<span class="eqno">(24)<a class="headerlink" href="#equation-creatine" title="Permalink to this equation">¶</a></span>\[    (\text{ADP}^{3-})_c + (\text{CrP}^{2-})_c + (\text{H}^{+})_c \rightleftharpoons (\text{ATP}^{4-})_c + (\text{Cr})_c ,\]</div>
<p>where Cr denotes creatine and CrP creatine phosphate. The total cytosolic creatine pool, <span class="math notranslate nohighlight">\([\text{Cr}]_{tot}\)</span>, is conserved, that is,</p>
<div class="math notranslate nohighlight">
\[    [\text{Cr}]_{tot} = [\text{Cr}]_c + [\text{CrP}]_c.\]</div>
<p>To determine the effective Gibbs energy of the creatine kinase reaction in terms of measurable biochemical reactants, we substitute Equations <a class="reference internal" href="Abstract.html#equation-sumatp">(6)</a> and <a class="reference internal" href="Abstract.html#equation-sumadp">(7)</a> obtaining</p>
<div class="math notranslate nohighlight">
\[\begin{split}    \Delta_r G_\text{CK} &amp;=&amp; \Delta_r G^\circ_\text{CK} + R \text{T} \ln \left( \dfrac{ [\Sigma \text{ATP}]_c [\text{Cr}]_c }{ [\Sigma \text{ADP}]_c [\text{CrP}^{2-}]_c } \cdot \dfrac{P_\text{ADP}}{P_\text{ATP} [\text{H}^{+}]_c} \right) \nonumber \\ 
    &amp;=&amp; \Delta_r G'^\circ_\text{CK} + R \text{T} \ln \left( \dfrac{ [\Sigma \text{ATP}]_c [\text{Cr}]_c }{ [\Sigma \text{ADP}]_c [\text{CrP}^{2-}]_c } \right), \end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[    \Delta_r G'^\circ_\text{CK} = \Delta_r G^\circ_\text{CK} + R \text{T} \ln \left( \dfrac{P_\text{ADP}}{P_\text{ATP} [\text{H}^{+}]_c} \right).\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\Delta_r G^\circ_\text{CK} = -R\text{T} \ln(K_{eq,\text{CK}})\)</span> for experimental equilibrium constant <span class="math notranslate nohighlight">\(K_{eq,\text{CK}} = 3.5 \times 10^8\)</span> <a class="bibtex reference internal" href="Abstract.html#beard2012" id="id1">[2]</a>. The apparent equilibrium of Equation <a class="reference internal" href="#equation-creatine">(24)</a> is</p>
<div class="math notranslate nohighlight">
\[    K'_{eq,\text{CK}} = \left( \dfrac{ [\Sigma \text{ATP}]_c [\text{Cr}]_c }{ [\Sigma \text{ADP}]_c [\text{CrP}^{2-}]_c } \right)_{eq} = \exp \left\{ \dfrac{-\Delta_r G'^\circ_\text{CK} }{R \text{T}} \right\}.  \]</div>
<p>We simulate creatine kinase flux, <span class="math notranslate nohighlight">\(J_\text{CK} \ \text{(mol s}^{-1} \text{ (L mito)}^{-1})\)</span>, via mass-action kinetics as</p>
<div class="math notranslate nohighlight" id="equation-j-ck">
<span class="eqno">(25)<a class="headerlink" href="#equation-j-ck" title="Permalink to this equation">¶</a></span>\[    J_\text{CK} = X_\text{CK} ( K'_{eq,\text{CK}} [\Sigma \text{ADP}]_c [\text{CrP}]_c - [\text{ATP}]_c [\text{Cr}]_c) \]</div>
<p>where <span class="math notranslate nohighlight">\(X_\text{CK} \ \text{(mol s}^{-1} \text{ (L cyto)}^{-1})\)</span> is the creatine kinase activity.</p>
<p>To simulate cardiac energetics and in vivo experiments, we incorporate the creatine kinase module and obtain the following system:</p>
<div class="math notranslate nohighlight" id="equation-system-invivo">
<span class="eqno">(26)<a class="headerlink" href="#equation-system-invivo" title="Permalink to this equation">¶</a></span>\[\begin{split}\left\{ 
		\renewcommand{\arraystretch}{2.5} 
		\begin{array}{rl}
		    \dfrac{ {\rm d} \Delta \Psi }{{\rm d} t} &amp; =( n_\text{C1} J_\text{C1} + n_\text{C3} J_\text{C3} + n_\text{C4} J_\text{C4} - n_\text{F} J_\text{F} - J_\text{ANT} - J_\text{H}) / C_m \\ 
		    \hline 
			\dfrac{ {\rm d} [\Sigma \text{ATP}]_x }{{\rm d} t} &amp;= (J_\text{F} - J_\text{ANT} ) / W_x  \\
			\dfrac{ {\rm d} [\Sigma \text{ADP}]_x }{{\rm d} t} &amp;= (-J_\text{F} + J_\text{ANT}) / W_x \\ 
			\dfrac{ {\rm d} [\Sigma \text{Pi}]_x }{{\rm d} t} &amp;= (-J_\text{F} + J_\text{PiC}) / W_x  \quad \text{matrix species}\\ 
			\dfrac{ {\rm d} [\text{NADH}^{2-}]_x }{{\rm d} t} &amp;= (J_\text{DH} - J_\text{C1}) / W_x  \\ 
			\dfrac{ {\rm d} [\text{QH}_2]_x }{{\rm d} t} &amp;= (J_\text{C1} - J_\text{C3}) / W_x  \\ 
			\hline 
			\dfrac{ {\rm d} [\text{c}_{red}^{2+}]_i}{{\rm d} t} &amp;= 2(J_\text{C3} - J_\text{C4}) / W_i \quad \text{intermembrane space species}\\
			\hline 
			\dfrac{ {\rm d} [\Sigma \text{ATP}]_c }{{\rm d} t} &amp;= (V_{m2c} J_\text{ANT} - J_\text{AtC} + J_\text{CK})/ W_c  \\
			\dfrac{ {\rm d} [\Sigma \text{ADP}]_c }{{\rm d} t} &amp;= (-V_{m2c} J_\text{ANT} + J_\text{AtC} - J_\text{CK}) / W_c \quad \text{cytoplasm species}\\
			\dfrac{ {\rm d} [\Sigma \text{Pi}]_c }{{\rm d} t} &amp;= (- V_{m2c} J_\text{PiC} + J_\text{AtC}) / W_c  \\
			\dfrac{ {\rm d} [\text{CrP}] }{{\rm d} t} &amp;= -J_\text{CK} / W_c. 
		\end{array}
		\renewcommand{\arraystretch}{1} 
	\right.\end{split}\]</div>
<p>In addition to the incorporation of the creatine kinase reaction, the in vivo model is adapted from the in vitro model by adjusting the mitochondrial volume. In the in vitro model, the volume fraction of the experimental system taken up by mitochondria is <span class="math notranslate nohighlight">\(0.0005\)</span> corresponding to a dilute suspension of purified mitochondria (<a class="reference internal" href="Abstract.html#table-biophysicalconstants"><span class="std std-numref">Table 2</span></a>). In the in vivo model, the volume fraction of a cardiomyocyte taken up by mitochondria is <span class="math notranslate nohighlight">\(0.2882\)</span> (<a class="reference internal" href="#table-invivoconstants"><span class="std std-numref">Table 6</span></a>).</p>
<table class="docutils align-default" id="table-invivoconstants">
<caption><span class="caption-number">Table 6 </span><span class="caption-text">Parameters for ATP synthesis in vivo.</span><a class="headerlink" href="#table-invivoconstants" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Source</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(X_\text{CK}\)</span></p></td>
<td><p>mol s<span class="math notranslate nohighlight">\(^{-1}\)</span> (L cyto)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Creatine kinase activity</p></td>
<td><p><span class="math notranslate nohighlight">\(10^7\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id2">[15]</a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\([\text{Cr}]_{tot}\)</span></p></td>
<td><p>mmol (L cell)<span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
<td><p>Total creatine pool in the cell</p></td>
<td><p><span class="math notranslate nohighlight">\(40\)</span></p></td>
<td><p><a class="bibtex reference internal" href="Abstract.html#lopez2020" id="id3">[9]</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="simulation-of-respiratory-control-in-vivo">
<h4>Simulation of respiratory control in vivo<a class="headerlink" href="#simulation-of-respiratory-control-in-vivo" title="Permalink to this headline">¶</a></h4>
<p>Previous investigations (<a class="bibtex reference internal" href="Abstract.html#lopez2020" id="id4">[9]</a><a class="bibtex reference internal" href="Abstract.html#wu2009" id="id5">[5]</a>) have revealed that the certain cytosolic metabolite pools influence the phosphate metabolite levels in the myocardium in vivo. These metabolite pools are the total adeninine nucleotide (<span class="math notranslate nohighlight">\(\text{TAN}\)</span>, <span class="math notranslate nohighlight">\(\text{mmol (L cell)}^{−1}\)</span>), total exchangeable phosphate (<span class="math notranslate nohighlight">\(\text{TEP}\)</span>, <span class="math notranslate nohighlight">\(\text{mmol (L cell)}^{−1}\)</span>), and total creatine (<span class="math notranslate nohighlight">\([\text{Cr}]_{tot}\)</span>, <span class="math notranslate nohighlight">\( \text{mmol (L cell)}^{−1}\)</span>) pool, which may be computed from our model variables via</p>
<div class="math notranslate nohighlight">
\[\begin{split}    \text{TAN} &amp;=&amp; (V_{c}W_{c} + V_{m}W_{i}) ([\text{ATP}]_{c} + [\text{ADP}]_{c}) + V_{m}W_{x} ([\text{ATP}]_{x} + [\text{ADP}]_{x}), \nonumber \\
    \text{TEP} &amp;=&amp; (V_{c}W_{c} + V_m W_i) (2[\text{ATP}]_{c} + [\text{ADP}]_{c}+ [\text{Pi}]_{c}+[\text{CrP}]_{c}) \nonumber + V_{m}W_{x} ([\text{ATP}]_{x} + [\text{ADP}]_x + [\text{Pi}]_{x}), \quad \text{and} \nonumber\\
    \text{Cr}_{tot} &amp;=&amp; V_{c}W_{c} ([\text{Cr}]_{c}+[\text{CrP}]_{c}).  \end{split}\]</div>
<p>To simulate healthy normal conditions, these pools are set as <span class="math notranslate nohighlight">\(\text{TAN} = 7.6\)</span>, <span class="math notranslate nohighlight">\(\text{TEP} = 27.5\)</span>, and <span class="math notranslate nohighlight">\([\text{Cr}]_{tot} = 40 \ \text{mM (L cell)}^{-1}\)</span>. The levels of these metabolite pools have been shown to decrease in heart failure compared to normal physiological conditions. In the simulations below we explore the predicted effects of altering these metabolite pool levels.</p>
<p>The code below computes the steady-state behavior of the in vivo model over a range of ATP consumption rates, representing myocardial ATP demand levels associated with resting and exercise conditions. The resting state is associated with a myocardial ATP consumption rate of approximately <span class="math notranslate nohighlight">\(0.4 \ \text{mmol s}^{−1} \ \text{(L cell)}^{−1}\)</span> while under vigorous exercise conditions the ATP consumption rate is approximately <span class="math notranslate nohighlight">\(1.2 \ \text{mmol s}^{−1} \ \text{(L cell)}^{−1}\)</span> <a class="bibtex reference internal" href="Abstract.html#gao2019" id="id6">[6]</a>. Here the myocardial ATP consumption rate is varied over the range of <span class="math notranslate nohighlight">\(0.4\)</span> to <span class="math notranslate nohighlight">\(1.2 \ \text{mmol s}^{−1} \ \text{(L cell)}^{−1}\)</span>, corresponding to a range of myocardial oxygen consumption rate of approximately <span class="math notranslate nohighlight">\(25\)</span> to <span class="math notranslate nohighlight">\(60 \ \text{nmol min}^{-1} \ \text{(U CS)}^{-1}\)</span>.</p>
<table class="docutils align-default" id="table-metabolitepools">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">Metabolite pool concentrations in mmol (L cell)<span class="math notranslate nohighlight">\(^{-1}\)</span>.</span><a class="headerlink" href="#table-metabolitepools" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Healthy</p></th>
<th class="head"><p>Heart failure <a class="bibtex reference internal" href="Abstract.html#lopez2020" id="id7">[9]</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TAN</p></td>
<td><p>Total adenine nucleotide</p></td>
<td><p>mM</p></td>
<td><p><span class="math notranslate nohighlight">\(7.6\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(6.976\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>TEP</p></td>
<td><p>Total exchangeable phosphate</p></td>
<td><p>mM</p></td>
<td><p><span class="math notranslate nohighlight">\(27.5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(24.11\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\([\text{Cr}_{tot}]\)</span></p></td>
<td><p>Total creatine</p></td>
<td><p>mM</p></td>
<td><p><span class="math notranslate nohighlight">\(40\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(23.03\)</span></p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">###### Constants defining metabolite pools ######</span>
<span class="c1"># Volume fractions and water space fractions</span>
<span class="n">V_c</span> <span class="o">=</span> <span class="mf">0.6601</span>       <span class="c1"># cytosol volume fraction       # L cyto (L cell)**(-1)</span>
<span class="n">V_m</span> <span class="o">=</span> <span class="mf">0.2882</span>       <span class="c1"># mitochondrial volume fraction # L mito (L cell)**(-1)</span>
<span class="n">V_m2c</span> <span class="o">=</span> <span class="n">V_m</span> <span class="o">/</span> <span class="n">V_c</span>  <span class="c1"># mito to cyto volume ratio     # L mito (L cyto)**(-1)</span>
<span class="n">W_c</span> <span class="o">=</span> <span class="mf">0.8425</span>      <span class="c1"># cytosol water space           # L cyto water (L cyto)**(-1)</span>
<span class="n">W_m</span> <span class="o">=</span> <span class="mf">0.7238</span>       <span class="c1"># mitochondrial water space     # L mito water (L mito)**(-1)</span>
<span class="n">W_x</span> <span class="o">=</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># matrix water space            # L matrix water (L mito)**(-1)</span>
<span class="n">W_i</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">W_m</span>      <span class="c1"># intermembrane water space     # L IM water (L mito)**(-1)</span>

<span class="c1"># Total pool concentrations</span>
<span class="n">NAD_tot</span> <span class="o">=</span> <span class="mf">2.97e-3</span>  <span class="c1"># NAD+ and NADH conc            # mol (L matrix water)**(-1)</span>
<span class="n">Q_tot</span>   <span class="o">=</span> <span class="mf">1.35e-3</span>  <span class="c1"># Q and QH2 conc                # mol (L matrix water)**(-1)</span>
<span class="n">c_tot</span>   <span class="o">=</span> <span class="mf">2.7e-3</span>   <span class="c1"># cytochrome c ox and red conc  # mol (L IM water)**(-1)</span>

<span class="c1"># Membrane capacitance</span>
<span class="n">Cm</span> <span class="o">=</span> <span class="mf">3.1e-3</span>    <span class="c1"># mol (V * L mito)^(-1)</span>

<span class="c1">###### Set fixed pH, cation concentrations, and O2 partial pressure ######</span>
<span class="c1"># pH</span>
<span class="n">pH_x</span> <span class="o">=</span> <span class="mf">7.40</span>
<span class="n">pH_c</span> <span class="o">=</span> <span class="mf">7.20</span>

<span class="c1"># K+ concentrations</span>
<span class="n">K_x</span>  <span class="o">=</span> <span class="mf">100e-3</span>      <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">K_c</span>  <span class="o">=</span> <span class="mf">140e-3</span>      <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Mg2+ concentrations</span>
<span class="n">Mg_x</span> <span class="o">=</span> <span class="mf">1.0e-3</span>        <span class="c1"># mol (L matrix water)**(-1)</span>
<span class="n">Mg_c</span> <span class="o">=</span> <span class="mf">1.0e-3</span>        <span class="c1"># mol (L cyto water)**(-1)</span>

<span class="c1"># Oxygen partial pressure</span>
<span class="n">PO2</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1"># mmHg</span>

<span class="n">conc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pH_x</span><span class="p">,</span> <span class="n">pH_c</span><span class="p">,</span> <span class="n">K_x</span><span class="p">,</span> <span class="n">K_c</span><span class="p">,</span> <span class="n">Mg_x</span><span class="p">,</span> <span class="n">Mg_c</span><span class="p">,</span> <span class="n">PO2</span><span class="p">])</span>

<span class="c1">###### Parameter vector ###### </span>
<span class="n">X_DH</span>  <span class="o">=</span> <span class="mf">0.1732</span>
<span class="n">X_C1</span>  <span class="o">=</span> <span class="mf">1.0e4</span>
<span class="n">X_C3</span>  <span class="o">=</span> <span class="mf">1.0e6</span>
<span class="n">X_C4</span>  <span class="o">=</span> <span class="mf">0.0125</span>
<span class="n">X_F</span>   <span class="o">=</span> <span class="mf">1.0e3</span>
<span class="n">E_ANT</span> <span class="o">=</span> <span class="mf">0.325</span>
<span class="n">E_PiC</span> <span class="o">=</span> <span class="mf">5.0e6</span>
<span class="n">X_H</span>   <span class="o">=</span> <span class="mf">1.0e3</span>
<span class="n">X_CK</span>  <span class="o">=</span> <span class="mf">1e7</span>
<span class="n">X_AtC</span> <span class="o">=</span> <span class="mf">0.5e-3</span>

<span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_CK</span><span class="p">,</span> <span class="n">X_AtC</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">dXdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">activity_array</span><span class="p">,</span> <span class="n">solve_ode</span><span class="p">):</span>
    <span class="c1"># Unpack variables </span>
    <span class="n">DPsi</span><span class="p">,</span> <span class="n">sumATP_x</span><span class="p">,</span><span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">NADH_x</span><span class="p">,</span> <span class="n">QH2_x</span><span class="p">,</span> <span class="n">cred_i</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="p">,</span> <span class="n">sumPi_c</span><span class="p">,</span> <span class="n">CrP_c</span> <span class="o">=</span> <span class="n">X</span>
    <span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_CK</span><span class="p">,</span> <span class="n">X_AtC</span> <span class="o">=</span> <span class="n">activity_array</span>

    <span class="c1"># Hydrogen ion concentration</span>
    <span class="n">H_x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_x</span><span class="p">)</span> <span class="c1"># mol (L matrix water)**(-1)</span>
    <span class="n">H_c</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">pH_c</span><span class="p">)</span> <span class="c1"># mol (L cuvette water)**(-1)</span>

    <span class="c1"># Oxygen concentration</span>
    <span class="n">a_3</span>  <span class="o">=</span> <span class="mf">1.74e-6</span>   <span class="c1"># oxygen solubility in cuvette   # mol (L matrix water * mmHg)**(-1)</span>
    <span class="n">O2_x</span> <span class="o">=</span> <span class="n">a_3</span><span class="o">*</span><span class="n">PO2</span>   <span class="c1"># mol (L matrix water)**(-1)</span>

    <span class="c1"># Thermochemical constants</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span>          <span class="c1"># J (mol K)**(-1)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">+</span> <span class="mf">273.15</span>    <span class="c1"># K</span>
    <span class="n">F</span> <span class="o">=</span> <span class="mi">96485</span>          <span class="c1"># C mol**(-1)</span>
    
    <span class="c1"># Proton motive force parameters (dimensionless)</span>
    <span class="n">n_F</span>  <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">n_C1</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">n_C3</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">n_C4</span> <span class="o">=</span> <span class="mi">4</span>
    
    <span class="c1"># Dissociation constants</span>
    <span class="n">K_MgATP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.88</span><span class="p">)</span>
    <span class="n">K_HATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.33</span><span class="p">)</span>
    <span class="n">K_KATP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">K_MgADP</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">3.00</span><span class="p">)</span>
    <span class="n">K_HADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.26</span><span class="p">)</span>
    <span class="n">K_KADP</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.89</span><span class="p">)</span>
    <span class="n">K_MgPi</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.66</span><span class="p">)</span>
    <span class="n">K_HPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">6.62</span><span class="p">)</span>
    <span class="n">K_KPi</span>   <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.42</span><span class="p">)</span>

    <span class="c1">## Other concentrations computed from the state variables</span>
    <span class="n">NAD_x</span> <span class="o">=</span> <span class="n">NAD_tot</span> <span class="o">-</span> <span class="n">NADH_x</span>  <span class="c1">## mol (L matrix water)**(-1)</span>
    <span class="n">Q_x</span>   <span class="o">=</span> <span class="n">Q_tot</span> <span class="o">-</span> <span class="n">QH2_x</span>     <span class="c1">## mol (L matrix water)**(-1)</span>
    <span class="n">cox_i</span> <span class="o">=</span> <span class="n">c_tot</span> <span class="o">-</span> <span class="n">cred_i</span>    <span class="c1">## mol (L matrix water)**(-1)</span>
    <span class="n">Cr_c</span>  <span class="o">=</span> <span class="n">Cr_tot_c</span> <span class="o">-</span> <span class="n">CrP_c</span>  <span class="c1">## mol (L cyto water)**(-1) </span>
    
    <span class="c1">## Binding polynomials</span>
    <span class="c1"># Matrix species # mol (L mito water)**(-1)</span>
    <span class="n">PATP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_x</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_x</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_x</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_x</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1"># Cytosol species # mol (L cyto water)**(-1)</span>
    <span class="n">PATP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HATP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgATP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KATP</span>
    <span class="n">PADP_c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HADP</span> <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgADP</span> <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KADP</span>
    <span class="n">PPi_c</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">H_c</span><span class="o">/</span><span class="n">K_HPi</span>  <span class="o">+</span> <span class="n">Mg_c</span><span class="o">/</span><span class="n">K_MgPi</span>  <span class="o">+</span> <span class="n">K_c</span><span class="o">/</span><span class="n">K_KPi</span>
    
    <span class="c1">## Unbound species</span>
    <span class="c1"># Matrix species</span>
    <span class="n">ATP_x</span> <span class="o">=</span> <span class="n">sumATP_x</span> <span class="o">/</span> <span class="n">PATP_x</span> <span class="c1"># [ATP4-]_x</span>
    <span class="n">ADP_x</span> <span class="o">=</span> <span class="n">sumADP_x</span> <span class="o">/</span> <span class="n">PADP_x</span> <span class="c1"># [ADP3-]_x</span>
    <span class="n">Pi_x</span>  <span class="o">=</span> <span class="n">sumPi_x</span>  <span class="o">/</span> <span class="n">PPi_x</span>  <span class="c1"># [HPO42-]_x</span>
    
    <span class="c1"># Cytosol species</span>
    <span class="n">ATP_c</span> <span class="o">=</span> <span class="n">sumATP_c</span> <span class="o">/</span> <span class="n">PATP_c</span> <span class="c1"># [ATP4-]_c</span>
    <span class="n">ADP_c</span> <span class="o">=</span> <span class="n">sumADP_c</span> <span class="o">/</span> <span class="n">PADP_c</span> <span class="c1"># [ADP3-]_c</span>
    <span class="n">Pi_c</span>  <span class="o">=</span> <span class="n">sumPi_c</span>  <span class="o">/</span> <span class="n">PPi_c</span>  <span class="c1"># [HPO42-]_c</span>
    
    
    <span class="c1">###### NADH Dehydrogenase ######</span>

    <span class="c1"># Constants</span>
    <span class="n">r</span>      <span class="o">=</span> <span class="mf">6.8385</span>
    <span class="n">k_Pi1</span>  <span class="o">=</span> <span class="mf">4.659e-4</span>    <span class="c1"># mol (L matrix water)**(-1)</span>
    <span class="n">k_Pi2</span>  <span class="o">=</span> <span class="mf">6.578e-4</span> <span class="c1"># mol (L matrix water)**(-1)</span>
    
    <span class="c1"># Flux (mol (s * L mito)^(-1))  </span>
    <span class="n">J_DH</span> <span class="o">=</span> <span class="n">X_DH</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">NAD_x</span> <span class="o">-</span> <span class="n">NADH_x</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sumPi_x</span> <span class="o">/</span> <span class="n">k_Pi1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">sumPi_x</span> <span class="o">/</span> <span class="n">k_Pi2</span><span class="p">))</span>

    <span class="c1">###### Complex I ######</span>
    <span class="c1"># NADH_x + Q_x + 5H+_x &lt;-&gt; NAD+_x + QH2_x + 4H+_i + 4dPsi</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">109680</span> 
    <span class="n">DrGapp_C1</span> <span class="o">=</span> <span class="n">DrGo_C1</span> <span class="o">-</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_x</span><span class="p">)</span> 
    
    <span class="c1"># Apparent equilibrium constant</span>
    <span class="n">Kapp_C1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C1</span> <span class="o">+</span> <span class="n">n_C1</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C1</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C1</span> <span class="o">=</span> <span class="n">X_C1</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_C1</span> <span class="o">*</span> <span class="n">NADH_x</span> <span class="o">*</span> <span class="n">Q_x</span> <span class="o">-</span> <span class="n">NAD_x</span> <span class="o">*</span> <span class="n">QH2_x</span><span class="p">)</span>
    
    <span class="c1">###### Complex III ######</span>
    <span class="c1"># QH2_x + 2cuvetteC(ox)3+_i + 2H+_x &lt;-&gt; Q_x + 2cuvetteC(red)2+_i + 4H+_i + 2DPsi</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C3</span> <span class="o">=</span> <span class="mi">46690</span> 
    <span class="n">DrGapp_C3</span> <span class="o">=</span> <span class="n">DrGo_C3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_c</span><span class="p">)</span> 
    
    <span class="c1"># Apparent equilibrium constant</span>
    <span class="n">Kapp_C3</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C3</span> <span class="o">+</span> <span class="n">n_C3</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C3</span> 
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C3</span> <span class="o">=</span> <span class="n">X_C3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_C3</span> <span class="o">*</span> <span class="n">cox_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">QH2_x</span> <span class="o">-</span> <span class="n">cred_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Q_x</span><span class="p">)</span>


    <span class="c1">###### Complex IV ######</span>
    <span class="c1"># 2 cytoC(red)2+_i + 0.5O2_x + 4H+_x &lt;-&gt; cytoC(ox)3+_x + H2O_x + 2H+_i + 2DPsi</span>
    
    <span class="c1"># Constant</span>
    <span class="n">k_O2</span> <span class="o">=</span> <span class="mf">1.2e-4</span>      <span class="c1"># mol (L matrix water)**(-1)</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_C4</span> <span class="o">=</span> <span class="o">-</span><span class="mi">202160</span>  <span class="c1"># J mol**(-1)</span>
    <span class="n">DrGapp_C4</span> <span class="o">=</span> <span class="n">DrGo_C4</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">H_c</span><span class="p">)</span>
    
    <span class="c1"># Apparent equilibrium constant</span>
    <span class="n">Kapp_C4</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">DrGapp_C4</span> <span class="o">+</span> <span class="n">n_C4</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">H_c</span><span class="p">)</span><span class="o">**</span><span class="n">n_C4</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_C4</span> <span class="o">=</span> <span class="n">X_C4</span> <span class="o">*</span><span class="p">(</span><span class="n">Kapp_C4</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">cred_i</span> <span class="o">*</span> <span class="n">O2_x</span><span class="o">**</span><span class="mf">0.25</span> <span class="o">-</span> <span class="n">cox_i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">k_O2</span> <span class="o">/</span> <span class="n">O2_x</span><span class="p">))</span>

    <span class="c1">###### F0F1-ATPase ######</span>
    <span class="c1"># ADP3-_x + HPO42-_x + H+_x + n_A*H+_i &lt;-&gt; ATP4- + H2O + n_A*H+_x</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_F</span> <span class="o">=</span> <span class="mi">4990</span> 
    
    <span class="n">DrGapp_F</span> <span class="o">=</span> <span class="n">DrGo_F</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">PATP_x</span> <span class="o">/</span> <span class="p">(</span><span class="n">PADP_x</span> <span class="o">*</span> <span class="n">PPi_x</span><span class="p">))</span>
    <span class="n">Kapp_F</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="p">(</span><span class="n">DrGapp_F</span> <span class="o">+</span> <span class="n">n_F</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">H_x</span><span class="p">)</span><span class="o">**</span><span class="n">n_F</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_F</span> <span class="o">=</span> <span class="n">X_F</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_F</span> <span class="o">*</span> <span class="n">sumADP_x</span> <span class="o">*</span> <span class="n">sumPi_x</span> <span class="o">-</span> <span class="n">sumATP_x</span><span class="p">)</span>

    
    <span class="c1">###### ANT ######</span>
    <span class="c1"># ATP4-_x + ADP3-_i &lt;-&gt; ATP4-_i + ADP3-_x</span>
    
    <span class="c1"># Constants</span>
    <span class="n">del_D</span>   <span class="o">=</span> <span class="mf">0.0167</span>
    <span class="n">del_T</span>   <span class="o">=</span> <span class="mf">0.0699</span>
    <span class="n">k2o_ANT</span> <span class="o">=</span> <span class="mf">9.54</span><span class="o">/</span><span class="mi">60</span>      <span class="c1"># s**(-1)</span>
    <span class="n">k3o_ANT</span> <span class="o">=</span> <span class="mf">30.05</span><span class="o">/</span><span class="mi">60</span>     <span class="c1"># s**(-1)</span>
    <span class="n">K0o_D</span>   <span class="o">=</span> <span class="mf">38.89e-6</span>     <span class="c1"># mol (L cyto water)**(-1)</span>
    <span class="n">K0o_T</span>   <span class="o">=</span> <span class="mf">56.05e-6</span>     <span class="c1"># mol (L cyto water)**(-1)</span>
    <span class="n">A</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2829</span>
    <span class="n">B</span>       <span class="o">=</span> <span class="o">-</span><span class="mf">0.2086</span>
    <span class="n">C</span>       <span class="o">=</span> <span class="o">+</span><span class="mf">0.2372</span>
    
    <span class="n">phi</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">DPsi</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    
    <span class="c1"># Reaction rates</span>
    <span class="n">k2_ANT</span> <span class="o">=</span> <span class="n">k2o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">k3_ANT</span> <span class="o">=</span> <span class="n">k3o_ANT</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="c1"># Dissociation constants</span>
    <span class="n">K0_D</span> <span class="o">=</span> <span class="n">K0o_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">del_D</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">K0_T</span> <span class="o">=</span> <span class="n">K0o_T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">del_T</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
    
    <span class="n">q</span>     <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">K0_D</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">K0_T</span><span class="p">)</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="n">k2_ANT</span> <span class="o">*</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">ADP_c</span> <span class="o">*</span> <span class="n">q</span> <span class="o">/</span> <span class="n">K0_D</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">k3_ANT</span> <span class="o">*</span> <span class="n">ADP_x</span> <span class="o">*</span> <span class="n">ATP_c</span> <span class="o">/</span> <span class="n">K0_T</span>
    <span class="n">num</span>   <span class="o">=</span> <span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span>
    <span class="n">den</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">ATP_c</span><span class="o">/</span><span class="n">K0_T</span> <span class="o">+</span> <span class="n">ADP_c</span><span class="o">/</span><span class="n">K0_D</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ADP_x</span> <span class="o">+</span> <span class="n">ATP_x</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
    
    <span class="c1"># Flux</span>
    <span class="n">J_ANT</span> <span class="o">=</span> <span class="n">E_ANT</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span>
    
    <span class="c1">###### H+-PI2 cotransporter ######</span>
    <span class="c1"># H2PO42-_x + H+_x = H2PO42-_c + H+_c</span>
    
    <span class="c1"># Constant</span>
    <span class="n">k_PiC</span> <span class="o">=</span> <span class="mf">1.61e-3</span>  <span class="c1"># mol (L cell)**(-1)</span>
    
    <span class="c1"># H2P04- species</span>
    <span class="n">HPi_c</span> <span class="o">=</span> <span class="n">Pi_c</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">/</span> <span class="n">K_HPi</span><span class="p">)</span>
    <span class="n">HPi_x</span> <span class="o">=</span> <span class="n">Pi_x</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_x</span> <span class="o">/</span> <span class="n">K_HPi</span><span class="p">)</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_PiC</span> <span class="o">=</span> <span class="n">E_PiC</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">*</span> <span class="n">HPi_c</span> <span class="o">-</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">HPi_x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_PiC</span> <span class="o">+</span> <span class="n">HPi_c</span><span class="p">)</span>

    <span class="c1">###### H+ leak ######</span>
    
    <span class="c1"># Flux (mol (s * L mito)**(-1))</span>
    <span class="n">J_H</span> <span class="o">=</span> <span class="n">X_H</span> <span class="o">*</span> <span class="p">(</span><span class="n">H_c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">phi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">H_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">phi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="c1">###### ATPase ######</span>
    <span class="c1"># ATP4- + H2O = ADP3- + PI2- + H+</span>
    
    <span class="c1">#Flux (mol (s * L cyto)**(-1))</span>
    <span class="n">J_AtC</span> <span class="o">=</span> <span class="n">X_AtC</span> <span class="o">/</span> <span class="n">V_c</span>

    <span class="c1">###### Creatine kinase reaction ######</span>
    <span class="c1"># ADP3- + CrP2- + H+ = ATP4- + Cr  </span>
    
    <span class="c1"># Equilibrium constant (dimensionless)        </span>
    <span class="n">Keq_CK</span>  <span class="o">=</span> <span class="mf">3.5e8</span>
    
    <span class="c1"># Gibbs energy (J mol**(-1))</span>
    <span class="n">DrGo_CK</span> <span class="o">=</span> <span class="o">-</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Keq_CK</span><span class="p">)</span>
    <span class="n">DrGapp_CK</span> <span class="o">=</span> <span class="n">DrGo_CK</span> <span class="o">+</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">PADP_c</span> <span class="o">/</span> <span class="p">(</span><span class="n">PATP_c</span> <span class="o">*</span> <span class="n">H_c</span><span class="p">))</span>  
    
    <span class="c1"># Apparent equilibrium constant </span>
    <span class="n">Kapp_CK</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">DrGapp_CK</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
    
    <span class="c1"># Flux (mol (s * L cyto)^(-1))   </span>
    <span class="n">J_CK</span> <span class="o">=</span> <span class="n">X_CK</span> <span class="o">*</span> <span class="p">(</span><span class="n">Kapp_CK</span> <span class="o">*</span> <span class="n">ADP_c</span> <span class="o">*</span> <span class="n">CrP_c</span> <span class="o">-</span> <span class="n">ATP_c</span> <span class="o">*</span> <span class="n">Cr_c</span><span class="p">)</span>
    
    <span class="c1">###### Differential equations (equation 26) ######</span>
    <span class="c1"># Membrane potential</span>
    <span class="n">dDPsi</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_C1</span> <span class="o">*</span> <span class="n">J_C1</span> <span class="o">+</span> <span class="n">n_C3</span> <span class="o">*</span> <span class="n">J_C3</span> <span class="o">+</span> <span class="n">n_C4</span> <span class="o">*</span> <span class="n">J_C4</span> <span class="o">-</span> <span class="n">n_F</span> <span class="o">*</span> <span class="n">J_F</span> <span class="o">-</span> <span class="n">J_ANT</span> <span class="o">-</span> <span class="n">J_H</span><span class="p">)</span> <span class="o">/</span> <span class="n">Cm</span>

    <span class="c1"># Matrix species</span>
    <span class="n">dATP_x</span>  <span class="o">=</span> <span class="p">(</span><span class="n">J_F</span>  <span class="o">-</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dADP_x</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">J_F</span> <span class="o">+</span> <span class="n">J_ANT</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dPi_x</span>   <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">J_F</span> <span class="o">+</span> <span class="n">J_PiC</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dNADH_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">J_DH</span> <span class="o">-</span> <span class="n">J_C1</span><span class="p">)</span>  <span class="o">/</span> <span class="n">W_x</span>
    <span class="n">dQH2_x</span>  <span class="o">=</span> <span class="p">(</span><span class="n">J_C1</span> <span class="o">-</span> <span class="n">J_C3</span><span class="p">)</span>  <span class="o">/</span> <span class="n">W_x</span>
    
    <span class="c1"># IM space species</span>
    <span class="n">dcred_i</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">J_C3</span> <span class="o">-</span> <span class="n">J_C4</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_i</span>
    
    <span class="c1"># Cytosol species</span>
    <span class="n">dATP_c</span> <span class="o">=</span> <span class="p">(</span> <span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span> <span class="o">-</span> <span class="n">J_AtC</span> <span class="o">+</span> <span class="n">J_CK</span> <span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dADP_c</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_ANT</span> <span class="o">+</span> <span class="n">J_AtC</span> <span class="o">-</span> <span class="n">J_CK</span> <span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dPi_c</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">V_m2c</span> <span class="o">*</span> <span class="n">J_PiC</span> <span class="o">+</span> <span class="n">J_AtC</span><span class="p">)</span> <span class="o">/</span> <span class="n">W_c</span>
    <span class="n">dCrP_c</span> <span class="o">=</span> <span class="o">-</span><span class="n">J_CK</span> <span class="o">/</span> <span class="n">W_c</span>
    
    <span class="n">dX</span> <span class="o">=</span> <span class="p">[</span><span class="n">dDPsi</span><span class="p">,</span> <span class="n">dATP_x</span><span class="p">,</span> <span class="n">dADP_x</span><span class="p">,</span> <span class="n">dPi_x</span><span class="p">,</span> <span class="n">dNADH_x</span><span class="p">,</span> <span class="n">dQH2_x</span><span class="p">,</span> <span class="n">dcred_i</span><span class="p">,</span> <span class="n">dATP_c</span><span class="p">,</span> <span class="n">dADP_c</span><span class="p">,</span> <span class="n">dPi_c</span><span class="p">,</span> <span class="n">dCrP_c</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">solve_ode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dX</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">PATP_x</span><span class="p">,</span> <span class="n">PADP_x</span><span class="p">,</span> <span class="n">PPi_x</span><span class="p">,</span> <span class="n">PATP_c</span><span class="p">,</span> <span class="n">PADP_c</span><span class="p">,</span> <span class="n">PPi_c</span><span class="p">,</span> <span class="n">J_DH</span><span class="p">,</span> <span class="n">J_C1</span><span class="p">,</span> <span class="n">J_C3</span><span class="p">,</span> <span class="n">J_C4</span><span class="p">,</span> <span class="n">J_F</span><span class="p">,</span> <span class="n">J_ANT</span><span class="p">,</span> <span class="n">J_PiC</span><span class="p">,</span> <span class="n">J_CK</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">dX</span><span class="p">,</span> <span class="n">J</span>

<span class="c1">###### Initial Conditions ######</span>
<span class="c1"># Membrane Potential</span>
<span class="n">Psi_0</span> <span class="o">=</span> <span class="mi">175</span><span class="o">/</span><span class="mi">1000</span>      <span class="c1"># Volts</span>

<span class="c1"># Matrix species</span>
<span class="n">sumATP_x_0</span> <span class="o">=</span> <span class="mf">0.5e-3</span>  <span class="c1"># mol (L matrix water)^(-1)</span>
<span class="n">sumADP_x_0</span> <span class="o">=</span> <span class="mf">9.5e-3</span>  <span class="c1"># mol (L matrix water)^(-1)</span>
<span class="n">sumPi_x_0</span> <span class="o">=</span> <span class="mf">0.3e-3</span>   <span class="c1"># mol (L matrix water)^(-1)</span>
<span class="n">NADH_x_0</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="n">NAD_tot</span>  <span class="c1"># mol (L matrix water)^(-1)</span>
<span class="n">QH2_x_0</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">Q_tot</span>   <span class="c1"># mol (L matrix water)^(-1)</span>

<span class="c1"># IMS species</span>
<span class="n">cred_i_0</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">c_tot</span>

<span class="c1"># Cytoplasmic species</span>
<span class="c1">#sumATP_c_0 = 9.95e-3  # mol (L cyto water)^(-1)</span>
<span class="n">sumADP_c_0</span> <span class="o">=</span> <span class="mf">0.05e-3</span>  <span class="c1"># mol s(L cyto water)^(-1)</span>
<span class="c1">#sumPi_c_0 = 5.0e-3  # mol (L cyto water)^(-1)</span>

<span class="c1">###### Healthy normal case ######</span>
<span class="n">TAN</span> <span class="o">=</span> <span class="mf">0.0076</span> <span class="c1">#(M per liter cell)</span>
<span class="n">TEP</span> <span class="o">=</span> <span class="mf">0.0275</span>  <span class="c1">#(M per liter cell)</span>
<span class="n">Cr_tot</span>  <span class="o">=</span> <span class="mf">0.040</span>    <span class="c1">#(M per liter cell)</span>
     
<span class="n">sumATP_c_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">TAN</span> <span class="o">-</span> <span class="n">V_m</span><span class="o">*</span><span class="n">W_x</span><span class="o">*</span><span class="p">(</span><span class="n">sumATP_x_0</span> <span class="o">+</span> <span class="n">sumADP_x_0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">V_c</span><span class="o">*</span><span class="n">W_c</span><span class="o">+</span><span class="n">V_m</span><span class="o">*</span><span class="n">W_i</span><span class="p">)</span> <span class="o">-</span> <span class="n">sumADP_c_0</span>
<span class="n">Cr_tot_c</span>   <span class="o">=</span> <span class="n">Cr_tot</span> <span class="o">/</span> <span class="p">(</span><span class="n">V_c</span> <span class="o">*</span> <span class="n">W_c</span><span class="p">)</span> <span class="c1"># convert to mol (L cyto water)^(-1)</span>
<span class="n">CrP_c_0</span>    <span class="o">=</span> <span class="o">.</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Cr_tot_c</span>  <span class="c1"># mol (L cyto water)^(-1)</span>
<span class="n">sumPi_c_0</span>  <span class="o">=</span> <span class="p">(</span><span class="n">TEP</span><span class="o">-</span><span class="n">V_m</span><span class="o">*</span><span class="n">W_x</span><span class="o">*</span><span class="p">(</span><span class="n">sumATP_x_0</span> <span class="o">+</span> <span class="n">sumADP_x_0</span> <span class="o">+</span> <span class="n">sumPi_x_0</span> <span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">V_c</span><span class="o">*</span><span class="n">W_c</span><span class="o">+</span><span class="n">V_m</span><span class="o">*</span><span class="n">W_i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">sumATP_c_0</span> <span class="o">-</span> <span class="n">sumADP_c_0</span> <span class="o">-</span> <span class="n">CrP_c_0</span> 

<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Psi_0</span><span class="p">,</span> <span class="n">sumATP_x_0</span><span class="p">,</span> <span class="n">sumADP_x_0</span><span class="p">,</span> <span class="n">sumPi_x_0</span><span class="p">,</span> <span class="n">NADH_x_0</span><span class="p">,</span> <span class="n">QH2_x_0</span><span class="p">,</span> <span class="n">cred_i_0</span><span class="p">,</span> <span class="n">sumATP_c_0</span><span class="p">,</span> <span class="n">sumADP_c_0</span><span class="p">,</span> <span class="n">sumPi_c_0</span><span class="p">,</span> <span class="n">CrP_c_0</span><span class="p">])</span> 

<span class="c1"># range of ATP consumption rates</span>
<span class="n">X_AtC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.4e-3</span><span class="p">,</span><span class="mf">1.2e-3</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>   <span class="c1"># Increase max hydrolysis to find apparent Km.</span>
<span class="n">steady_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_AtC</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_0</span><span class="p">)))</span>
<span class="n">JO2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_AtC</span><span class="p">))</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="c1"># looping through different ATP consumptions states</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_AtC</span><span class="p">)):</span>
   <span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_CK</span><span class="p">,</span> <span class="n">X_AtC</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
   <span class="c1"># run for long time to acheive steady-state</span>
   <span class="n">steady_state_temp_results</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">X_0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">activity_array</span><span class="p">,</span><span class="mi">1</span><span class="p">,),</span><span class="n">max_step</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
   <span class="n">steady_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">steady_state_temp_results</span>
   
<span class="n">DPsi</span><span class="p">,</span> <span class="n">sumATP_x</span><span class="p">,</span> <span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">NADH_x</span><span class="p">,</span> <span class="n">QH2_x</span><span class="p">,</span> <span class="n">cred_i</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="p">,</span> <span class="n">sumPi_c</span><span class="p">,</span> <span class="n">CrP_c</span> <span class="o">=</span> <span class="n">steady_state</span><span class="o">.</span><span class="n">T</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="c1">## Plot normal case</span>
<span class="c1"># CrP/ATP ratio</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_AtC</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">CrP_c</span> <span class="o">*</span> <span class="p">(</span><span class="n">V_c</span> <span class="o">*</span> <span class="n">W_c</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sumATP_x</span> <span class="o">*</span> <span class="n">V_m</span> <span class="o">*</span> <span class="n">W_x</span><span class="o">+</span> <span class="n">sumATP_c</span> <span class="o">*</span><span class="p">(</span><span class="n">V_c</span> <span class="o">*</span> <span class="n">W_c</span> <span class="o">+</span> <span class="n">V_m</span> <span class="o">*</span> <span class="n">W_i</span><span class="p">)),</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Normal&#39;</span><span class="p">)</span>      <span class="c1"># </span>

<span class="c1"># Pi_c</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_AtC</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">sumPi_c</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Normal&#39;</span><span class="p">)</span>     <span class="c1"># Pi_c </span>


<span class="c1">###### Heart Failure (HF/TAC) case ######</span>
<span class="c1">#Mean TAC pools</span>
<span class="n">TAN</span> <span class="o">=</span> <span class="mf">0.006976</span> <span class="c1">#(M per liter cell)</span>
<span class="n">TEP</span> <span class="o">=</span> <span class="mf">0.02411</span>  <span class="c1">#(M per liter cell)</span>
<span class="n">Cr_tot</span> <span class="o">=</span>  <span class="mf">0.02303</span> <span class="c1">#(M per liter cell)</span>
    
<span class="n">sumATP_c_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">TAN</span> <span class="o">-</span> <span class="n">V_m</span><span class="o">*</span><span class="n">W_x</span><span class="o">*</span><span class="p">(</span><span class="n">sumATP_x_0</span> <span class="o">+</span> <span class="n">sumADP_x_0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">V_c</span><span class="o">*</span><span class="n">W_c</span><span class="o">+</span><span class="n">V_m</span><span class="o">*</span><span class="n">W_i</span><span class="p">)</span> <span class="o">-</span> <span class="n">sumADP_c_0</span>
<span class="n">Cr_tot_c</span>   <span class="o">=</span> <span class="n">Cr_tot</span> <span class="o">/</span> <span class="p">(</span><span class="n">V_c</span> <span class="o">*</span> <span class="n">W_c</span><span class="p">)</span> <span class="c1"># convert to mol (L cyto water)^(-1)</span>
<span class="n">CrP_c_0</span>    <span class="o">=</span> <span class="o">.</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Cr_tot_c</span>  <span class="c1"># mol (L cyto water)^(-1)</span>
<span class="n">sumPi_c_0</span>  <span class="o">=</span> <span class="p">(</span><span class="n">TEP</span><span class="o">-</span><span class="n">V_m</span><span class="o">*</span><span class="n">W_x</span><span class="o">*</span><span class="p">(</span><span class="n">sumATP_x_0</span> <span class="o">+</span> <span class="n">sumADP_x_0</span> <span class="o">+</span> <span class="n">sumPi_x_0</span> <span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">V_c</span><span class="o">*</span><span class="n">W_c</span><span class="o">+</span><span class="n">V_m</span><span class="o">*</span><span class="n">W_i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">sumATP_c_0</span> <span class="o">-</span> <span class="n">sumADP_c_0</span> <span class="o">-</span> <span class="n">CrP_c_0</span> 

<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Psi_0</span><span class="p">,</span> <span class="n">sumATP_x_0</span><span class="p">,</span> <span class="n">sumADP_x_0</span><span class="p">,</span> <span class="n">sumPi_x_0</span><span class="p">,</span> <span class="n">NADH_x_0</span><span class="p">,</span> <span class="n">QH2_x_0</span><span class="p">,</span> <span class="n">cred_i_0</span><span class="p">,</span> <span class="n">sumATP_c_0</span><span class="p">,</span> <span class="n">sumADP_c_0</span><span class="p">,</span> <span class="n">sumPi_c_0</span><span class="p">,</span> <span class="n">CrP_c_0</span><span class="p">])</span> 

<span class="c1"># range of ATP consumption rates</span>
<span class="n">steady_stateHF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_AtC</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_0</span><span class="p">)))</span>
<span class="c1"># looping through different ATP consumptions states</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_AtC</span><span class="p">)):</span>
   <span class="n">activity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_DH</span><span class="p">,</span> <span class="n">X_C1</span><span class="p">,</span> <span class="n">X_C3</span><span class="p">,</span> <span class="n">X_C4</span><span class="p">,</span> <span class="n">X_F</span><span class="p">,</span> <span class="n">E_ANT</span><span class="p">,</span> <span class="n">E_PiC</span><span class="p">,</span> <span class="n">X_H</span><span class="p">,</span> <span class="n">X_CK</span><span class="p">,</span> <span class="n">X_AtC</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
   <span class="c1"># run for long time to acheive steady-state</span>
   <span class="n">steady_state_temp_resultsHF</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">dXdt</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">X_0</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Radau&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">activity_array</span><span class="p">,</span><span class="mi">1</span><span class="p">,),</span><span class="n">max_step</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
   <span class="n">steady_stateHF</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">steady_state_temp_resultsHF</span>
  
<span class="n">DPsi</span><span class="p">,</span> <span class="n">sumATP_x</span><span class="p">,</span> <span class="n">sumADP_x</span><span class="p">,</span> <span class="n">sumPi_x</span><span class="p">,</span> <span class="n">NADH_x</span><span class="p">,</span> <span class="n">QH2_x</span><span class="p">,</span> <span class="n">cred_i</span><span class="p">,</span> <span class="n">sumATP_c</span><span class="p">,</span> <span class="n">sumADP_c</span><span class="p">,</span> <span class="n">sumPi_c</span><span class="p">,</span> <span class="n">CrP_c</span> <span class="o">=</span> <span class="n">steady_stateHF</span><span class="o">.</span><span class="n">T</span>

<span class="c1">## Plot figures</span>
<span class="c1"># CrP/ATP ratio</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_AtC</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">CrP_c</span> <span class="o">*</span> <span class="p">(</span><span class="n">V_c</span> <span class="o">*</span> <span class="n">W_c</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sumATP_x</span> <span class="o">*</span> <span class="n">V_m</span> <span class="o">*</span> <span class="n">W_x</span><span class="o">+</span> <span class="n">sumATP_c</span> <span class="o">*</span><span class="p">(</span><span class="n">V_c</span> <span class="o">*</span> <span class="n">W_c</span> <span class="o">+</span> <span class="n">V_m</span> <span class="o">*</span> <span class="n">W_i</span><span class="p">)),</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;HF&#39;</span><span class="p">)</span>       
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[CrP]$_c$/[ATP]$_c$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ATP consumption rate (mmol s$^{-1}$ (L cell)$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.3</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">2.5</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Pi_c</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_AtC</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">sumPi_c</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;HF&#39;</span><span class="p">)</span>     
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[Pi]$_c$ (mM)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;ATP consumption rate (mmol s$^{-1}$ (L cell)$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.3</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/InVivoModel_4_0.png" src="_images/InVivoModel_4_0.png" />
</div>
</div>
<p>Simulations of the normal case (blue lines) show that over the physiological range of ATP demand and oxygen consumption, the CrP/ATP ratio in the myocardium decreases from a value of <span class="math notranslate nohighlight">\(2.2\)</span> at rest to <span class="math notranslate nohighlight">\(2.0\)</span> in exercise, while the cytosolic phosphate concentration increases from approximately <span class="math notranslate nohighlight">\( 0.75 \ \text{mM}\)</span> at rest to <span class="math notranslate nohighlight">\(2.3 \ \text{mM}\)</span> in exercise. These model predictions are remarkably close to experiment observations, given the relative simplicity of this model. Consistent with previous analyses, when the metabolite pool levels are changed to represent heart failure conditions (red lines), the CrP/ATP ratio decreases compared and the inorganic phosphate concentration is predicted to increase compared to physiological levels.</p>
</div>
</div>
<span id="document-Summary"></span><div class="section" id="summary-and-conclusions">
<h3>Summary and conclusions<a class="headerlink" href="#summary-and-conclusions" title="Permalink to this headline">¶</a></h3>
<p>The collection of calculations and simulations presented here represents a framework for analyzing and simulating mitochondrial function using basic thermodynamic and kinetic principles. This framework largely uses simple mass-action representations of kinetic processes, rather than models accounting for detailed catalytic mechanisms. It is perhaps remarkable that this simple approach is able effectively capture the systems-level function of ATP synthesis and respiratory control both in vitro and in vivo. Since these models and simulations are grounded in a rigorous treatment of the thermodynamics, we conclude that—with respect to the phenomena addressed in the simulations presented here—the thermodynamics of many of the underlying chemical processes is more important than the kinetics. However, in contrast to that general conclusion, the adenine nucleotide translocase, in particular,  is represented with a model to account for the kinetics of its catalytic mechanism. Since the adenine nucleotide translocase catalyzes the final step in oxidative ATP synthesis, its kinetic mechanism is predicted to have the most direct influence of all the steps in governing cellular energetics and respiratory control in vivo. Moreover, the conclusion, for example, that the kinetics of complex I is effectively represented by the simple mass-action model of Equation <a class="reference internal" href="Abstract.html#equation-eq-complexi">(18)</a>, is dependent on context. While the model works for the purposes used here, it does not provide insights into phenomena that depend on a more detailed representation of a catalytic mechanism, as may be investigated using more complex models <a class="bibtex reference internal" href="Abstract.html#bazil2016" id="id1">[15]</a>.</p>
<p>By embedding all of the computer codes for the calculations and simulations that we have presented, our intention is to facilitate an easy adoption and modification of the concepts developed here. Armed with these concepts and codes, it is hoped that readers will reuse, repurpose, update, modify, test, and extend these models. Moreover, we hope that users and developers of these concepts will adopt publication vehicles such as this one, for sharing data, codes, and associated calculations with the community.</p>
</div>
<span id="document-References"></span><div class="section" id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h3>
<p id="bibtex-bibliography-References-0"><dl class="citation">
<dt class="bibtex label" id="beard2005"><span class="brackets">1</span></dt>
<dd><p>D.A. Beard. A biophysical model of the mitochondrial respiratory system and oxidative phosphorylation. <em>PLoS Comp Biol</em>, 1:e36, 2005. <a class="reference external" href="https://doi.org/10.1371/journal.pcbi.0010036">doi:10.1371/journal.pcbi.0010036</a>.</p>
</dd>
<dt class="bibtex label" id="beard2012"><span class="brackets">2</span></dt>
<dd><p>D.A. Beard. <em>Biosimulation: Simulation of Living Systems</em>. Cambridge University Press, 2012.</p>
</dd>
<dt class="bibtex label" id="wu2008"><span class="brackets">3</span></dt>
<dd><p>F. Wu. E.Y. Zhang. J. Zhang. R.J. Bache. D.A. Beard. Phosphate metabolite concentrations and atp hydrolysis potential in normal and ischaemic hearts. <em>J Physiol</em>, 586:4193–4208, 2008. <a class="reference external" href="https://doi.org/10.1113/jphysiol.2008.154732">doi:10.1113/jphysiol.2008.154732</a>.</p>
</dd>
<dt class="bibtex label" id="wu2007"><span class="brackets">4</span></dt>
<dd><p>F. Wu. F. Yang. K.C. Vinnakota. D.A. Beard. Computer modeling of mitochondrial tricarboxylic acid cycle, oxidative phosphorylation, metabolite transport, and electrophysiology. <em>J Biol Chem</em>, 282:24525–24537, 2007. <a class="reference external" href="https://doi.org/10.1074/jbc.M701024200">doi:10.1074/jbc.M701024200</a>.</p>
</dd>
<dt class="bibtex label" id="wu2009"><span class="brackets">5</span></dt>
<dd><p>F. Wu. J. Zhang. D.A. Beard. Phosphate metabolite concentrations and atp hydrolysis potential in normal and ischaemic hearts. <em>Proc Natl Acad Sci USA</em>, 106:7143–7148, 2009. <a class="reference external" href="https://doi.org/0.1073/pnas.0812768106">doi:0.1073/pnas.0812768106</a>.</p>
</dd>
<dt class="bibtex label" id="gao2019"><span class="brackets">6</span></dt>
<dd><p>X. Gao. D.G. Jakovljevic. D.A. Beard. Cardiac metabolic limitations contribute to diminished performance of the heart in aging. <em>Biophys J</em>, 117:2295–2302, 2019. <a class="reference external" href="https://doi.org/10.1016/j.bpj.2019.06.026">doi:10.1016/j.bpj.2019.06.026</a>.</p>
</dd>
<dt class="bibtex label" id="li2011"><span class="brackets">7</span></dt>
<dd><p>X. Li. F. Wu. F. Qi. D.A. Beard. A database of thermodynamic properties of the reactions of glycolysis, the tricarboxylic acid cycle, and the pentose phosphate pathway. <em>Database</em>, 2011:bar005, 2011. <a class="reference external" href="https://doi.org/10.1093/database/bar005">doi:10.1093/database/bar005</a>.</p>
</dd>
<dt class="bibtex label" id="metelkin2006"><span class="brackets">8</span></dt>
<dd><p>E. Metelkin. I. Goryanin. O. Demin. Mathematical modeling of mitochondrial adenine nucleotide translocase. <em>Biophys J</em>, 90:423–432, 2006. <a class="reference external" href="https://doi.org/10.1529/biophysj.105.061986.">doi:10.1529/biophysj.105.061986.</a></p>
</dd>
<dt class="bibtex label" id="lopez2020"><span class="brackets">9</span></dt>
<dd><p>R. Lopez. B. Marzban. X. Gao. E. Lauinger. F. Van den Bergh. S.E. Whitesall. K. Converso-Baran. C.F. Burant. D.E. Michele. D.A. Beard. Impaired myocardial energetics causes mechanical dysfunction in decompensated failing hearts. <em>Function</em>, 1:zqaa018, 2020. <a class="reference external" href="https://doi.org/10.1093/function/zqaa018">doi:10.1093/function/zqaa018</a>.</p>
</dd>
<dt class="bibtex label" id="gnaiger2020"><span class="brackets">10</span></dt>
<dd><p>E. Gnaiger et al. Mitochondrial physiology. <em>Bioenerg Commun</em>, 2020. <a class="reference external" href="https://doi.org/10.26124/mitofit:190001">doi:10.26124/mitofit:190001</a>.</p>
</dd>
<dt class="bibtex label" id="nicholls2013"><span class="brackets">11</span></dt>
<dd><p>D.G. Nicholls. S.J. Ferguson. <em>Bioenergetics.</em> Academic Press, Elsevier, Amsterdam, The Netherlands, 2013. ISBN 9780123884312.</p>
</dd>
<dt class="bibtex label" id="mitchell1961"><span class="brackets">12</span></dt>
<dd><p>P. Mitchell. Coupling of phosphorylation to electron and hydrogen transfer by a chemi-osmotic type of mechanism. <em>Nature</em>, 191:144–148, 1961. <a class="reference external" href="https://doi.org/10.1038/191144a0">doi:10.1038/191144a0</a>.</p>
</dd>
<dt class="bibtex label" id="friedman2014"><span class="brackets">13</span></dt>
<dd><p>J.R. Friedman. J. Nunnari. Mitochondrial form and function. <em>Nature</em>, 505(7483):335–343, 2014. <a class="reference external" href="https://doi.org/10.1038/nature12985">doi:10.1038/nature12985</a>.</p>
</dd>
<dt class="bibtex label" id="chance1985"><span class="brackets">14</span></dt>
<dd><p>B. Chance. S. Leigh Jr. B.J. Clark. J. Maris. J. Kent. S. Nioka. D. Smith. Control of oxidative metabolism and oxygen delivery in human skeletal muscle: a steady-state analysis of the work/energy cost transfer function. <em>Proc Natl Acad Sci USA</em>, 82:8384–8388, 1985.</p>
</dd>
<dt class="bibtex label" id="bazil2016"><span class="brackets">15</span></dt>
<dd><p>J.N. Bazil. D.A. Beard. K.C. Vinnakota. Catalytic coupling of oxidative phosphorylation, atp demand, and reactive oxygen species generation. <em>Biophys J</em>, 110(4):962–971, 2016. <a class="reference external" href="https://doi.org/10.1016/j.bpj.2015.09.036">doi:10.1016/j.bpj.2015.09.036</a>.</p>
</dd>
<dt class="bibtex label" id="chance1955"><span class="brackets">16</span></dt>
<dd><p>B. Chance. G.R. Williams. Respiratory enzymes in oxidative phosphorylation. i. kinetics of oxygen utilization. <em>J Biol Chem</em>, 217:383–935, 1955.</p>
</dd>
</dl>
</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Randall, Hock, Lopez, Marzban, Marshall, & Beard supported by NIH grant HL144657<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>